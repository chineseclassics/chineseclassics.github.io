# Change Proposal: implement-core-mvp

## Summary
實現《紅樓舊夢》v2 的核心 MVP 版本，建立完整的遊戲循環：閱讀驅動的記憶解鎖、資源收集與分配、花魂養成、節氣行動力系統。本提案聚焦核心可玩系統，確保遊戲循環完整且教育目標明確。

## Motivation
- **核心教育目標**：通過遊戲化機制促進學生閱讀《紅樓夢》前八十回
- **閱讀驗證機制**：確保學生真正讀過原文，而非簡單標記
- **遊戲循環完整性**：建立「閱讀→解鎖→資源→行動→成長」的完整循環
- **策略深度**：通過資源稀缺性和行動力限制創造策略選擇
- **技術簡潔性**：使用原生 JavaScript，避免過度複雜的架構

## Scope
Included:
- **節氣循環系統**：24 節氣序列，每節氣 4 點行動力
- **資源系統**：絳珠（核心資源，統一不分類型）、靈石（次要資源）
- **記憶系統**：閱讀解鎖機制、答題驗證（3 題/回憶，30 秒限制）、時間和答錯懲罰
- **園林建築系統**：5×5 格子地圖、瀟湘館解鎖邏輯
- **花魂系統**：黛玉花魂、等級 0-5、成長值、澆灌機制
- **基本 UI**：狀態列、記憶列表、答題界面、行動面板

Excluded:
- 鳥靈系統（丫鬟輔助）
- 複雜佈局 buff（園林策略）
- 多角色花魂（寶釵、湘雲、探春）
- DeepSeek AI 整合
- 隨機事件系統
- 複雜終局系統（僅簡單文本總結）

## Non-Goals
- 不引入前端框架（Vue/React）
- 不引入複雜的狀態管理庫
- 不一次性實現所有 80 回的問題數據庫（先實現前 20 回）
- 不實現複雜的視覺效果和動畫

## Success Criteria
- 玩家能夠完成 2-3 個節氣的完整遊戲循環
- 答題解鎖記憶機制正常工作，時間限制和答錯懲罰生效
- 資源系統（絳珠、靈石）正確獲取和消耗
- 行動力系統限制玩家行動，創造策略選擇
- 花魂系統（種植、澆灌、升級）基本功能完整
- UI 清晰展示遊戲狀態和進度

## Risks & Mitigations
- **風險**：答題驗證機制可能過於嚴格或過於寬鬆  
  **緩解**：通過 demo 驗證機制，根據測試結果調整時間限制和懲罰係數
- **風險**：資源平衡可能不合理  
  **緩解**：通過遊戲流程模擬驗證資源獲取和消耗的平衡
- **風險**：問題數據庫準備工作量大  
  **緩解**：MVP 階段僅為前 20 回準備問題，後續逐步擴展
- **風險**：代碼結構可能不夠模組化  
  **緩解**：明確的模組劃分（state.js, memories.js, seasons.js 等）

## Dependencies
- 參考文件：`docs/GAME_REDESIGN_PLAN.md`（主要設計文檔）
- 參考文件：`docs/GAME_FLOW_SIMULATION.md`（遊戲流程模擬）
- Demo 驗證：`index.html`（已實現的簡單 demo）

## Spec Map
本變更拆分為以下能力規範：

1. **seasonal-cycle** - 節氣循環系統
   - 24 節氣序列
   - 行動力系統（每節氣 4 點）
   - 節氣推進機制

2. **resource-system** - 資源系統
   - 絳珠系統（統一資源，通過記憶收集獲得）
   - 靈石系統（獨立資源，用於解鎖建築）
   - 資源獲取和消耗機制

3. **memory-system** - 記憶系統
   - 記憶發現機制（UI 顯示未解鎖記憶列表）
   - 閱讀解鎖機制（答題驗證）
   - 答題系統（3 題/回憶，30 秒限制）
   - 時間和答錯懲罰機制
   - 資源獎勵計算

4. **garden-building** - 園林建築系統
   - 5×5 格子地圖
   - 建築解鎖邏輯（瀟湘館）
   - 建築與花魂對應關係

5. **flower-soul** - 花魂系統
   - 花魂種植機制
   - 花魂等級系統（0-5 級）
   - 成長值系統
   - 澆灌機制（消耗絳珠）

6. **core-ui** - 核心 UI 系統
   - 狀態列（節氣、行動力、資源）
   - 記憶列表（顯示未解鎖/已解鎖記憶）
   - 答題界面（選擇題、計時器、結果顯示）
   - 行動面板（解鎖建築、種植花魂、澆灌花魂）

## Implementation Notes
- 所有系統必須遵循設計文檔中的核心原則
- 答題解鎖記憶不消耗行動力，這是核心設計原則
- 資源獲取必須通過記憶收集，不能有其他來源（MVP 階段）
- 代碼必須使用繁體中文註釋
- 保持代碼簡潔，避免過度工程化

