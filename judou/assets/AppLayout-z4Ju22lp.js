import{d as B,u as I,c,r as A,w as O,o as T,a,b as e,e as u,n as b,f as r,t as o,g as S,h as W,F as C,i as w,j,k as N,l as x,m as V,p as q,q as s,_ as P,s as M}from"./index-DWyRXt9O.js";import{u as J}from"./userStatsStore-BmAY9hjk.js";import{u as K}from"./assignmentStore-DYeLWjVp.js";const Q={class:"sidebar-shell edamame-glass"},X=["src","alt"],Y={key:1},Z={key:2,class:"level-badge"},ee={class:"brand-info"},te={class:"brand-title"},se={key:0,class:"brand-stats"},ae={class:"beans-display"},ne={class:"level-display"},le={key:0,class:"streak-display"},oe={key:1,class:"brand-subtitle"},ie={key:0,class:"arrow-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},re={key:0,class:"user-menu-dropdown"},ce={class:"sidebar-section"},de={class:"item-title"},ue={key:0,class:"badge"},pe={key:1,class:"edamame-sidebar-item disabled"},_e={class:"item-title"},ve={key:1,class:"sidebar-section"},he={class:"item-title"},be={key:1,class:"edamame-sidebar-item disabled"},me={class:"item-title"},fe=B({__name:"SidebarMenu",setup(U){const t=I(),p=J(),d=K(),z=j(),L=[{label:"ä¸»é ",to:{name:"home"}},{label:"ç·´ç¿’",to:{name:"practice"}},{label:"æˆ‘çš„ç­ç´š",to:{name:"my-classes"}},{label:"æ­·å²ç´€éŒ„",to:{name:"history"}},{label:"è‡ªè¨‚ç·´ç¿’",to:{name:"my-texts"},teacherOnly:!0}],F=[{label:"ç³»çµ±æ–‡åº«",to:{name:"admin-texts"}}],$=c(()=>L.filter(i=>!i.teacherOnly||t.isTeacher)),m=c(()=>!t.isAuthenticated||!t.isAdmin?[]:F),H=q(),f=i=>i.to?H.name===i.to.name:!1,v=c(()=>t.isAuthenticated?t.displayName||"è±†å‹":"è¨ªå®¢"),R=c(()=>v.value.charAt(0)),D=c(()=>p.profile?.total_beans??0),y=c(()=>p.level),g=c(()=>p.profile?.streak_days??0),h=A(!1);async function E(){await t.loginWithGoogle()}function G(){t.isAuthenticated?z.push({name:"profile"}):h.value=!h.value}const _=A(0);return O(()=>t.isAuthenticated,i=>{i?(console.log("[Sidebar] ç”¨æˆ¶å·²ç™»å…¥ï¼Œè¼‰å…¥ Profile"),p.fetchProfile(),t.isStudent&&d.fetchStudentAssignments().then(()=>{d.getPendingCount().then(l=>{_.value=l})})):_.value=0},{immediate:!0}),T(()=>{t.isAuthenticated&&t.isStudent&&d.fetchStudentAssignments().then(()=>{d.getPendingCount().then(i=>{_.value=i})})}),(i,l)=>{const k=V("router-link");return s(),a("aside",Q,[e("div",{class:"sidebar-brand",onClick:G},[e("div",{class:b(["brand-avatar",{"has-avatar":r(t).avatarUrl}])},[r(t).avatarUrl?(s(),a("img",{key:0,src:r(t).avatarUrl,alt:v.value},null,8,X)):(s(),a("span",Y,o(R.value),1)),r(t).isAuthenticated?(s(),a("div",Z,o(y.value),1)):u("",!0)],2),e("div",ee,[e("p",te,o(v.value),1),r(t).isAuthenticated?(s(),a("p",se,[e("span",ae,[l[0]||(l[0]=e("span",{class:"bean-dot"},null,-1)),S(" "+o(D.value),1)]),e("span",ne,"Lv."+o(y.value),1),g.value>0?(s(),a("span",le,"ðŸ”¥ "+o(g.value)+"å¤©",1)):u("",!0)])):(s(),a("p",oe,"é»žæ“Šç™»å…¥"))]),r(t).isAuthenticated?(s(),a("svg",ie,[...l[1]||(l[1]=[e("path",{d:"M9 18l6-6-6-6"},null,-1)])])):u("",!0)]),h.value&&!r(t).isAuthenticated?(s(),a("div",re,[e("button",{class:"login-btn",onClick:E},[...l[2]||(l[2]=[W('<svg class="google-icon" viewBox="0 0 24 24" width="16" height="16" data-v-f7b04727><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-f7b04727></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-f7b04727></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-f7b04727></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-f7b04727></path></svg> ä½¿ç”¨ Google ç™»å…¥ ',2)])])])):u("",!0),e("nav",ce,[l[3]||(l[3]=e("p",{class:"section-label"},"å¸¸ç”¨åŠŸèƒ½",-1)),e("ul",null,[(s(!0),a(C,null,w($.value,n=>(s(),a("li",{key:n.label},[n.to&&!n.disabled?(s(),N(k,{key:0,class:b(["edamame-sidebar-item",{active:f(n)}]),to:n.to},{default:x(()=>[e("p",de,[S(o(n.label)+" ",1),n.label==="æˆ‘çš„ç­ç´š"&&r(t).isStudent&&_.value>0?(s(),a("span",ue,o(_.value),1)):u("",!0)])]),_:2},1032,["class","to"])):(s(),a("div",pe,[e("p",_e,o(n.label),1)]))]))),128))])]),m.value.length>0?(s(),a("nav",ve,[l[4]||(l[4]=e("p",{class:"section-label"},"ç®¡ç†",-1)),e("ul",null,[(s(!0),a(C,null,w(m.value,n=>(s(),a("li",{key:n.label},[n.to&&!n.disabled?(s(),N(k,{key:0,class:b(["edamame-sidebar-item",{active:f(n)}]),to:n.to},{default:x(()=>[e("p",he,o(n.label),1)]),_:2},1032,["class","to"])):(s(),a("div",be,[e("p",me,o(n.label),1)]))]))),128))])])):u("",!0),l[5]||(l[5]=e("div",{class:"sidebar-footer"},[e("p",null,"ç‰ˆæœ¬ 2.0 Vue"),e("p",{class:"item-desc"},"Supabase + PWA Ready")],-1))])}}}),ye=P(fe,[["__scopeId","data-v-f7b04727"]]),ge={class:"app-layout"},ke={class:"app-main"},Ae={class:"app-content"},Se=B({__name:"AppLayout",setup(U){return(t,p)=>{const d=V("router-view");return s(),a("div",ge,[M(ye),e("section",ke,[e("div",Ae,[M(d)])])])}}}),xe=P(Se,[["__scopeId","data-v-a70dcd22"]]);export{xe as default};
