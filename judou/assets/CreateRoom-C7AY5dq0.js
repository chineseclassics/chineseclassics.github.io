import{d as P,r as u,c as S,a as l,g as s,h as c,i as d,m as V,v as I,e as B,t as a,F as b,j as f,b as C,o,_ as z}from"./index-BmRNYGi2.js";import{u as D}from"./gameStore-DUrA9Zay.js";import{u as U}from"./userStatsStore-5n-22BUC.js";import{T as Y}from"./TextSelector-KkUmvHGa.js";import{B as j}from"./BeanIcon-zabhTKAh.js";import{S as k,b as L,E as G}from"./game-pGsr7gx9.js";const q={class:"create-room-page"},H={class:"balance-card"},J={class:"balance-value"},K={class:"steps-indicator"},Q={key:0},W={key:1},X={class:"step-content"},Z={key:0,class:"step-panel"},ss={key:1,class:"step-panel"},es={class:"form-section"},ts={class:"player-options"},ls=["onClick"],os={class:"form-section"},as={class:"time-options"},ns=["onClick"],is={class:"option-label"},rs={class:"option-desc"},us={class:"form-section"},cs={class:"fee-options"},ds=["disabled","onClick"],vs={key:0,class:"fee-info"},ps={class:"safety-notice"},ms={class:"notice-text"},_s={class:"confirm-card"},bs={class:"confirm-row texts-row"},fs={class:"confirm-texts"},ks={class:"text-order"},ys={class:"text-name"},hs={class:"confirm-row"},xs={class:"confirm-value"},Cs={class:"confirm-row"},Ss={class:"confirm-value"},Is={class:"confirm-row"},Ns={class:"confirm-value"},gs={key:0,class:"error-message"},Es={class:"nav-buttons"},Ts=["disabled"],As=["disabled"],Bs=["disabled"],N=2,Ls=P({__name:"CreateRoom",setup(Ms){const g=V(),E=D(),M=U(),n=u(1),p=u([]),v=u(2),y=u(180),i=u(0),m=u(!1),r=u(""),T=u(null),h=S(()=>M.profile?.total_beans??0),A=S(()=>i.value===0?!0:h.value-i.value>=k.MIN_BALANCE),w=S(()=>T.value?.selectedTexts||[]);function F(_){p.value=_}function $(){if(n.value===1&&p.value.length===0){r.value="è«‹è‡³å°‘é¸æ“‡ä¸€ç¯‡æ–‡æœ¬";return}r.value="",n.value++}function R(){r.value="",n.value--}async function O(){if(p.value.length===0){r.value="è«‹é¸æ“‡æ–‡æœ¬";return}if(!A.value){r.value=`è±†å­ä¸è¶³ï¼Œè³¬æˆ¶éœ€ä¿ç•™è‡³å°‘ ${k.MIN_BALANCE} è±†`;return}m.value=!0,r.value="";const _=await E.createRoom({hostType:"student",gameMode:"pvp",textIds:p.value,timeLimit:y.value,maxPlayers:v.value,entryFee:i.value});_?g.push({name:"arena-lobby",params:{roomId:_.id}}):r.value=E.error||"å‰µå»ºå¤±æ•—",m.value=!1}return(_,e)=>(o(),l("div",q,[s("button",{class:"back-btn",onClick:e[0]||(e[0]=t=>d(g).push({name:"arena"}))}," â† è¿”å›žé¬¥è±† "),e[17]||(e[17]=s("header",{class:"page-header"},[s("h1",null,[s("span",{class:"title-icon"},"âž•"),I(" å‰µå»ºé¬¥è±†å ´ ")]),s("p",{class:"subtitle"},"é‚€è«‹åŒå­¸åŠ å…¥ï¼Œè´å–è±†å­ï¼")],-1)),s("div",H,[B(j,{size:24,class:"balance-icon"}),s("span",J,a(h.value),1),e[1]||(e[1]=s("span",{class:"balance-label"},"æˆ‘çš„è±†å­",-1))]),s("div",K,[(o(),l(b,null,f(N,t=>s("div",{key:t,class:C(["step-dot",{active:n.value===t,completed:n.value>t}])},[n.value>t?(o(),l("span",Q,"âœ“")):(o(),l("span",W,a(t),1))],2)),64))]),s("div",X,[n.value===1?(o(),l("div",Z,[e[2]||(e[2]=s("h2",null,"é¸æ“‡æ¯”è³½æ–‡æœ¬",-1)),e[3]||(e[3]=s("p",{class:"step-hint"},"å¯é¸æ“‡å¤šç¯‡æ–‡ç« ï¼Œå°æˆ°æ™‚æŒ‰é †åºå®Œæˆ",-1)),B(Y,{ref_key:"textSelector",ref:T,"show-custom-texts":!1,"onUpdate:selectedIds":F},null,512)])):c("",!0),n.value===2?(o(),l("div",ss,[e[15]||(e[15]=s("h2",null,"æ¯”è³½è¨­ç½®",-1)),e[16]||(e[16]=s("p",{class:"step-hint"},"è¨­ç½®å°æˆ°äººæ•¸ã€æ™‚é–“å’Œå…¥å ´è²»",-1)),s("div",es,[e[4]||(e[4]=s("label",{class:"section-label"},"å°æˆ°äººæ•¸",-1)),s("div",ts,[(o(),l(b,null,f([2,3,4],t=>s("button",{key:t,class:C(["option-btn",{selected:v.value===t}]),onClick:x=>v.value=t},a(t)+" äºº ",11,ls)),64))])]),s("div",os,[e[5]||(e[5]=s("label",{class:"section-label"},"æ™‚é–“é™åˆ¶",-1)),s("div",as,[(o(!0),l(b,null,f(d(L),t=>(o(),l("button",{key:t.value,class:C(["option-btn time-btn",{selected:y.value===t.value}]),onClick:x=>y.value=t.value},[s("span",is,a(t.label),1),s("span",rs,a(t.description),1)],10,ns))),128))])]),s("div",us,[e[9]||(e[9]=s("label",{class:"section-label"},"å…¥å ´è²»",-1)),s("div",cs,[(o(!0),l(b,null,f(d(G),t=>(o(),l("button",{key:t,class:C(["fee-btn",{selected:i.value===t,disabled:t>0&&h.value-t<d(k).MIN_BALANCE}]),disabled:t>0&&h.value-t<d(k).MIN_BALANCE,onClick:x=>i.value=t},a(t===0?"å…è²»":`${t} è±†`),11,ds))),128))]),i.value>0?(o(),l("div",vs,[s("p",null,[e[6]||(e[6]=I(" å…¥å ´è²»ï¼š",-1)),s("strong",null,a(i.value)+" è±†",1),I(" Ã— "+a(v.value)+" äºº = çŽæ±  ",1),s("strong",null,a(i.value*v.value)+" è±†",1)]),e[7]||(e[7]=s("p",{class:"fee-note"},"ç²å‹è€…æ”¶è±†ï¼",-1))])):c("",!0),s("div",ps,[e[8]||(e[8]=s("span",{class:"notice-icon"},"ðŸ›¡ï¸",-1)),s("span",ms," è³¬æˆ¶ä¿ç•™ "+a(d(k).MIN_BALANCE)+" è±† ",1)])]),s("div",_s,[e[14]||(e[14]=s("h3",null,"ç¢ºèªä¿¡æ¯",-1)),s("div",bs,[e[10]||(e[10]=s("span",{class:"confirm-label"},"æ–‡æœ¬",-1)),s("div",fs,[(o(!0),l(b,null,f(w.value,(t,x)=>(o(),l("div",{key:t.id,class:"confirm-text-item"},[s("span",ks,a(x+1)+".",1),s("span",ys,a(t.title),1)]))),128))])]),s("div",hs,[e[11]||(e[11]=s("span",{class:"confirm-label"},"äººæ•¸",-1)),s("span",xs,a(v.value)+" äºº",1)]),s("div",Cs,[e[12]||(e[12]=s("span",{class:"confirm-label"},"æ™‚é–“",-1)),s("span",Ss,a(d(L).find(t=>t.value===y.value)?.description),1)]),s("div",Is,[e[13]||(e[13]=s("span",{class:"confirm-label"},"å…¥å ´è²»",-1)),s("span",Ns,a(i.value===0?"å…è²»":`${i.value} è±†`),1)])])])):c("",!0)]),r.value?(o(),l("p",gs,a(r.value),1)):c("",!0),s("div",Es,[n.value>1?(o(),l("button",{key:0,class:"btn-secondary",onClick:R,disabled:m.value}," ä¸Šä¸€æ­¥ ",8,Ts)):c("",!0),n.value<N?(o(),l("button",{key:1,class:"btn-primary",onClick:$,disabled:p.value.length===0}," ä¸‹ä¸€æ­¥ ",8,As)):c("",!0),n.value===N?(o(),l("button",{key:2,class:"btn-primary",onClick:O,disabled:m.value||!A.value},a(m.value?"å‰µå»ºä¸­...":"å‰µå»ºé¬¥è±†å ´"),9,Bs)):c("",!0)])]))}}),Vs=z(Ls,[["__scopeId","data-v-98055c2a"]]);export{Vs as default};
