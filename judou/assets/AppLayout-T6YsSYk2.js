import{d as P,c as r,a as s,n as O,b as N,e as z,o as e,_ as U,u as G,r as F,w as E,f as ve,g as t,h as _,i as T,t as m,F as b,j as q,k as me,l as X,m as h,p as Y,q as L,s as I,v as Z,x as V,T as ye}from"./index-2GrKgsuZ.js";import{u as he}from"./userStatsStore-BtSlHy5l.js";import{u as be}from"./assignmentStore-pKHodQlA.js";import{u as J}from"./avatarStore-CgnD1jC4.js";import{B}from"./BeanIcon-BSgf5kS_.js";import{H as ee,S as te,F as ne,U as se,P as ae}from"./users-m2ZlRZYl.js";import{B as ie}from"./book-open-DLn0ngqP.js";import{c as K}from"./createLucideIcon-A3PQ0382.js";import"./useSupabase-CC9tLKch.js";const fe=["src","alt"],ke={key:1,class:"avatar-fallback"},_e=P({__name:"UserAvatar",props:{size:{default:40},src:{default:void 0},alt:{default:"ç”¨æˆ¶é ­åƒ"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(y,{emit:a}){const i=y,p=a,d=J(),f=r(()=>i.src!==void 0?i.src:d.currentAvatarUrl),k=r(()=>{const c=typeof i.size=="number"?`${i.size}px`:i.size;return{width:c,height:c,minWidth:c,minHeight:c}}),g=r(()=>{const c=typeof i.size=="number"?i.size:parseInt(i.size);return Math.round(c*.5)});function x(){i.clickable&&p("click")}return(c,A)=>(e(),s("div",{class:N(["user-avatar",{clickable:y.clickable}]),style:O(k.value),onClick:x},[f.value?(e(),s("img",{key:0,src:f.value,alt:y.alt,class:"avatar-img"},null,8,fe)):(e(),s("div",ke,[z(B,{size:g.value},null,8,["size"])]))],6))}}),oe=U(_e,[["__scopeId","data-v-8f62ee97"]]);const le=K("book-marked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const ce=K("library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);const re=K("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),ge={class:"sidebar-shell edamame-glass"},xe={class:"brand-avatar"},Ae={class:"level-badge"},we={class:"brand-info"},Ce={class:"beans-icon"},Se={class:"beans-roller"},Me={key:0,class:"secondary-stats"},Te={class:"streak-display"},ze={key:1,class:"login-section"},$e={class:"sidebar-section"},Be={key:0,class:"item-icon"},Ie={class:"item-title"},Oe={key:0,class:"badge"},Ne={key:1,class:"edamame-sidebar-item disabled"},Pe={key:0,class:"item-icon"},Ue={class:"item-title"},je={key:2,class:"sidebar-section"},He={key:0,class:"item-icon"},Fe={class:"item-title"},qe={key:1,class:"edamame-sidebar-item disabled"},Le={key:0,class:"item-icon"},Re={class:"item-title"},De=P({__name:"SidebarMenu",setup(y){const a=G(),i=he(),p=be(),d=J(),f=X(),k=[{label:"é¦–é ",icon:ee,iconType:"lucide",to:{name:"home"}},{label:"å¥è±†",icon:B,iconType:"bean",to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:ie,iconType:"lucide",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:te,iconType:"lucide",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:ne,iconType:"lucide",to:{name:"history"},description:"æ­·å²"},{label:"è±†èŽ¢",icon:se,iconType:"lucide",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:ae,iconType:"lucide",to:{name:"my-texts"},teacherOnly:!0}],g=[{label:"ç·´ç¿’æ–‡åº«",icon:ce,iconType:"lucide",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",icon:le,iconType:"lucide",to:{name:"admin-reading"}},{label:"ç”¨æˆ¶ç®¡ç†",icon:re,iconType:"lucide",to:{name:"admin-users"},superAdminOnly:!0}],x=r(()=>k.filter(u=>!u.teacherOnly||a.isTeacher)),c=r(()=>!a.isAuthenticated||!a.isAdmin?[]:g.filter(u=>u.superAdminOnly?a.isSuperAdmin:!0)),A=V(),w=u=>u.to?A.name===u.to.name:!1,j=r(()=>a.isAuthenticated?a.displayName||"è±†å‹":"è¨ªå®¢"),v=r(()=>i.profile?.total_beans??0),C=r(()=>i.level),o=r(()=>i.profile?.streak_days??0),S=F(0),$=F(!1),M=F(null),D=r(()=>S.value.toString().split("").map(l=>parseInt(l)));E(v,(u,l)=>{if(l===void 0||l===0){S.value=u;return}if(u===l)return;const R=u-l;M.value=R>0?"up":"down",$.value=!0,S.value=u,setTimeout(()=>{$.value=!1,M.value=null},800)},{immediate:!0});async function W(){await a.loginWithGoogle()}function de(){f.push({name:"profile"})}const H=F(0);E(()=>a.isAuthenticated,u=>{u?(console.log("[Sidebar] ç”¨æˆ¶å·²ç™»å…¥ï¼Œè¼‰å…¥ Profile å’Œé ­åƒ"),i.fetchProfile(),d.initialize(),a.isStudent&&p.fetchStudentAssignments().then(()=>{p.getPendingCount().then(l=>{H.value=l})})):(H.value=0,d.reset())},{immediate:!0}),ve(()=>{a.isAuthenticated&&a.isStudent&&p.fetchStudentAssignments().then(()=>{p.getPendingCount().then(u=>{H.value=u})})});const ue="/judou/images/judou-logo.jpg";return(u,l)=>{const R=Z("router-link");return e(),s("aside",ge,[T(a).isAuthenticated?(e(),s("div",{key:0,class:"sidebar-brand",onClick:de},[t("div",xe,[z(oe,{src:T(d).currentAvatarUrl||T(a).avatarUrl,size:52,alt:j.value},null,8,["src","alt"]),t("div",Ae,m(C.value),1)]),t("div",we,[t("div",{class:N(["beans-card",{"beans-animating":$.value,"beans-up":M.value==="up","beans-down":M.value==="down"}])},[t("div",Ce,[z(B,{size:24})]),t("div",Se,[(e(!0),s(b,null,q(D.value,(n,pe)=>(e(),s("div",{key:pe,class:"digit-slot"},[t("div",{class:"digit-roller",style:O({transform:`translateY(-${n*10}%)`})},[(e(),s(b,null,q(10,Q=>t("span",{key:Q,class:"digit"},m(Q-1),1)),64))],4)]))),128))])],2),o.value>0?(e(),s("div",Me,[t("span",Te,"ðŸ”¥ "+m(o.value)+"å¤©",1)])):_("",!0)]),l[0]||(l[0]=t("svg",{class:"arrow-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})],-1))])):(e(),s("div",ze,[t("button",{class:"google-login-btn",onClick:W},[...l[1]||(l[1]=[me('<svg class="google-icon" viewBox="0 0 24 24" width="18" height="18" data-v-913b1deb><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-913b1deb></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-913b1deb></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-913b1deb></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-913b1deb></path></svg><span data-v-913b1deb>ä½¿ç”¨ Google ç™»å…¥</span>',2)])]),l[2]||(l[2]=t("p",{class:"login-hint"},"ç™»å…¥å¾Œå¯ä¿å­˜å­¸ç¿’é€²åº¦",-1))])),t("nav",$e,[t("ul",null,[(e(!0),s(b,null,q(x.value,n=>(e(),s("li",{key:n.label},[n.to&&!n.disabled?(e(),h(R,{key:0,class:N(["edamame-sidebar-item",{active:w(n)}]),to:n.to},{default:Y(()=>[n.icon?(e(),s("span",Be,[n.iconType==="bean"?(e(),h(B,{key:0,size:18})):n.iconType==="lucide"?(e(),h(L(n.icon),{key:1,size:18,"stroke-width":1.5,class:"lucide-icon"})):(e(),s(b,{key:2},[I(m(n.icon),1)],64))])):_("",!0),t("p",Ie,[I(m(n.label)+" ",1),n.label==="è±†èŽ¢"&&T(a).isStudent&&H.value>0?(e(),s("span",Oe,m(H.value),1)):_("",!0)])]),_:2},1032,["class","to"])):(e(),s("div",Ne,[n.icon?(e(),s("span",Pe,[n.iconType==="bean"?(e(),h(B,{key:0,size:18})):n.iconType==="lucide"?(e(),h(L(n.icon),{key:1,size:18,"stroke-width":1.5,class:"lucide-icon"})):(e(),s(b,{key:2},[I(m(n.icon),1)],64))])):_("",!0),t("p",Ue,m(n.label),1)]))]))),128))])]),c.value.length>0?(e(),s("nav",je,[l[3]||(l[3]=t("p",{class:"section-label"},"ç®¡ç†",-1)),t("ul",null,[(e(!0),s(b,null,q(c.value,n=>(e(),s("li",{key:n.label},[n.to&&!n.disabled?(e(),h(R,{key:0,class:N(["edamame-sidebar-item",{active:w(n),"super-admin-item":n.superAdminOnly}]),to:n.to},{default:Y(()=>[n.icon?(e(),s("span",He,[n.iconType==="lucide"?(e(),h(L(n.icon),{key:0,size:16,"stroke-width":1.5,class:"lucide-icon"})):(e(),s(b,{key:1},[I(m(n.icon),1)],64))])):_("",!0),t("p",Fe,m(n.label),1)]),_:2},1032,["class","to"])):(e(),s("div",qe,[n.icon?(e(),s("span",Le,[n.iconType==="lucide"?(e(),h(L(n.icon),{key:0,size:16,"stroke-width":1.5,class:"lucide-icon"})):(e(),s(b,{key:1},[I(m(n.icon),1)],64))])):_("",!0),t("p",Re,m(n.label),1)]))]))),128))])])):_("",!0),t("div",{class:"sidebar-footer"},[t("div",{class:"footer-brand"},[t("img",{src:ue,alt:"å¥è±†",class:"footer-logo"}),l[4]||(l[4]=t("span",{class:"footer-title"},"å¥è±† 2.0",-1))]),l[5]||(l[5]=t("div",{class:"footer-credits"},[t("p",null,"é–‹ç™¼ï¼šæ±ªæ¶µå±¹ã€å¼µè€å¸«"),t("p",null,"ç¾Žè¡“ï¼šä¸å¥•è¾°ã€å¾æšæ´‹")],-1))])])}}}),We=U(De,[["__scopeId","data-v-913b1deb"]]),Ee={key:1,class:"login-icon"},Ye=P({__name:"FloatingAvatarButton",props:{isMenuOpen:{type:Boolean}},emits:["toggle-menu","avatar-click"],setup(y,{emit:a}){const i=y,p=a,d=G(),f=J();function k(c){c.stopPropagation(),p("toggle-menu")}function g(c){c.stopPropagation(),p("avatar-click")}const x=r(()=>({position:"fixed",right:"20px",bottom:"20px",zIndex:1e3,width:"64px",height:"64px",borderRadius:"50%",cursor:"pointer",transition:"transform 0.2s ease, box-shadow 0.2s ease",transform:i.isMenuOpen?"scale(1.1) rotate(45deg)":"scale(1)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)"}));return(c,A)=>(e(),s("div",{style:O(x.value),class:N(["floating-avatar-button",{"is-menu-open":y.isMenuOpen}]),onClick:k},[T(d).isAuthenticated?(e(),s("div",{key:0,class:"avatar-wrapper",onClick:g},[z(oe,{src:T(f).currentAvatarUrl||T(d).avatarUrl,size:64,alt:T(d).displayName||"ç”¨æˆ¶"},null,8,["src","alt"])])):(e(),s("div",Ee,[...A[0]||(A[0]=[t("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),t("polyline",{points:"10 17 15 12 10 7"}),t("line",{x1:"15",y1:"12",x2:"3",y2:"12"})],-1)])]))],6))}}),Ge=U(Ye,[["__scopeId","data-v-0dc83e07"]]),Xe=["disabled","onClick"],Ve={class:"item-icon"},Je={class:"item-label"},Ke=P({__name:"RadialMenu",props:{isOpen:{type:Boolean},items:{},centerX:{},centerY:{},radius:{}},emits:["close"],setup(y,{emit:a}){const i=y,p=a,d=X(),f=V(),k=r(()=>i.radius||100),g=r(()=>{const v=i.items,C=v.length;if(C===0)return[];const o=2*Math.PI/C;return v.map((S,$)=>{const M=$*o-Math.PI/2,D=Math.cos(M)*k.value,W=Math.sin(M)*k.value;return{...S,x:D,y:W,angle:M*180/Math.PI,index:$,total:C}})}),x=v=>v.to?f.name===v.to.name:!1;function c(v){v.disabled||!v.to||(p("close"),setTimeout(()=>{d.push(v.to)},200))}function A(){p("close")}const w=r(()=>({position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",zIndex:999,opacity:i.isOpen?1:0,pointerEvents:i.isOpen?"auto":"none",transition:"opacity 0.3s ease"})),j=r(()=>({position:"fixed",left:`${i.centerX}px`,top:`${i.centerY}px`,transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:i.isOpen?"auto":"none"}));return(v,C)=>(e(),s(b,null,[t("div",{style:O(w.value),class:"radial-menu-overlay",onClick:A},null,4),t("div",{style:O(j.value),class:"radial-menu-container"},[y.isOpen?(e(),h(ye,{key:0,name:"radial-item",tag:"div",class:"radial-menu-items"},{default:Y(()=>[(e(!0),s(b,null,q(g.value,(o,S)=>(e(),s("button",{key:`${o.label}-${S}`,class:N(["radial-menu-item",{"is-active":x(o),"is-disabled":o.disabled}]),style:O({"--x":`${o.x}px`,"--y":`${o.y}px`,"--index":o.index,"--total":o.total}),disabled:o.disabled,onClick:$=>c(o)},[t("span",Ve,[o.iconType==="bean"?(e(),h(B,{key:0,size:24})):o.iconType==="lucide"&&o.icon?(e(),h(L(o.icon),{key:1,size:24,"stroke-width":2,class:"lucide-icon"})):o.icon?(e(),s(b,{key:2},[I(m(o.icon),1)],64)):_("",!0)]),t("span",Je,m(o.label),1)],14,Xe))),128))]),_:1})):_("",!0)],4)],64))}}),Qe=U(Ke,[["__scopeId","data-v-1bc3371b"]]),Ze={class:"mobile-radial-menu"},et=P({__name:"MobileRadialMenu",setup(y){const a=G(),i=X(),p=V(),d=F(!1),f=[{label:"é¦–é ",icon:ee,iconType:"lucide",to:{name:"home"}},{label:"å¥è±†",icon:B,iconType:"bean",to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:ie,iconType:"lucide",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:te,iconType:"lucide",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:ne,iconType:"lucide",to:{name:"history"},description:"æ­·å²"},{label:"è±†èŽ¢",icon:se,iconType:"lucide",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:ae,iconType:"lucide",to:{name:"my-texts"},teacherOnly:!0}],k=[{label:"ç·´ç¿’æ–‡åº«",icon:ce,iconType:"lucide",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",icon:le,iconType:"lucide",to:{name:"admin-reading"}},{label:"ç”¨æˆ¶ç®¡ç†",icon:re,iconType:"lucide",to:{name:"admin-users"},superAdminOnly:!0}],g=r(()=>f.filter(o=>!o.teacherOnly||a.isTeacher)),x=r(()=>!a.isAuthenticated||!a.isAdmin?[]:k.filter(o=>o.superAdminOnly?a.isSuperAdmin:!0)),c=r(()=>[...g.value,...x.value]);function A(){d.value=!d.value}function w(){d.value=!1}function j(){a.isAuthenticated&&(i.push({name:"profile"}),w())}E(()=>p.name,()=>{d.value&&w()});const v=r(()=>typeof window>"u"?300:window.innerWidth-52),C=r(()=>typeof window>"u"?600:window.innerHeight-52);return(o,S)=>(e(),s("div",Ze,[z(Ge,{"is-menu-open":d.value,onToggleMenu:A,onAvatarClick:j},null,8,["is-menu-open"]),c.value.length>0?(e(),h(Qe,{key:0,"is-open":d.value,items:c.value,"center-x":v.value,"center-y":C.value,radius:100,onClose:w},null,8,["is-open","items","center-x","center-y"])):_("",!0)]))}}),tt=U(et,[["__scopeId","data-v-62f5c3e2"]]),nt={class:"app-layout"},st={class:"app-main"},at={class:"app-content"},it=P({__name:"AppLayout",setup(y){return(a,i)=>{const p=Z("router-view");return e(),s("div",nt,[z(We),z(tt),t("section",st,[t("div",at,[z(p)])])])}}}),yt=U(it,[["__scopeId","data-v-19942d51"]]);export{yt as default};
