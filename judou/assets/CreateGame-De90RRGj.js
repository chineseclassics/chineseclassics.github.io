import{d as D,u as F,r,c as I,f as U,a,g as e,h as v,i as d,l as j,s as O,F as p,j as _,e as N,p as q,v as H,t as o,P as M,b as C,n as J,o as l,_ as K}from"./index-DtjCPqHI.js";import{u as Q}from"./gameStore-CRJGqsKM.js";import{a as W,T as X,b as E,c as g}from"./game-pGsr7gx9.js";import{T as Y}from"./TextSelector-DOqfXK9s.js";import"./userStatsStore-C_Lb_rqO.js";const Z={class:"create-game-page"},ee={class:"steps-indicator"},se={key:0},te={key:1},ae={class:"step-content"},le={key:0,class:"step-panel"},ne={key:0,class:"empty-state"},oe={key:1,class:"class-grid"},ie=["onClick"],re={class:"class-name"},ue={key:1,class:"step-panel"},de={key:2,class:"step-panel"},ce={class:"setting-group"},ve={class:"team-count-options"},me=["onClick"],pe={class:"teams-preview"},_e={class:"setting-group"},fe={class:"time-options"},be=["onClick"],ke={class:"time-label"},ye={class:"time-desc"},he={class:"confirm-card"},Ce={class:"confirm-row"},ge={class:"confirm-value"},xe={class:"confirm-row texts-row"},Se={class:"confirm-texts"},Te={class:"text-order"},we={class:"text-name"},Ie={class:"confirm-row"},Oe={class:"confirm-value"},Ne={class:"confirm-row"},Me={class:"confirm-value"},Ee={key:0,class:"error-message"},Ge={class:"nav-buttons"},Le=["disabled"],Ve=["disabled"],x=3,$e=D({__name:"CreateGame",setup(Ae){const S=j(),G=F(),T=Q(),n=r(1),u=r(""),k=r([]),f=r(2),y=r(180),m=r([]),b=r(!1),i=r(""),w=r(null),L=I(()=>w.value?.selectedTexts||[]),V=I(()=>W(f.value));function $(c){k.value=c}async function A(){if(!M)return;const{data:c}=await M.from("classes").select("id, class_name").eq("teacher_id",G.user?.id).order("created_at",{ascending:!1});m.value=c||[],m.value.length>0&&!u.value&&(u.value=m.value[0].id)}function B(){if(n.value===1&&!u.value){i.value="è«‹é¸æ“‡ç­ç´š";return}if(n.value===2&&k.value.length===0){i.value="è«‹è‡³å°‘é¸æ“‡ä¸€ç¯‡æ–‡æœ¬";return}i.value="",n.value++}function P(){i.value="",n.value--}async function R(){if(!u.value||k.value.length===0){i.value="è«‹å®Œæˆæ‰€æœ‰è¨­ç½®";return}b.value=!0,i.value="";const c=await T.createRoom({hostType:"teacher",gameMode:"team_battle",textIds:k.value,timeLimit:y.value,teamCount:f.value,classId:u.value});c?S.push({name:"arena-teacher-lobby",params:{roomId:c.id}}):i.value=T.error||"å‰µå»ºå¤±æ•—",b.value=!1}return U(async()=>{await A()}),(c,s)=>{const z=H("router-link");return l(),a("div",Z,[e("button",{class:"back-btn",onClick:s[0]||(s[0]=t=>d(S).push({name:"arena"}))}," â† è¿”å›žé¬¥è±† "),s[17]||(s[17]=e("header",{class:"page-header"},[e("h1",null,[e("span",{class:"title-icon"},"ðŸ“¢"),O(" å‰µå»ºèª²å ‚é¬¥è±† ")]),e("p",{class:"subtitle"},"è¨­ç½®æ¯”è³½åƒæ•¸ï¼Œè®“å­¸ç”Ÿåˆ†çµ„ç«¶æŠ€")],-1)),e("div",ee,[(l(),a(p,null,_(x,t=>e("div",{key:t,class:C(["step-dot",{active:n.value===t,completed:n.value>t}])},[n.value>t?(l(),a("span",se,"âœ“")):(l(),a("span",te,o(t),1))],2)),64))]),e("div",ae,[n.value===1?(l(),a("div",le,[s[4]||(s[4]=e("h2",null,"é¸æ“‡ç­ç´š",-1)),s[5]||(s[5]=e("p",{class:"step-hint"},"é¸æ“‡è¦é€²è¡Œæ¯”è³½çš„ç­ç´š",-1)),m.value.length===0?(l(),a("div",ne,[s[2]||(s[2]=e("p",null,"æ‚¨é‚„æ²’æœ‰å‰µå»ºç­ç´š",-1)),N(z,{to:"/my-classes",class:"btn-secondary"},{default:q(()=>[...s[1]||(s[1]=[O(" åŽ»å‰µå»ºç­ç´š â†’ ",-1)])]),_:1})])):(l(),a("div",oe,[(l(!0),a(p,null,_(m.value,t=>(l(),a("button",{key:t.id,class:C(["class-card",{selected:u.value===t.id}]),onClick:h=>u.value=t.id},[s[3]||(s[3]=e("span",{class:"class-icon"},"ðŸ«",-1)),e("span",re,o(t.class_name),1)],10,ie))),128))]))])):v("",!0),n.value===2?(l(),a("div",ue,[s[6]||(s[6]=e("h2",null,"é¸æ“‡æ¯”è³½æ–‡æœ¬",-1)),s[7]||(s[7]=e("p",{class:"step-hint"},"å¯é¸æ“‡å¤šç¯‡æ–‡ç« ï¼Œå­¸ç”Ÿå°‡æŒ‰é †åºåœ¨é™æ™‚å…§ç›¡é‡å®Œæˆ",-1)),N(Y,{ref_key:"textSelector",ref:w,"show-custom-texts":!0,"onUpdate:selectedIds":$},null,512)])):v("",!0),n.value===3?(l(),a("div",de,[s[15]||(s[15]=e("h2",null,"æ¯”è³½è¨­ç½®",-1)),s[16]||(s[16]=e("p",{class:"step-hint"},"è¨­ç½®éšŠä¼æ•¸é‡å’Œæ™‚é–“é™åˆ¶",-1)),e("div",ce,[s[8]||(s[8]=e("label",{class:"setting-label"},"éšŠä¼æ•¸é‡",-1)),e("div",ve,[(l(!0),a(p,null,_(d(X),t=>(l(),a("button",{key:t,class:C(["count-btn",{selected:f.value===t}]),onClick:h=>f.value=t},o(t)+" éšŠ ",11,me))),128))]),e("div",pe,[(l(!0),a(p,null,_(V.value,t=>(l(),a("div",{key:t,class:"team-preview",style:J({background:d(g)[t].secondary,borderColor:d(g)[t].primary,color:d(g)[t].text})},o(d(g)[t].name),5))),128))])]),e("div",_e,[s[9]||(s[9]=e("label",{class:"setting-label"},"æ™‚é–“é™åˆ¶",-1)),e("div",fe,[(l(!0),a(p,null,_(d(E),t=>(l(),a("button",{key:t.value,class:C(["time-btn",{selected:y.value===t.value}]),onClick:h=>y.value=t.value},[e("span",ke,o(t.label),1),e("span",ye,o(t.description),1)],10,be))),128))])]),e("div",he,[s[14]||(s[14]=e("h3",null,"ç¢ºèªä¿¡æ¯",-1)),e("div",Ce,[s[10]||(s[10]=e("span",{class:"confirm-label"},"ç­ç´š",-1)),e("span",ge,o(m.value.find(t=>t.id===u.value)?.class_name),1)]),e("div",xe,[s[11]||(s[11]=e("span",{class:"confirm-label"},"æ–‡æœ¬",-1)),e("div",Se,[(l(!0),a(p,null,_(L.value,(t,h)=>(l(),a("div",{key:t.id,class:"confirm-text-item"},[e("span",Te,o(h+1)+".",1),e("span",we,o(t.title),1)]))),128))])]),e("div",Ie,[s[12]||(s[12]=e("span",{class:"confirm-label"},"éšŠä¼",-1)),e("span",Oe,o(f.value)+" éšŠ",1)]),e("div",Ne,[s[13]||(s[13]=e("span",{class:"confirm-label"},"æ™‚é–“",-1)),e("span",Me,o(d(E).find(t=>t.value===y.value)?.description),1)])])])):v("",!0)]),i.value?(l(),a("p",Ee,o(i.value),1)):v("",!0),e("div",Ge,[n.value>1?(l(),a("button",{key:0,class:"btn-secondary",onClick:P,disabled:b.value}," ä¸Šä¸€æ­¥ ",8,Le)):v("",!0),n.value<x?(l(),a("button",{key:1,class:"btn-primary",onClick:B}," ä¸‹ä¸€æ­¥ ")):v("",!0),n.value===x?(l(),a("button",{key:2,class:"btn-primary",onClick:R,disabled:b.value},o(b.value?"å‰µå»ºä¸­...":"å‰µå»ºèª²å ‚é¬¥è±†"),9,Ve)):v("",!0)])])}}}),Fe=K($e,[["__scopeId","data-v-2033f6fb"]]);export{Fe as default};
