import{d as X,c as S,a as v,n as G,b as Y,e as R,o as s,_ as K,u as le,r as D,w as q,f as ae,g as u,h as U,i as F,t as N,F as I,j as Q,k as pe,l as re,m as W,p as se,q as Z,s as J,v as fe,x as ue,y as $e,z as Pe,A as ye,B as he,C as me,D as Be,E as Ee,G as C,H as Ne,I as De,J as He,T as Ie}from"./index-DT_aK3wC.js";import{u as We}from"./userStatsStore-Cq9KECj7.js";import{u as Fe}from"./assignmentStore-53ONu879.js";import{u as ce}from"./avatarStore-BvFYaDFp.js";import{B as j}from"./BeanIcon-DJX6LT9H.js";import{H as ge,S as be,F as ke,U as we,P as _e}from"./users-1a87y3Xd.js";import{B as Se}from"./book-open-IH3H1GLw.js";import{c as de}from"./createLucideIcon-PqFrpjQO.js";import"./useSupabase-DHmlxS_Q.js";const Le=["src","alt"],Ue={key:1,class:"avatar-fallback"},Re=X({__name:"UserAvatar",props:{size:{default:40},src:{default:void 0},alt:{default:"ç”¨æˆ¶é ­åƒ"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:n}){const t=e,i=n,a=ce(),r=S(()=>t.src!==void 0?t.src:a.currentAvatarUrl),c=S(()=>{const l=typeof t.size=="number"?`${t.size}px`:t.size;return{width:l,height:l,minWidth:l,minHeight:l}}),x=S(()=>{const l=typeof t.size=="number"?t.size:parseInt(t.size);return Math.round(l*.5)});function T(){t.clickable&&i("click")}return(l,h)=>(s(),v("div",{class:Y(["user-avatar",{clickable:e.clickable}]),style:G(c.value),onClick:T},[r.value?(s(),v("img",{key:0,src:r.value,alt:e.alt,class:"avatar-img"},null,8,Le)):(s(),v("div",Ue,[R(j,{size:x.value},null,8,["size"])]))],6))}}),xe=K(Re,[["__scopeId","data-v-8f62ee97"]]);const Ae=de("book-marked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const Te=de("library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);const ze=de("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),je={class:"sidebar-shell edamame-glass"},Ve={class:"brand-avatar"},qe={class:"level-badge"},Je={class:"brand-info"},Ge={class:"beans-icon"},Ye={class:"beans-roller"},Xe={key:0,class:"secondary-stats"},Ke={class:"streak-display"},Qe={key:1,class:"login-section"},Ze={class:"sidebar-section"},et={key:0,class:"item-icon"},tt={class:"item-title"},nt={key:0,class:"badge"},it={key:1,class:"edamame-sidebar-item disabled"},at={key:0,class:"item-icon"},ot={class:"item-title"},st={key:2,class:"sidebar-section"},lt={key:0,class:"item-icon"},rt={class:"item-title"},ut={key:1,class:"edamame-sidebar-item disabled"},ct={key:0,class:"item-icon"},dt={class:"item-title"},vt=X({__name:"SidebarMenu",setup(e){const n=le(),t=We(),i=Fe(),a=ce(),r=re(),c=[{label:"é¦–é ",icon:ge,iconType:"lucide",to:{name:"home"}},{label:"å¥è±†",icon:j,iconType:"bean",to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:Se,iconType:"lucide",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:be,iconType:"lucide",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:ke,iconType:"lucide",to:{name:"history"},description:"æ­·å²"},{label:"è±†è¢",icon:we,iconType:"lucide",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:_e,iconType:"lucide",to:{name:"my-texts"},teacherOnly:!0}],x=[{label:"ç·´ç¿’æ–‡åº«",icon:Te,iconType:"lucide",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",icon:Ae,iconType:"lucide",to:{name:"admin-reading"}},{label:"ç”¨æˆ¶ç®¡ç†",icon:ze,iconType:"lucide",to:{name:"admin-users"},superAdminOnly:!0}],T=S(()=>c.filter(y=>!y.teacherOnly||n.isTeacher)),l=S(()=>!n.isAuthenticated||!n.isAdmin?[]:x.filter(y=>y.superAdminOnly?n.isSuperAdmin:!0)),h=ue(),b=y=>y.to?h.name===y.to.name:!1,z=S(()=>n.isAuthenticated?n.displayName||"è±†å‹":"è¨ªå®¢"),k=S(()=>t.profile?.total_beans??0),O=S(()=>t.level),p=S(()=>t.profile?.streak_days??0),m=D(0),w=D(!1),M=D(null),A=S(()=>m.value.toString().split("").map(d=>parseInt(d)));q(k,(y,d)=>{if(d===void 0||d===0){m.value=y;return}if(y===d)return;const E=y-d;M.value=E>0?"up":"down",w.value=!0,m.value=y,setTimeout(()=>{w.value=!1,M.value=null},800)},{immediate:!0});async function _(){await n.loginWithGoogle()}function P(){r.push({name:"profile"})}const B=D(0);q(()=>n.isAuthenticated,y=>{y?(console.log("[Sidebar] ç”¨æˆ¶å·²ç™»å…¥ï¼Œè¼‰å…¥ Profile å’Œé ­åƒ"),t.fetchProfile(),a.initialize(),n.isStudent&&i.fetchStudentAssignments().then(()=>{i.getPendingCount().then(d=>{B.value=d})})):(B.value=0,a.reset())},{immediate:!0}),ae(()=>{n.isAuthenticated&&n.isStudent&&i.fetchStudentAssignments().then(()=>{i.getPendingCount().then(y=>{B.value=y})})});const g="/judou/images/judou-logo.jpg";return(y,d)=>{const E=fe("router-link");return s(),v("aside",je,[F(n).isAuthenticated?(s(),v("div",{key:0,class:"sidebar-brand",onClick:P},[u("div",Ve,[R(xe,{src:F(a).currentAvatarUrl||F(n).avatarUrl,size:52,alt:z.value},null,8,["src","alt"]),u("div",qe,N(O.value),1)]),u("div",Je,[u("div",{class:Y(["beans-card",{"beans-animating":w.value,"beans-up":M.value==="up","beans-down":M.value==="down"}])},[u("div",Ge,[R(j,{size:24})]),u("div",Ye,[(s(!0),v(I,null,Q(A.value,(o,L)=>(s(),v("div",{key:L,class:"digit-slot"},[u("div",{class:"digit-roller",style:G({transform:`translateY(-${o*10}%)`})},[(s(),v(I,null,Q(10,te=>u("span",{key:te,class:"digit"},N(te-1),1)),64))],4)]))),128))])],2),p.value>0?(s(),v("div",Xe,[u("span",Ke,"ğŸ”¥ "+N(p.value)+"å¤©",1)])):U("",!0)]),d[0]||(d[0]=u("svg",{class:"arrow-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("path",{d:"M9 18l6-6-6-6"})],-1))])):(s(),v("div",Qe,[u("button",{class:"google-login-btn",onClick:_},[...d[1]||(d[1]=[pe('<svg class="google-icon" viewBox="0 0 24 24" width="18" height="18" data-v-913b1deb><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-913b1deb></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-913b1deb></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-913b1deb></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-913b1deb></path></svg><span data-v-913b1deb>ä½¿ç”¨ Google ç™»å…¥</span>',2)])]),d[2]||(d[2]=u("p",{class:"login-hint"},"ç™»å…¥å¾Œå¯ä¿å­˜å­¸ç¿’é€²åº¦",-1))])),u("nav",Ze,[u("ul",null,[(s(!0),v(I,null,Q(T.value,o=>(s(),v("li",{key:o.label},[o.to&&!o.disabled?(s(),W(E,{key:0,class:Y(["edamame-sidebar-item",{active:b(o)}]),to:o.to},{default:se(()=>[o.icon?(s(),v("span",et,[o.iconType==="bean"?(s(),W(j,{key:0,size:18})):o.iconType==="lucide"?(s(),W(Z(o.icon),{key:1,size:18,"stroke-width":1.5,class:"lucide-icon"})):(s(),v(I,{key:2},[J(N(o.icon),1)],64))])):U("",!0),u("p",tt,[J(N(o.label)+" ",1),o.label==="è±†è¢"&&F(n).isStudent&&B.value>0?(s(),v("span",nt,N(B.value),1)):U("",!0)])]),_:2},1032,["class","to"])):(s(),v("div",it,[o.icon?(s(),v("span",at,[o.iconType==="bean"?(s(),W(j,{key:0,size:18})):o.iconType==="lucide"?(s(),W(Z(o.icon),{key:1,size:18,"stroke-width":1.5,class:"lucide-icon"})):(s(),v(I,{key:2},[J(N(o.icon),1)],64))])):U("",!0),u("p",ot,N(o.label),1)]))]))),128))])]),l.value.length>0?(s(),v("nav",st,[d[3]||(d[3]=u("p",{class:"section-label"},"ç®¡ç†",-1)),u("ul",null,[(s(!0),v(I,null,Q(l.value,o=>(s(),v("li",{key:o.label},[o.to&&!o.disabled?(s(),W(E,{key:0,class:Y(["edamame-sidebar-item",{active:b(o),"super-admin-item":o.superAdminOnly}]),to:o.to},{default:se(()=>[o.icon?(s(),v("span",lt,[o.iconType==="lucide"?(s(),W(Z(o.icon),{key:0,size:16,"stroke-width":1.5,class:"lucide-icon"})):(s(),v(I,{key:1},[J(N(o.icon),1)],64))])):U("",!0),u("p",rt,N(o.label),1)]),_:2},1032,["class","to"])):(s(),v("div",ut,[o.icon?(s(),v("span",ct,[o.iconType==="lucide"?(s(),W(Z(o.icon),{key:0,size:16,"stroke-width":1.5,class:"lucide-icon"})):(s(),v(I,{key:1},[J(N(o.icon),1)],64))])):U("",!0),u("p",dt,N(o.label),1)]))]))),128))])])):U("",!0),u("div",{class:"sidebar-footer"},[u("div",{class:"footer-brand"},[u("img",{src:g,alt:"å¥è±†",class:"footer-logo"}),d[4]||(d[4]=u("span",{class:"footer-title"},"å¥è±† 2.0",-1))]),d[5]||(d[5]=u("div",{class:"footer-credits"},[u("p",null,"é–‹ç™¼ï¼šæ±ªæ¶µå±¹ã€å¼µè€å¸«"),u("p",null,"ç¾è¡“ï¼šä¸å¥•è¾°ã€å¾æšæ´‹")],-1))])])}}}),pt=K(vt,[["__scopeId","data-v-913b1deb"]]),Ce=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ft=Object.prototype.toString,yt=e=>ft.call(e)==="[object Object]",ht=()=>{};function mt(...e){if(e.length!==1)return Ee(...e);const n=e[0];return typeof n=="function"?me(ye(()=>({get:n,set:ht}))):D(n)}function gt(e,n){function t(...i){return new Promise((a,r)=>{Promise.resolve(e(()=>n.apply(this,i),{fn:n,thisArg:this,args:i})).then(a).catch(r)})}return t}const Me=e=>e();function bt(e=Me,n={}){const{initialState:t="active"}=n,i=mt(t==="active");function a(){i.value=!1}function r(){i.value=!0}const c=(...x)=>{i.value&&e(...x)};return{isActive:me(i),pause:a,resume:r,eventFilter:c}}function oe(e){return Array.isArray(e)?e:[e]}function kt(e){return Be()}function wt(e,n,t={}){const{eventFilter:i=Me,...a}=t;return q(e,gt(i,n),a)}function _t(e,n,t={}){const{eventFilter:i,initialState:a="active",...r}=t,{eventFilter:c,pause:x,resume:T,isActive:l}=bt(i,{initialState:a});return{stop:wt(e,n,{...r,eventFilter:c}),pause:x,resume:T,isActive:l}}const St=_t;function xt(e,n={}){if(!$e(e))return Pe(e);const t=Array.isArray(e.value)?Array.from({length:e.value.length}):{};for(const i in e.value)t[i]=ye(()=>({get(){return e.value[i]},set(a){var r;if(!((r=C(n.replaceRef))!==null&&r!==void 0)||r)if(Array.isArray(e.value)){const c=[...e.value];c[i]=a,e.value=c}else{const c={...e.value,[i]:a};Object.setPrototypeOf(c,Object.getPrototypeOf(e.value)),e.value=c}else e.value[i]=a}}));return t}function At(e,n=!0,t){kt()?ae(e,t):n?e():he(e)}function Tt(e,n,t){return q(e,n,{...t,immediate:!0})}const V=Ce?window:void 0;function zt(e){var n;const t=C(e);return(n=t?.$el)!==null&&n!==void 0?n:t}function ee(...e){const n=(i,a,r,c)=>(i.addEventListener(a,r,c),()=>i.removeEventListener(a,r,c)),t=S(()=>{const i=oe(C(e[0])).filter(a=>a!=null);return i.every(a=>typeof a!="string")?i:void 0});return Tt(()=>{var i,a;return[(i=(a=t.value)===null||a===void 0?void 0:a.map(r=>zt(r)))!==null&&i!==void 0?i:[V].filter(r=>r!=null),oe(C(t.value?e[1]:e[0])),oe(F(t.value?e[2]:e[1])),C(t.value?e[3]:e[2])]},([i,a,r,c],x,T)=>{if(!i?.length||!a?.length||!r?.length)return;const l=yt(c)?{...c}:c,h=i.flatMap(b=>a.flatMap(z=>r.map(k=>n(b,z,k,l))));T(()=>{h.forEach(b=>b())})},{flush:"post"})}const ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ie="__vueuse_ssr_handlers__",Ct=Mt();function Mt(){return ie in ne||(ne[ie]=ne[ie]||{}),ne[ie]}function Ot(e,n){return Ct[e]||n}function $t(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Pt={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},ve="vueuse-storage";function Bt(e,n,t,i={}){var a;const{flush:r="pre",deep:c=!0,listenToStorageChanges:x=!0,writeDefaults:T=!0,mergeDefaults:l=!1,shallow:h,window:b=V,eventFilter:z,onError:k=f=>{console.error(f)},initOnMounted:O}=i,p=(h?Ne:D)(typeof n=="function"?n():n),m=S(()=>C(e));if(!t)try{t=Ot("getDefaultStorage",()=>V?.localStorage)()}catch(f){k(f)}if(!t)return p;const w=C(n),M=$t(w),A=(a=i.serializer)!==null&&a!==void 0?a:Pt[M],{pause:_,resume:P}=St(p,f=>E(f),{flush:r,deep:c,eventFilter:z});q(m,()=>L(),{flush:r});let B=!1;const g=f=>{O&&!B||L(f)},y=f=>{O&&!B||te(f)};b&&x&&(t instanceof Storage?ee(b,"storage",g,{passive:!0}):ee(b,ve,y)),O?At(()=>{B=!0,L()}):L();function d(f,$){if(b){const H={key:m.value,oldValue:f,newValue:$,storageArea:t};b.dispatchEvent(t instanceof Storage?new StorageEvent("storage",H):new CustomEvent(ve,{detail:H}))}}function E(f){try{const $=t.getItem(m.value);if(f==null)d($,null),t.removeItem(m.value);else{const H=A.write(f);$!==H&&(t.setItem(m.value,H),d($,H))}}catch($){k($)}}function o(f){const $=f?f.newValue:t.getItem(m.value);if($==null)return T&&w!=null&&t.setItem(m.value,A.write(w)),w;if(!f&&l){const H=A.read($);return typeof l=="function"?l(H,w):M==="object"&&!Array.isArray(H)?{...w,...H}:H}else return typeof $!="string"?$:A.read($)}function L(f){if(!(f&&f.storageArea!==t)){if(f&&f.key==null){p.value=w;return}if(!(f&&f.key!==m.value)){_();try{const $=A.write(p.value);(f===void 0||f?.newValue!==$)&&(p.value=o(f))}catch($){k($)}finally{f?he(P):P()}}}}function te(f){L(f.detail)}return p}function Et(e,n={}){var t;const{pointerTypes:i,preventDefault:a,stopPropagation:r,exact:c,onMove:x,onEnd:T,onStart:l,initialValue:h,axis:b="both",draggingElement:z=V,containerElement:k,handle:O=e,buttons:p=[0]}=n,m=D((t=C(h))!==null&&t!==void 0?t:{x:0,y:0}),w=D(),M=g=>i?i.includes(g.pointerType):!0,A=g=>{C(a)&&g.preventDefault(),C(r)&&g.stopPropagation()},_=g=>{var y;if(!C(p).includes(g.button)||C(n.disabled)||!M(g)||C(c)&&g.target!==C(e))return;const d=C(k),E=d==null||(y=d.getBoundingClientRect)===null||y===void 0?void 0:y.call(d),o=C(e).getBoundingClientRect(),L={x:g.clientX-(d?o.left-E.left+d.scrollLeft:o.left),y:g.clientY-(d?o.top-E.top+d.scrollTop:o.top)};l?.(L,g)!==!1&&(w.value=L,A(g))},P=g=>{if(C(n.disabled)||!M(g)||!w.value)return;const y=C(k),d=C(e).getBoundingClientRect();let{x:E,y:o}=m.value;(b==="x"||b==="both")&&(E=g.clientX-w.value.x,y&&(E=Math.min(Math.max(0,E),y.scrollWidth-d.width))),(b==="y"||b==="both")&&(o=g.clientY-w.value.y,y&&(o=Math.min(Math.max(0,o),y.scrollHeight-d.height))),m.value={x:E,y:o},x?.(m.value,g),A(g)},B=g=>{C(n.disabled)||!M(g)||w.value&&(w.value=void 0,T?.(m.value,g),A(g))};if(Ce){const g=()=>{var y;return{capture:(y=n.capture)!==null&&y!==void 0?y:!0,passive:!C(a)}};ee(O,"pointerdown",_,g),ee(z,"pointermove",P,g),ee(z,"pointerup",B,g)}return{...xt(m),position:m,isDragging:S(()=>!!w.value),style:S(()=>`left:${m.value.x}px;top:${m.value.y}px;`)}}function Oe(e,n,t={}){const{window:i=V}=t;return Bt(e,n,i?.localStorage,t)}const Nt={key:0,class:"drag-indicator"},Dt=200,Ht=X({__name:"FloatingAvatarButton",props:{isMenuOpen:{type:Boolean}},emits:["update:isMenuOpen","toggle-menu","avatar-click","update:position"],setup(e,{emit:n}){const t=e,i=n,a=le(),r=ce(),c=D(),T=Oe("judou-floating-avatar-position",typeof window>"u"?{x:300,y:600}:{x:window.innerWidth-80,y:window.innerHeight-80}),{x:l,y:h,isDragging:b}=Et(c,{initialValue:T.value,onEnd:()=>{typeof window<"u"&&(l.value>window.innerWidth-64&&(l.value=window.innerWidth-64),h.value>window.innerHeight-64&&(h.value=window.innerHeight-64),l.value<0&&(l.value=0),h.value<0&&(h.value=0)),T.value={x:l.value,y:h.value},i("update:position",l.value,h.value)}});q([l,h],([_,P])=>{typeof window<"u"&&(_>window.innerWidth-64&&(l.value=window.innerWidth-64),P>window.innerHeight-64&&(h.value=window.innerHeight-64),_<0&&(l.value=0),P<0&&(h.value=0)),i("update:position",l.value,h.value)},{immediate:!0});const z=D(null),k=D(!1);function O(){k.value=!1,z.value=window.setTimeout(()=>{k.value=!0},Dt)}function p(){z.value&&(clearTimeout(z.value),z.value=null),!k.value&&!b.value&&m(),k.value=!1}function m(){b.value||i("toggle-menu")}function w(_){_.stopPropagation(),i("avatar-click")}function M(){if(typeof window>"u")return;const _=64;l.value>window.innerWidth-_&&(l.value=window.innerWidth-_),h.value>window.innerHeight-_&&(h.value=window.innerHeight-_),l.value<0&&(l.value=0),h.value<0&&(h.value=0),T.value={x:l.value,y:h.value},i("update:position",l.value,h.value)}ae(()=>{typeof window<"u"&&(i("update:position",l.value,h.value),window.addEventListener("resize",M))}),De(()=>{typeof window<"u"&&window.removeEventListener("resize",M),z.value&&(clearTimeout(z.value),z.value=null)});const A=S(()=>({position:"fixed",left:`${l.value}px`,top:`${h.value}px`,zIndex:1e3,width:"64px",height:"64px",borderRadius:"50%",cursor:b.value?"grabbing":"grab",transition:b.value?"none":"transform 0.2s ease, box-shadow 0.2s ease",transform:t.isMenuOpen?"scale(1.1) rotate(45deg)":"scale(1)",boxShadow:b.value?"0 8px 24px rgba(0, 0, 0, 0.3)":"0 4px 16px rgba(0, 0, 0, 0.2)"}));return(_,P)=>(s(),v("div",{ref_key:"buttonRef",ref:c,style:G(A.value),class:Y(["floating-avatar-button",{"is-dragging":F(b),"is-menu-open":e.isMenuOpen,"is-long-pressing":k.value}]),onClick:m,onTouchstart:O,onTouchend:p},[F(a).isAuthenticated?(s(),v("div",{key:0,class:"avatar-wrapper",onClick:w},[R(xe,{src:F(r).currentAvatarUrl||F(a).avatarUrl,size:64,alt:F(a).displayName||"ç”¨æˆ¶"},null,8,["src","alt"]),F(b)?(s(),v("div",Nt,[...P[0]||(P[0]=[pe('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-0dcbc147><circle cx="9" cy="9" r="1" data-v-0dcbc147></circle><circle cx="15" cy="9" r="1" data-v-0dcbc147></circle><circle cx="9" cy="15" r="1" data-v-0dcbc147></circle><circle cx="15" cy="15" r="1" data-v-0dcbc147></circle></svg>',1)])])):U("",!0)])):(s(),v("div",{key:1,class:"login-icon",onClick:He(m,["stop"])},[...P[1]||(P[1]=[u("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[u("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),u("polyline",{points:"10 17 15 12 10 7"}),u("line",{x1:"15",y1:"12",x2:"3",y2:"12"})],-1)])]))],38))}}),It=K(Ht,[["__scopeId","data-v-0dcbc147"]]),Wt=["disabled","onClick"],Ft={class:"item-icon"},Lt={class:"item-label"},Ut=X({__name:"RadialMenu",props:{isOpen:{type:Boolean},items:{},centerX:{},centerY:{},radius:{}},emits:["close"],setup(e,{emit:n}){const t=e,i=n,a=re(),r=ue(),c=S(()=>t.radius||100),x=S(()=>{const k=t.items,O=k.length;if(O===0)return[];const p=2*Math.PI/O;return k.map((m,w)=>{const M=w*p-Math.PI/2,A=Math.cos(M)*c.value,_=Math.sin(M)*c.value;return{...m,x:A,y:_,angle:M*180/Math.PI,index:w,total:O}})}),T=k=>k.to?r.name===k.to.name:!1;function l(k){k.disabled||!k.to||(i("close"),setTimeout(()=>{a.push(k.to)},200))}function h(){i("close")}const b=S(()=>({position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",zIndex:999,opacity:t.isOpen?1:0,pointerEvents:t.isOpen?"auto":"none",transition:"opacity 0.3s ease"})),z=S(()=>({position:"fixed",left:`${t.centerX}px`,top:`${t.centerY}px`,transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:t.isOpen?"auto":"none"}));return(k,O)=>(s(),v(I,null,[u("div",{style:G(b.value),class:"radial-menu-overlay",onClick:h},null,4),u("div",{style:G(z.value),class:"radial-menu-container"},[R(Ie,{name:"radial-item",tag:"div",class:"radial-menu-items"},{default:se(()=>[(s(!0),v(I,null,Q(x.value,(p,m)=>(s(),v("button",{key:`${p.label}-${m}`,class:Y(["radial-menu-item",{"is-active":T(p),"is-disabled":p.disabled}]),style:G({"--x":`${p.x}px`,"--y":`${p.y}px`,"--index":p.index,"--total":p.total}),disabled:p.disabled,onClick:w=>l(p)},[u("span",Ft,[p.iconType==="bean"?(s(),W(j,{key:0,size:24})):p.iconType==="lucide"&&p.icon?(s(),W(Z(p.icon),{key:1,size:24,"stroke-width":2,class:"lucide-icon"})):p.icon?(s(),v(I,{key:2},[J(N(p.icon),1)],64)):U("",!0)]),u("span",Lt,N(p.label),1)],14,Wt))),128))]),_:1})],4)],64))}}),Rt=K(Ut,[["__scopeId","data-v-662ffa4a"]]),jt={class:"mobile-radial-menu"},Vt=X({__name:"MobileRadialMenu",setup(e){const n=le(),t=re(),i=ue(),a=D(!1),r=()=>typeof window>"u"?{x:300,y:600}:{x:window.innerWidth-80,y:window.innerHeight-80},c=Oe("judou-floating-avatar-position",r()),x=D({x:c.value?.x??r().x,y:c.value?.y??r().y}),T=[{label:"é¦–é ",icon:ge,iconType:"lucide",to:{name:"home"}},{label:"å¥è±†",icon:j,iconType:"bean",to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:Se,iconType:"lucide",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:be,iconType:"lucide",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:ke,iconType:"lucide",to:{name:"history"},description:"æ­·å²"},{label:"è±†è¢",icon:we,iconType:"lucide",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:_e,iconType:"lucide",to:{name:"my-texts"},teacherOnly:!0}],l=[{label:"ç·´ç¿’æ–‡åº«",icon:Te,iconType:"lucide",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",icon:Ae,iconType:"lucide",to:{name:"admin-reading"}},{label:"ç”¨æˆ¶ç®¡ç†",icon:ze,iconType:"lucide",to:{name:"admin-users"},superAdminOnly:!0}],h=S(()=>T.filter(A=>!A.teacherOnly||n.isTeacher)),b=S(()=>!n.isAuthenticated||!n.isAdmin?[]:l.filter(A=>A.superAdminOnly?n.isSuperAdmin:!0)),z=S(()=>[...h.value,...b.value]);function k(){a.value=!a.value}function O(){a.value=!1}function p(){n.isAuthenticated&&(t.push({name:"profile"}),O())}q(()=>i.name,()=>{a.value&&O()});function m(A,_){x.value={x:A,y:_}}const w=S(()=>x.value.x+32),M=S(()=>x.value.y+32);return ae(()=>{c.value&&(x.value={x:c.value.x??r().x,y:c.value.y??r().y})}),(A,_)=>(s(),v("div",jt,[R(It,{"is-menu-open":a.value,onToggleMenu:k,onAvatarClick:p,"onUpdate:position":_[0]||(_[0]=(P,B)=>m(P,B))},null,8,["is-menu-open"]),z.value.length>0?(s(),W(Rt,{key:0,"is-open":a.value,items:z.value,"center-x":w.value,"center-y":M.value,radius:100,onClose:O},null,8,["is-open","items","center-x","center-y"])):U("",!0)]))}}),qt=K(Vt,[["__scopeId","data-v-d6aeb374"]]),Jt={class:"app-layout"},Gt={class:"app-main"},Yt={class:"app-content"},Xt=X({__name:"AppLayout",setup(e){return(n,t)=>{const i=fe("router-view");return s(),v("div",Jt,[R(pt),R(qt),u("section",Gt,[u("div",Yt,[R(i)])])])}}}),ln=K(Xt,[["__scopeId","data-v-19942d51"]]);export{ln as default};
