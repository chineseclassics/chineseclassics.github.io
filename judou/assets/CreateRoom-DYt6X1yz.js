import{d as P,r as u,c as h,a as o,g as s,h as c,i as d,l as V,e as A,t as a,F as b,j as f,s as B,b as S,o as l,_ as z}from"./index-B4Bug-1h.js";import{u as D}from"./gameStore-DzafHp9_.js";import{u as U}from"./userStatsStore-D7GEOno2.js";import{T as Y}from"./TextSelector-Bk0O-j8Y.js";import{B as j}from"./BeanIcon-CHFVThFv.js";import{S as k,a as L,E as G}from"./game-C73ZBjL5.js";const q={class:"create-room-page"},H={class:"balance-card"},J={class:"balance-value"},K={class:"steps-indicator"},Q={key:0},W={key:1},X={class:"step-content"},Z={key:0,class:"step-panel"},ss={key:1,class:"step-panel"},es={class:"form-section"},ts={class:"player-options"},os=["onClick"],ls={class:"form-section"},as={class:"time-options"},ns=["onClick"],is={class:"option-label"},rs={class:"option-desc"},us={class:"form-section"},cs={class:"fee-options"},ds=["disabled","onClick"],vs={key:0,class:"fee-info"},_s={class:"safety-notice"},ps={class:"notice-text"},ms={class:"confirm-card"},bs={class:"confirm-row texts-row"},fs={class:"confirm-texts"},ks={class:"text-order"},ys={class:"text-name"},xs={class:"confirm-row"},Cs={class:"confirm-value"},Ss={class:"confirm-row"},hs={class:"confirm-value"},Is={class:"confirm-row"},Ns={class:"confirm-value"},gs={key:0,class:"error-message"},Es={class:"nav-buttons"},Ts=["disabled"],As=["disabled"],Bs=["disabled"],I=2,Ls=P({__name:"CreateRoom",setup(Ms){const N=V(),g=D(),M=U(),n=u(1),_=u([]),v=u(2),y=u(180),i=u(0),p=u(!1),r=u(""),E=u(null),x=h(()=>M.profile?.total_beans??0),T=h(()=>i.value===0?!0:x.value-i.value>=k.MIN_BALANCE),w=h(()=>E.value?.selectedTexts||[]);function F(m){_.value=m}function $(){if(n.value===1&&_.value.length===0){r.value="è«‹è‡³å°‘é¸æ“‡ä¸€ç¯‡æ–‡æœ¬";return}r.value="",n.value++}function R(){r.value="",n.value--}async function O(){if(_.value.length===0){r.value="è«‹é¸æ“‡æ–‡æœ¬";return}if(!T.value){r.value=`å¥è±†ä¸è¶³ï¼Œè³¬æˆ¶éœ€ä¿ç•™è‡³å°‘ ${k.MIN_BALANCE} å¥è±†`;return}p.value=!0,r.value="";const m=await g.createRoom({hostType:"student",gameMode:"pvp",textIds:_.value,timeLimit:y.value,maxPlayers:v.value,entryFee:i.value});m?N.push({name:"arena-lobby",params:{roomId:m.id}}):r.value=g.error||"å‰µå»ºå¤±æ•—",p.value=!1}return(m,e)=>(l(),o("div",q,[s("button",{class:"back-btn",onClick:e[0]||(e[0]=t=>d(N).push({name:"arena"}))}," â† è¿”å›žé¬¥è±† "),s("div",H,[A(j,{size:24,class:"balance-icon"}),s("span",J,a(x.value),1),e[1]||(e[1]=s("span",{class:"balance-label"},"æˆ‘çš„å¥è±†",-1))]),s("div",K,[(l(),o(b,null,f(I,t=>s("div",{key:t,class:S(["step-dot",{active:n.value===t,completed:n.value>t}])},[n.value>t?(l(),o("span",Q,"âœ“")):(l(),o("span",W,a(t),1))],2)),64))]),s("div",X,[n.value===1?(l(),o("div",Z,[e[2]||(e[2]=s("h2",null,"é¸æ“‡æ¯”è³½æ–‡æœ¬",-1)),e[3]||(e[3]=s("p",{class:"step-hint"},"å¯é¸æ“‡å¤šç¯‡æ–‡ç« ï¼Œå°æˆ°æ™‚æŒ‰é †åºå®Œæˆ",-1)),A(Y,{ref_key:"textSelector",ref:E,"show-custom-texts":!1,"onUpdate:selectedIds":F},null,512)])):c("",!0),n.value===2?(l(),o("div",ss,[e[15]||(e[15]=s("h2",null,"æ¯”è³½è¨­ç½®",-1)),e[16]||(e[16]=s("p",{class:"step-hint"},"è¨­ç½®å°æˆ°äººæ•¸ã€æ™‚é–“å’Œå…¥å ´è²»",-1)),s("div",es,[e[4]||(e[4]=s("label",{class:"section-label"},"å°æˆ°äººæ•¸",-1)),s("div",ts,[(l(),o(b,null,f([2,3,4],t=>s("button",{key:t,class:S(["option-btn",{selected:v.value===t}]),onClick:C=>v.value=t},a(t)+" äºº ",11,os)),64))])]),s("div",ls,[e[5]||(e[5]=s("label",{class:"section-label"},"æ™‚é–“é™åˆ¶",-1)),s("div",as,[(l(!0),o(b,null,f(d(L),t=>(l(),o("button",{key:t.value,class:S(["option-btn time-btn",{selected:y.value===t.value}]),onClick:C=>y.value=t.value},[s("span",is,a(t.label),1),s("span",rs,a(t.description),1)],10,ns))),128))])]),s("div",us,[e[9]||(e[9]=s("label",{class:"section-label"},"å…¥å ´è²»",-1)),s("div",cs,[(l(!0),o(b,null,f(d(G),t=>(l(),o("button",{key:t,class:S(["fee-btn",{selected:i.value===t,disabled:t>0&&x.value-t<d(k).MIN_BALANCE}]),disabled:t>0&&x.value-t<d(k).MIN_BALANCE,onClick:C=>i.value=t},a(t===0?"å…è²»":`${t} è±†`),11,ds))),128))]),i.value>0?(l(),o("div",vs,[s("p",null,[e[6]||(e[6]=B(" å…¥å ´è²»ï¼š",-1)),s("strong",null,a(i.value)+" è±†",1),B(" Ã— "+a(v.value)+" äºº = çŽæ±  ",1),s("strong",null,a(i.value*v.value)+" è±†",1)]),e[7]||(e[7]=s("p",{class:"fee-note"},"ç²å‹è€…æ”¶è±†ï¼",-1))])):c("",!0),s("div",_s,[e[8]||(e[8]=s("span",{class:"notice-icon"},"ðŸ›¡ï¸",-1)),s("span",ps," è³¬æˆ¶ä¿ç•™ "+a(d(k).MIN_BALANCE)+" è±† ",1)])]),s("div",ms,[e[14]||(e[14]=s("h3",null,"ç¢ºèªä¿¡æ¯",-1)),s("div",bs,[e[10]||(e[10]=s("span",{class:"confirm-label"},"æ–‡æœ¬",-1)),s("div",fs,[(l(!0),o(b,null,f(w.value,(t,C)=>(l(),o("div",{key:t.id,class:"confirm-text-item"},[s("span",ks,a(C+1)+".",1),s("span",ys,a(t.title),1)]))),128))])]),s("div",xs,[e[11]||(e[11]=s("span",{class:"confirm-label"},"äººæ•¸",-1)),s("span",Cs,a(v.value)+" äºº",1)]),s("div",Ss,[e[12]||(e[12]=s("span",{class:"confirm-label"},"æ™‚é–“",-1)),s("span",hs,a(d(L).find(t=>t.value===y.value)?.description),1)]),s("div",Is,[e[13]||(e[13]=s("span",{class:"confirm-label"},"å…¥å ´è²»",-1)),s("span",Ns,a(i.value===0?"å…è²»":`${i.value} è±†`),1)])])])):c("",!0)]),r.value?(l(),o("p",gs,a(r.value),1)):c("",!0),s("div",Es,[n.value>1?(l(),o("button",{key:0,class:"btn-secondary",onClick:R,disabled:p.value}," ä¸Šä¸€æ­¥ ",8,Ts)):c("",!0),n.value<I?(l(),o("button",{key:1,class:"btn-primary",onClick:$,disabled:_.value.length===0}," ä¸‹ä¸€æ­¥ ",8,As)):c("",!0),n.value===I?(l(),o("button",{key:2,class:"btn-primary",onClick:O,disabled:p.value||!T.value},a(p.value?"å‰µå»ºä¸­...":"å‰µå»ºé¬¥è±†å ´"),9,Bs)):c("",!0)])]))}}),Vs=z(Ls,[["__scopeId","data-v-5ecec592"]]);export{Vs as default};
