import{d as w,u as x,r as o,v as A,a as l,b as s,e as g,t as c,z as h,A as y,F as D,h as E,H as u,o as n,_ as S}from"./index-j5Zq0Ivf.js";const V={class:"admin-classes-container"},$={class:"page-header"},B={key:0,class:"error-message"},F={key:1,class:"create-form edamame-glass"},N={class:"form-group"},q={class:"form-group"},z={class:"form-actions"},L=["disabled"],M={key:2,class:"loading"},P={key:3,class:"classes-grid"},T={class:"class-header"},U={class:"class-name"},H={class:"member-count"},I={key:0,class:"class-desc"},W={class:"class-footer"},j={class:"class-date"},G={class:"class-actions"},J=["onClick"],K={key:4,class:"empty-state edamame-glass"},O=w({__name:"AdminClassesPage",setup(Q){const d=x(),_=o([]),p=o(!1),r=o(null),m=o(!1),i=o(""),v=o(""),f=o(!1);async function b(){if(!(!u||!d.user)){p.value=!0,r.value=null;try{const{data:a,error:e}=await u.from("classes").select(`
        id,
        class_name,
        description,
        created_at,
        is_active,
        class_members(count)
      `).eq("teacher_id",d.user.id).order("created_at",{ascending:!1});if(e)throw e;_.value=(a||[]).map(t=>({...t,member_count:t.class_members?.[0]?.count||0}))}catch(a){r.value=a.message}finally{p.value=!1}}}async function C(){if(!(!u||!d.user||!i.value.trim())){f.value=!0;try{const{error:a}=await u.from("classes").insert({teacher_id:d.user.id,class_name:i.value.trim(),description:v.value.trim()||null});if(a)throw a;await b(),i.value="",v.value="",m.value=!1}catch(a){r.value=a.message}finally{f.value=!1}}}async function k(a){if(!(!u||!confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§ÈÄôÂÄãÁè≠Á¥öÂóéÔºü")))try{const{error:e}=await u.from("classes").delete().eq("id",a);if(e)throw e;await b()}catch(e){r.value=e.message}}return A(()=>{d.isAuthenticated&&b()}),(a,e)=>(n(),l("main",V,[s("header",$,[e[5]||(e[5]=s("div",null,[s("h1",{class:"page-title"},"Áè≠Á¥öÁÆ°ÁêÜ"),s("p",{class:"page-subtitle"},"ÂâµÂª∫ÂíåÁÆ°ÁêÜ‰Ω†ÁöÑÁè≠Á¥ö")],-1)),s("button",{class:"create-btn",onClick:e[0]||(e[0]=t=>m.value=!0)}," + Êñ∞Âª∫Áè≠Á¥ö ")]),r.value?(n(),l("div",B,c(r.value),1)):g("",!0),m.value?(n(),l("section",F,[e[8]||(e[8]=s("h2",null,"Êñ∞Âª∫Áè≠Á¥ö",-1)),s("div",N,[e[6]||(e[6]=s("label",null,"Áè≠Á¥öÂêçÁ®± *",-1)),h(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>i.value=t),type:"text",placeholder:"‰æãÂ¶ÇÔºö‰∏ÉÂπ¥Á¥öAÁè≠",class:"form-input"},null,512),[[y,i.value]])]),s("div",q,[e[7]||(e[7]=s("label",null,"Áè≠Á¥öÊèèËø∞",-1)),h(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=t=>v.value=t),placeholder:"ÈÅ∏Â°´ÔºåÁ∞°ÂñÆÊèèËø∞ÈÄôÂÄãÁè≠Á¥ö",class:"form-textarea",rows:"2"},null,512),[[y,v.value]])]),s("div",z,[s("button",{class:"cancel-btn",onClick:e[3]||(e[3]=t=>m.value=!1)},"ÂèñÊ∂à"),s("button",{class:"submit-btn",onClick:C,disabled:!i.value.trim()||f.value},c(f.value?"ÂâµÂª∫‰∏≠...":"ÂâµÂª∫Áè≠Á¥ö"),9,L)])])):g("",!0),p.value?(n(),l("div",M," ËºâÂÖ•‰∏≠... ")):_.value.length>0?(n(),l("section",P,[(n(!0),l(D,null,E(_.value,t=>(n(),l("article",{key:t.id,class:"class-card edamame-glass"},[s("div",T,[s("h3",U,c(t.class_name),1),s("span",H,c(t.member_count)+" ÂêçÂ≠∏Áîü",1)]),t.description?(n(),l("p",I,c(t.description),1)):g("",!0),s("div",W,[s("span",j," ÂâµÂª∫Êñº "+c(new Date(t.created_at).toLocaleDateString("zh-TW")),1),s("div",G,[e[9]||(e[9]=s("button",{class:"action-btn view-btn"},"Êü•ÁúãÊàêÂì°",-1)),s("button",{class:"action-btn delete-btn",onClick:R=>k(t.id)},"Âà™Èô§",8,J)])])]))),128))])):(n(),l("section",K,[e[10]||(e[10]=s("div",{class:"empty-icon"},"üìö",-1)),e[11]||(e[11]=s("h2",null,"ÈÇÑÊ≤íÊúâÁè≠Á¥ö",-1)),e[12]||(e[12]=s("p",null,"ÈªûÊìä„ÄåÊñ∞Âª∫Áè≠Á¥ö„ÄçÈñãÂßãÂâµÂª∫‰Ω†ÁöÑÁ¨¨‰∏ÄÂÄãÁè≠Á¥ö",-1)),s("button",{class:"create-btn",onClick:e[4]||(e[4]=t=>m.value=!0)}," + Êñ∞Âª∫Áè≠Á¥ö ")]))]))}}),Y=S(O,[["__scopeId","data-v-d2a63611"]]);export{Y as default};
