import{d as Y,u as K,m as u,r as O,w as X,o as ve,c as s,a as t,f as M,j as I,e as D,t as y,n as q,F as w,p as L,b as me,k as Q,q as E,s as k,x as V,y as R,i as H,z as te,A as Z,l as e,_ as W,g as ye,h as he,B as be,T as fe}from"./index-BCBmYA5M.js";import{u as ge}from"./userStatsStore-43VgGOYK.js";import{u as ke}from"./assignmentStore-DC0zbAJp.js";import{u as ne}from"./avatarStore-qPyXnmO-.js";import{B as F}from"./BeanIcon-DkS36WAk.js";import{U as se}from"./UserAvatar-BKAdo35E.js";import{H as J,S as ae,F as oe,U as ie,P as le}from"./users-YWaoHwTh.js";import{B as ce}from"./book-open-CVDj7aXy.js";import{c as G}from"./createLucideIcon-kzaM2Zfa.js";import"./useSupabase-nLLVokVq.js";const re=G("book-marked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const _e=G("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);const ue=G("library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);const de=G("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),xe={class:"sidebar-shell edamame-glass"},Ae={class:"brand-avatar"},we={class:"level-badge"},Te={class:"brand-info"},Me={class:"beans-icon"},Se={class:"beans-roller"},Ce={key:0,class:"secondary-stats"},ze={class:"streak-display"},$e={key:1,class:"login-section"},Be={class:"sidebar-section"},Ie={key:0,class:"item-icon"},Oe={class:"item-title"},De={key:0,class:"badge"},Ne={key:1,class:"edamame-sidebar-item disabled"},Pe={key:0,class:"item-icon"},Ue={class:"item-title"},je={key:2,class:"sidebar-section"},He={key:0,class:"item-icon"},Fe={class:"item-title"},Le={key:1,class:"edamame-sidebar-item disabled"},Re={key:0,class:"item-icon"},qe={class:"item-title"},Ee=Y({__name:"SidebarMenu",setup(S){const o=K(),d=ge(),m=ke(),p=ne(),_=Q(),x=[{label:"é¦–é ",icon:J,iconType:"lucide",to:{name:"home"}},{label:"å¥è±†",icon:F,iconType:"bean",to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:ce,iconType:"lucide",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:ae,iconType:"lucide",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:oe,iconType:"lucide",to:{name:"history"},description:"æ­·å²"},{label:"è±†è¢",icon:ie,iconType:"lucide",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:le,iconType:"lucide",to:{name:"my-texts"},teacherOnly:!0}],C=[{label:"ç·´ç¿’æ–‡åº«",icon:ue,iconType:"lucide",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",icon:re,iconType:"lucide",to:{name:"admin-reading"}},{label:"ç”¨æˆ¶ç®¡ç†",icon:de,iconType:"lucide",to:{name:"admin-users"},superAdminOnly:!0}],z=u(()=>x.filter(l=>!l.teacherOnly||o.isTeacher)),T=u(()=>!o.isAuthenticated||!o.isAdmin?[]:C.filter(l=>l.superAdminOnly?o.isSuperAdmin:!0)),A=Z(),N=l=>l.to?A.name===l.to.name:!1,P=u(()=>o.isAuthenticated?o.displayName||"è±†å‹":"è¨ªå®¢"),v=u(()=>d.profile?.total_beans??0),h=u(()=>d.level),a=u(()=>d.profile?.streak_days??0),$=O(0),B=O(!1),b=O(null),c=u(()=>$.value.toString().split("").map(i=>parseInt(i)));X(v,(l,i)=>{if(i===void 0||i===0){$.value=l;return}if(l===i)return;const j=l-i;b.value=j>0?"up":"down",B.value=!0,$.value=l,setTimeout(()=>{B.value=!1,b.value=null},800)},{immediate:!0});async function f(){await o.loginWithGoogle()}function r(){_.push({name:"profile"})}const g=O(0);X(()=>o.isAuthenticated,l=>{l?(console.log("[Sidebar] ç”¨æˆ¶å·²ç™»å…¥ï¼Œè¼‰å…¥ Profile å’Œé ­åƒ"),d.fetchProfile(),p.initialize(),o.isStudent&&m.fetchStudentAssignments().then(()=>{m.getPendingCount().then(i=>{g.value=i})})):(g.value=0,p.reset())},{immediate:!0}),ve(()=>{o.isAuthenticated&&o.isStudent&&m.fetchStudentAssignments().then(()=>{m.getPendingCount().then(l=>{g.value=l})})});const U="/judou/images/judou-logo.jpg";return(l,i)=>{const j=te("router-link");return e(),s("aside",xe,[I(o).isAuthenticated?(e(),s("div",{key:0,class:"sidebar-brand",onClick:r},[t("div",Ae,[D(se,{src:I(p).currentAvatarUrl||I(o).avatarUrl,size:52,alt:P.value},null,8,["src","alt"]),t("div",we,y(h.value),1)]),t("div",Te,[t("div",{class:q(["beans-card",{"beans-animating":B.value,"beans-up":b.value==="up","beans-down":b.value==="down"}])},[t("div",Me,[D(F,{size:24})]),t("div",Se,[(e(!0),s(w,null,L(c.value,(n,pe)=>(e(),s("div",{key:pe,class:"digit-slot"},[t("div",{class:"digit-roller",style:E({transform:`translateY(-${n*10}%)`})},[(e(),s(w,null,L(10,ee=>t("span",{key:ee,class:"digit"},y(ee-1),1)),64))],4)]))),128))])],2),a.value>0?(e(),s("div",Ce,[t("span",ze,"ğŸ”¥ "+y(a.value)+"å¤©",1)])):M("",!0)]),i[0]||(i[0]=t("svg",{class:"arrow-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})],-1))])):(e(),s("div",$e,[t("button",{class:"google-login-btn",onClick:f},[...i[1]||(i[1]=[me('<svg class="google-icon" viewBox="0 0 24 24" width="18" height="18" data-v-913b1deb><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-913b1deb></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-913b1deb></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-913b1deb></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-913b1deb></path></svg><span data-v-913b1deb>ä½¿ç”¨ Google ç™»å…¥</span>',2)])]),i[2]||(i[2]=t("p",{class:"login-hint"},"ç™»å…¥å¾Œå¯ä¿å­˜å­¸ç¿’é€²åº¦",-1))])),t("nav",Be,[t("ul",null,[(e(!0),s(w,null,L(z.value,n=>(e(),s("li",{key:n.label},[n.to&&!n.disabled?(e(),k(j,{key:0,class:q(["edamame-sidebar-item",{active:N(n)}]),to:n.to},{default:V(()=>[n.icon?(e(),s("span",Ie,[n.iconType==="bean"?(e(),k(F,{key:0,size:18})):n.iconType==="lucide"?(e(),k(R(n.icon),{key:1,size:18,"stroke-width":1.5,class:"lucide-icon"})):(e(),s(w,{key:2},[H(y(n.icon),1)],64))])):M("",!0),t("p",Oe,[H(y(n.label)+" ",1),n.label==="è±†è¢"&&I(o).isStudent&&g.value>0?(e(),s("span",De,y(g.value),1)):M("",!0)])]),_:2},1032,["class","to"])):(e(),s("div",Ne,[n.icon?(e(),s("span",Pe,[n.iconType==="bean"?(e(),k(F,{key:0,size:18})):n.iconType==="lucide"?(e(),k(R(n.icon),{key:1,size:18,"stroke-width":1.5,class:"lucide-icon"})):(e(),s(w,{key:2},[H(y(n.icon),1)],64))])):M("",!0),t("p",Ue,y(n.label),1)]))]))),128))])]),T.value.length>0?(e(),s("nav",je,[i[3]||(i[3]=t("p",{class:"section-label"},"ç®¡ç†",-1)),t("ul",null,[(e(!0),s(w,null,L(T.value,n=>(e(),s("li",{key:n.label},[n.to&&!n.disabled?(e(),k(j,{key:0,class:q(["edamame-sidebar-item",{active:N(n),"super-admin-item":n.superAdminOnly}]),to:n.to},{default:V(()=>[n.icon?(e(),s("span",He,[n.iconType==="lucide"?(e(),k(R(n.icon),{key:0,size:16,"stroke-width":1.5,class:"lucide-icon"})):(e(),s(w,{key:1},[H(y(n.icon),1)],64))])):M("",!0),t("p",Fe,y(n.label),1)]),_:2},1032,["class","to"])):(e(),s("div",Le,[n.icon?(e(),s("span",Re,[n.iconType==="lucide"?(e(),k(R(n.icon),{key:0,size:16,"stroke-width":1.5,class:"lucide-icon"})):(e(),s(w,{key:1},[H(y(n.icon),1)],64))])):M("",!0),t("p",qe,y(n.label),1)]))]))),128))])])):M("",!0),t("div",{class:"sidebar-footer"},[t("div",{class:"footer-brand"},[t("img",{src:U,alt:"å¥è±†",class:"footer-logo"}),i[4]||(i[4]=t("span",{class:"footer-title"},"å¥è±† 2.0",-1))]),i[5]||(i[5]=t("div",{class:"footer-credits"},[t("p",null,"é–‹ç™¼ï¼šæ±ªæ¶µå±¹ã€å¼µè€å¸«"),t("p",null,"ç¾è¡“ï¼šä¸å¥•è¾°ã€å¾æšæ´‹")],-1))])])}}}),Ye=W(Ee,[["__scopeId","data-v-913b1deb"]]),We={key:0,class:"avatar-wrapper"},Ge={key:1,class:"login-icon"},Xe=300,Ve=Y({__name:"FloatingAvatarButton",props:{isMenuOpen:{type:Boolean}},emits:["toggle-menu","avatar-click"],setup(S,{emit:o}){const d=S,m=o,p=K(),_=ne(),x=O(0);function C(T){T.stopPropagation(),T.preventDefault();const A=Date.now();A-x.value<Xe||(x.value=A,m("toggle-menu"))}const z=u(()=>({position:"fixed",right:"20px",bottom:"20px",zIndex:1e3,width:"64px",height:"64px",borderRadius:"50%",cursor:"pointer",transition:"transform 0.2s ease, box-shadow 0.2s ease",transform:d.isMenuOpen?"scale(1.1)":"scale(1)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.2)"}));return(T,A)=>(e(),s("div",{style:E(z.value),class:q(["floating-avatar-button",{"is-menu-open":S.isMenuOpen}]),onClick:C,onTouchstart:ye(C,["prevent"])},[I(p).isAuthenticated?(e(),s("div",We,[D(se,{src:I(_).currentAvatarUrl||I(p).avatarUrl,size:64,alt:I(p).displayName||"ç”¨æˆ¶"},null,8,["src","alt"])])):(e(),s("div",Ge,[...A[0]||(A[0]=[t("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),t("polyline",{points:"10 17 15 12 10 7"}),t("line",{x1:"15",y1:"12",x2:"3",y2:"12"})],-1)])]))],38))}}),Je=W(Ve,[["__scopeId","data-v-1871042f"]]),Ke=["disabled","onClick"],Qe={class:"item-icon"},Ze={class:"item-label"},et=Y({__name:"RadialMenu",props:{isOpen:{type:Boolean},items:{},centerX:{},centerY:{},radius:{}},emits:["close","item-click"],setup(S,{emit:o}){const d=S,m=o,p=Q(),_=Z(),x=u(()=>d.radius||100),C=u(()=>{const v=d.items,h=v.length;if(h===0)return[];const a=-90,B=Math.abs(-180-a),b=56;if(h===1){const f=v[0];if(!f)return[];const r=-135,g=r*Math.PI/180,U=Math.cos(g)*x.value-b/2,l=Math.sin(g)*x.value-b/2;return[{...f,left:U,top:l,angle:r,index:0,total:1,itemSize:b}]}return v.map((f,r)=>{const g=h>1?B/(h-1):0,U=a-r*g,l=U*Math.PI/180,i=Math.cos(l)*x.value-b/2,j=Math.sin(l)*x.value-b/2;return{...f,left:i,top:j,angle:U,index:r,total:h,itemSize:b}})}),z=v=>v.to?_.name===v.to.name:!1;function T(v){v.disabled||(m("item-click",v),v.to&&(m("close"),setTimeout(()=>{p.push(v.to)},200)))}function A(){m("close")}const N=u(()=>({position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",zIndex:999,opacity:d.isOpen?1:0,pointerEvents:d.isOpen?"auto":"none",transition:"opacity 0.3s ease"})),P=u(()=>({position:"fixed",left:`${d.centerX}px`,top:`${d.centerY}px`,transform:"translate(-50%, -50%)",zIndex:1e3,pointerEvents:d.isOpen?"auto":"none"}));return(v,h)=>(e(),s(w,null,[t("div",{style:E(N.value),class:"radial-menu-overlay",onClick:A},null,4),he(t("div",{style:E(P.value),class:"radial-menu-container"},[S.isOpen&&C.value.length>0?(e(),k(fe,{key:0,name:"radial-item",tag:"div",class:"radial-menu-items"},{default:V(()=>[(e(!0),s(w,null,L(C.value,(a,$)=>(e(),s("button",{key:`${a.label}-${$}`,class:q(["radial-menu-item",{"is-active":z(a),"is-disabled":a.disabled}]),style:E({left:`${a.left}px`,top:`${a.top}px`,width:`${a.itemSize}px`,height:`${a.itemSize}px`,"--index":a.index,"--total":a.total,"--angle":`${a.angle}deg`}),disabled:a.disabled,onClick:B=>T(a)},[t("span",Qe,[a.iconType==="bean"?(e(),k(F,{key:0,size:24})):a.iconType==="lucide"&&a.icon?(e(),k(R(a.icon),{key:1,size:24,"stroke-width":2,class:"lucide-icon"})):a.icon?(e(),s(w,{key:2},[H(y(a.icon),1)],64)):M("",!0)]),t("span",Ze,y(a.label),1)],14,Ke))),128))]),_:1})):M("",!0)],4),[[be,S.isOpen]])],64))}}),tt=W(et,[["__scopeId","data-v-b0a4cd81"]]),nt={class:"mobile-radial-menu"},st=Y({__name:"MobileRadialMenu",setup(S){const o=K(),d=Q(),m=Z(),p=O(!1),_=O("main"),x=[{label:"é¦–é ",icon:J,iconType:"lucide",to:{name:"home"}},{label:"å¥è±†",icon:F,iconType:"bean",to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:ce,iconType:"lucide",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:ae,iconType:"lucide",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:oe,iconType:"lucide",to:{name:"history"},description:"æ­·å²"},{label:"è±†è¢",icon:ie,iconType:"lucide",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:le,iconType:"lucide",to:{name:"my-texts"},teacherOnly:!0}],C=[{label:"ç·´ç¿’æ–‡åº«",icon:ue,iconType:"lucide",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",icon:re,iconType:"lucide",to:{name:"admin-reading"}},{label:"ç”¨æˆ¶ç®¡ç†",icon:de,iconType:"lucide",to:{name:"admin-users"},superAdminOnly:!0}],z=u(()=>x.filter(c=>!c.teacherOnly||o.isTeacher)),T=u(()=>!o.isAuthenticated||!o.isAdmin?[]:C.filter(c=>c.superAdminOnly?o.isSuperAdmin:!0)),A=u(()=>{const c=z.value,f=[c.find(r=>r.label==="é¦–é "),c.find(r=>r.label==="å¥è±†"),c.find(r=>r.label==="å“è±†"),c.find(r=>r.label==="é¬¥è±†")].filter(Boolean);return f.push({label:"æ›´å¤š",icon:_e,iconType:"lucide",to:void 0,disabled:!1}),f}),N=u(()=>{const c=z.value,f=["é¦–é ","å¥è±†","å“è±†","é¬¥è±†"],r=c.filter(g=>!f.includes(g.label));return r.push(...T.value),r.unshift({label:"è¿”å›",icon:J,iconType:"lucide",to:void 0,disabled:!1}),r}),P=u(()=>_.value==="main"?A.value:N.value);function v(){p.value=!p.value,p.value&&(_.value="main")}function h(){p.value=!1,_.value="main"}function a(c){if(c.label==="æ›´å¤š"&&!c.to){_.value="more";return}if(c.label==="è¿”å›"&&!c.to){_.value="main";return}c.to&&(d.push(c.to),h())}function $(){o.isAuthenticated&&(d.push({name:"profile"}),h())}X(()=>m.name,()=>{p.value&&h()});const B=u(()=>typeof window>"u"?300:window.innerWidth-52),b=u(()=>typeof window>"u"?600:window.innerHeight-52);return(c,f)=>(e(),s("div",nt,[D(Je,{"is-menu-open":p.value,onToggleMenu:v,onAvatarClick:$},null,8,["is-menu-open"]),P.value.length>0?(e(),k(tt,{key:0,"is-open":p.value,items:P.value,"center-x":B.value,"center-y":b.value,radius:160,onClose:h,onItemClick:a},null,8,["is-open","items","center-x","center-y"])):M("",!0)]))}}),at=W(st,[["__scopeId","data-v-6140cae0"]]),ot={class:"app-layout"},it={class:"app-main"},lt={class:"app-content"},ct=Y({__name:"AppLayout",setup(S){return(o,d)=>{const m=te("router-view");return e(),s("div",ot,[D(Ye),D(at),t("section",it,[t("div",lt,[D(m)])])])}}}),gt=W(ct,[["__scopeId","data-v-19942d51"]]);export{gt as default};
