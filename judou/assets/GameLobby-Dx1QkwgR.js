import{d as V,c,p as j,r as T,o as z,K as E,a as o,b as e,k as F,t as n,e as f,g as O,F as g,i as k,z as q,H,j as K,D as w,f as m,q as a,_ as P}from"./index-B7EwzyJl.js";import{u as U,c as _}from"./gameStore-B2a1S44z.js";import"./userStatsStore-BWRNoinc.js";const J={class:"game-lobby"},Q={class:"lobby-header"},W={class:"header-title"},X={class:"text-title"},Y={class:"room-code-section"},Z={class:"room-code-card"},ee={class:"teams-section"},se={class:"section-header"},ae={class:"section-actions"},te=["disabled"],oe={key:0,class:"unassigned-section"},ne={class:"participant-list"},le=["onClick"],re=["src","alt"],ie={key:1,class:"avatar-placeholder"},ce={class:"name"},de={class:"teams-grid"},ue={class:"team-header"},me={class:"team-count"},_e={class:"team-members"},ve=["src","alt"],pe={key:1,class:"avatar-placeholder small"},he={class:"name"},ye={key:0,class:"empty-team"},be={class:"lobby-footer"},fe={class:"footer-info"},ge={class:"player-count"},ke={key:0,class:"warning-text"},Ce=["disabled"],xe={class:"modal-content"},Te={class:"team-buttons"},Re=["onClick"],we=V({__name:"GameLobby",setup(Ae){const R=K(),A=j(),d=U(),h=c(()=>A.params.roomId),v=T(!1),p=T(null),y=T(!1),r=c(()=>d.currentRoom),C=c(()=>r.value?.teams||[]),b=c(()=>r.value?.participants||[]),u=c(()=>b.value.filter(l=>!l.team_id)),G=c(()=>(r.value?.room_code||"").split("").join(" ")),x=c(()=>{const l={};for(const t of C.value)l[t.id]=b.value.filter(s=>s.team_id===t.id);return l}),S=c(()=>!r.value||b.value.length<2?!1:u.value.length===0);async function B(){if(r.value?.id===h.value){d.subscribeToRoom(h.value);return}d.subscribeToRoom(h.value)}function M(l){p.value=l,v.value=!0}async function I(l){p.value&&(await d.assignToTeam(p.value.id,l),v.value=!1,p.value=null)}async function L(){y.value=!0,await d.randomAssignTeams(),y.value=!1}async function $(){await d.startGame()&&R.push({name:"arena-teacher-board",params:{roomId:h.value}})}async function D(){confirm("Á¢∫ÂÆöË¶ÅÂèñÊ∂àÊØîË≥ΩÂóéÔºüÊâÄÊúâÂ≠∏ÁîüÂ∞áË¢´ÁßªÂá∫ÊàøÈñì„ÄÇ")&&(await d.leaveRoom(),R.push({name:"arena"}))}function N(){r.value?.room_code&&(navigator.clipboard.writeText(r.value.room_code),alert("Â∑≤Ë§áË£ΩÊàøÈñìÁ¢ºÔºÅ"))}return z(()=>{B()}),E(()=>{}),(l,t)=>(a(),o("div",J,[e("header",Q,[e("button",{class:"back-btn",onClick:D}," ‚Üê ÂèñÊ∂àÊØîË≥Ω "),e("div",W,[t[2]||(t[2]=e("h1",null,"Ë™≤Â†ÇÈ¨•Ë±Ü ¬∑ Á≠âÂæÖÂÆ§",-1)),e("p",X,n(r.value?.text?.title),1)])]),e("section",Y,[e("div",Z,[t[3]||(t[3]=e("p",{class:"code-label"},"ÊàøÈñìÁ¢º",-1)),e("div",{class:"room-code",onClick:N},n(G.value),1),t[4]||(t[4]=e("p",{class:"code-hint"},"ÈªûÊìäË§áË£Ω ¬∑ Ë´ãÂ≠∏ÁîüËº∏ÂÖ•Ê≠§Á¢ºÂä†ÂÖ•",-1))])]),e("section",ee,[e("div",se,[t[5]||(t[5]=e("h2",null,"Èöä‰ºçÂàÜÁµÑ",-1)),e("div",ae,[e("button",{class:"btn-secondary",disabled:u.value.length===0||y.value,onClick:L},n(y.value?"ÂàÜÈÖç‰∏≠...":"üé≤ Èö®Ê©üÂàÜÁµÑ"),9,te)])]),u.value.length>0?(a(),o("div",oe,[e("h3",null,[t[6]||(t[6]=e("span",{class:"section-icon"},"üë§",-1)),O(" Êú™ÂàÜÁµÑ ("+n(u.value.length)+") ",1)]),e("div",ne,[(a(!0),o(g,null,k(u.value,s=>(a(),o("button",{key:s.id,class:"participant-card unassigned",onClick:i=>M(s)},[s.user?.avatar_url?(a(),o("img",{key:0,src:s.user.avatar_url,alt:s.user.display_name,class:"avatar"},null,8,re)):(a(),o("span",ie,n(s.user?.display_name?.charAt(0)||"?"),1)),e("span",ce,n(s.user?.display_name||"Êú™Áü•"),1)],8,le))),128))])])):f("",!0),e("div",de,[(a(!0),o(g,null,k(C.value,s=>(a(),o("div",{key:s.id,class:"team-card",style:w({"--team-primary":m(_)[s.team_color].primary,"--team-secondary":m(_)[s.team_color].secondary,"--team-text":m(_)[s.team_color].text})},[e("div",ue,[e("h3",null,n(s.team_name),1),e("span",me,n(x.value[s.id]?.length||0)+" ‰∫∫",1)]),e("div",_e,[(a(!0),o(g,null,k(x.value[s.id],i=>(a(),o("div",{key:i.id,class:"member-item"},[i.user?.avatar_url?(a(),o("img",{key:0,src:i.user.avatar_url,alt:i.user.display_name,class:"avatar small"},null,8,ve)):(a(),o("span",pe,n(i.user?.display_name?.charAt(0)||"?"),1)),e("span",he,n(i.user?.display_name||"Êú™Áü•"),1)]))),128)),x.value[s.id]?.length?f("",!0):(a(),o("div",ye," Êö´ÁÑ°ÊàêÂì° "))])],4))),128))])]),e("footer",be,[e("div",fe,[e("span",ge," üë• "+n(b.value.length)+" ‰ΩçÂ≠∏ÁîüÂ∑≤Âä†ÂÖ• ",1),u.value.length>0?(a(),o("span",ke," ÈÇÑÊúâ "+n(u.value.length)+" ‰∫∫Êú™ÂàÜÁµÑ ",1)):f("",!0)]),e("button",{class:"btn-primary btn-large",disabled:!S.value,onClick:$}," üöÄ ÈñãÂßãÊØîË≥Ω ",8,Ce)]),(a(),F(H,{to:"body"},[v.value?(a(),o("div",{key:0,class:"modal-overlay",onClick:t[1]||(t[1]=q(s=>v.value=!1,["self"]))},[e("div",xe,[e("h3",null,"Â∞á "+n(p.value?.user?.display_name)+" ÂàÜÈÖçÂà∞",1),e("div",Te,[(a(!0),o(g,null,k(C.value,s=>(a(),o("button",{key:s.id,class:"team-select-btn",style:w({background:m(_)[s.team_color].secondary,borderColor:m(_)[s.team_color].primary,color:m(_)[s.team_color].text}),onClick:i=>I(s.id)},n(s.team_name),13,Re))),128))]),e("button",{class:"btn-text",onClick:t[0]||(t[0]=s=>v.value=!1)}," ÂèñÊ∂à ")])])):f("",!0)]))]))}}),Me=P(we,[["__scopeId","data-v-8a083389"]]);export{Me as default};
