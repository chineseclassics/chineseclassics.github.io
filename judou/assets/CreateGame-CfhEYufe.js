import{d as F,u as R,r,c as T,f as U,a,g as e,h as c,i as h,l as j,s as I,F as m,j as p,e as N,p as q,v as z,t as o,P as O,b as g,o as l,_ as H}from"./index-CyM-KAP_.js";import{u as J}from"./gameStore-DAeJCMZk.js";import{T as K,a as M}from"./game-CVoexSXg.js";import{T as Q}from"./TextSelector-1RJNE9Z9.js";import"./userStatsStore-fHado8ha.js";const W={class:"create-game-page"},X={class:"steps-indicator"},Y={key:0},Z={key:1},ee={class:"step-content"},se={key:0,class:"step-panel"},te={key:0,class:"empty-state"},ae={key:1,class:"class-grid"},le=["onClick"],ne={class:"class-name"},oe={key:1,class:"step-panel"},ie={key:2,class:"step-panel"},re={class:"setting-group"},ue={class:"team-count-options"},de=["onClick"],ce={class:"teams-preview"},ve={class:"setting-group"},me={class:"time-options"},pe=["onClick"],_e={class:"time-label"},fe={class:"time-desc"},be={class:"confirm-card"},ke={class:"confirm-row"},ye={class:"confirm-value"},he={class:"confirm-row texts-row"},ge={class:"confirm-texts"},Ce={class:"text-order"},xe={class:"text-name"},Se={class:"confirm-row"},we={class:"confirm-value"},Te={class:"confirm-row"},Ie={class:"confirm-value"},Ne={key:0,class:"error-message"},Oe={class:"nav-buttons"},Me=["disabled"],Ee=["disabled"],C=3,Ge=F({__name:"CreateGame",setup(Pe){const x=j(),E=R(),S=J(),n=r(1),u=r(""),b=r([]),_=r(2),k=r(180),v=r([]),f=r(!1),i=r(""),w=r(null),G=T(()=>w.value?.selectedTexts||[]),P=T(()=>Array.from({length:_.value},(d,s)=>s+1));function V(d){b.value=d}async function $(){if(!O)return;const{data:d}=await O.from("classes").select("id, class_name").eq("teacher_id",E.user?.id).order("created_at",{ascending:!1});v.value=d||[],v.value.length>0&&!u.value&&(u.value=v.value[0].id)}function A(){if(n.value===1&&!u.value){i.value="è«‹é¸æ“‡ç­ç´š";return}if(n.value===2&&b.value.length===0){i.value="è«‹è‡³å°‘é¸æ“‡ä¸€ç¯‡æ–‡æœ¬";return}i.value="",n.value++}function B(){i.value="",n.value--}async function L(){if(!u.value||b.value.length===0){i.value="è«‹å®Œæˆæ‰€æœ‰è¨­ç½®";return}f.value=!0,i.value="";const d=await S.createRoom({hostType:"teacher",gameMode:"team_battle",textIds:b.value,timeLimit:k.value,teamCount:_.value,classId:u.value});d?x.push({name:"arena-teacher-lobby",params:{roomId:d.id}}):i.value=S.error||"å‰µå»ºå¤±æ•—",f.value=!1}return U(async()=>{await $()}),(d,s)=>{const D=z("router-link");return l(),a("div",W,[e("button",{class:"back-btn",onClick:s[0]||(s[0]=t=>h(x).push({name:"arena"}))}," â† è¿”å›žé¬¥è±† "),s[17]||(s[17]=e("header",{class:"page-header"},[e("h1",null,[e("span",{class:"title-icon"},"ðŸ“¢"),I(" å‰µå»ºèª²å ‚é¬¥è±† ")]),e("p",{class:"subtitle"},"è¨­ç½®æ¯”è³½åƒæ•¸ï¼Œè®“å­¸ç”Ÿåˆ†çµ„ç«¶æŠ€")],-1)),e("div",X,[(l(),a(m,null,p(C,t=>e("div",{key:t,class:g(["step-dot",{active:n.value===t,completed:n.value>t}])},[n.value>t?(l(),a("span",Y,"âœ“")):(l(),a("span",Z,o(t),1))],2)),64))]),e("div",ee,[n.value===1?(l(),a("div",se,[s[4]||(s[4]=e("h2",null,"é¸æ“‡ç­ç´š",-1)),s[5]||(s[5]=e("p",{class:"step-hint"},"é¸æ“‡è¦é€²è¡Œæ¯”è³½çš„ç­ç´š",-1)),v.value.length===0?(l(),a("div",te,[s[2]||(s[2]=e("p",null,"æ‚¨é‚„æ²’æœ‰å‰µå»ºç­ç´š",-1)),N(D,{to:"/my-classes",class:"btn-secondary"},{default:q(()=>[...s[1]||(s[1]=[I(" åŽ»å‰µå»ºç­ç´š â†’ ",-1)])]),_:1})])):(l(),a("div",ae,[(l(!0),a(m,null,p(v.value,t=>(l(),a("button",{key:t.id,class:g(["class-card",{selected:u.value===t.id}]),onClick:y=>u.value=t.id},[s[3]||(s[3]=e("span",{class:"class-icon"},"ðŸ«",-1)),e("span",ne,o(t.class_name),1)],10,le))),128))]))])):c("",!0),n.value===2?(l(),a("div",oe,[s[6]||(s[6]=e("h2",null,"é¸æ“‡æ¯”è³½æ–‡æœ¬",-1)),s[7]||(s[7]=e("p",{class:"step-hint"},"å¯é¸æ“‡å¤šç¯‡æ–‡ç« ï¼Œå­¸ç”Ÿå°‡æŒ‰é †åºåœ¨é™æ™‚å…§ç›¡é‡å®Œæˆ",-1)),N(Q,{ref_key:"textSelector",ref:w,"show-custom-texts":!0,"onUpdate:selectedIds":V},null,512)])):c("",!0),n.value===3?(l(),a("div",ie,[s[15]||(s[15]=e("h2",null,"æ¯”è³½è¨­ç½®",-1)),s[16]||(s[16]=e("p",{class:"step-hint"},"è¨­ç½®éšŠä¼æ•¸é‡å’Œæ™‚é–“é™åˆ¶",-1)),e("div",re,[s[8]||(s[8]=e("label",{class:"setting-label"},"éšŠä¼æ•¸é‡",-1)),e("div",ue,[(l(!0),a(m,null,p(h(K),t=>(l(),a("button",{key:t,class:g(["count-btn",{selected:_.value===t}]),onClick:y=>_.value=t},o(t)+" éšŠ ",11,de))),128))]),e("div",ce,[(l(!0),a(m,null,p(P.value,t=>(l(),a("div",{key:t,class:"team-preview"}," éšŠä¼ "+o(t),1))),128))])]),e("div",ve,[s[9]||(s[9]=e("label",{class:"setting-label"},"æ™‚é–“é™åˆ¶",-1)),e("div",me,[(l(!0),a(m,null,p(h(M),t=>(l(),a("button",{key:t.value,class:g(["time-btn",{selected:k.value===t.value}]),onClick:y=>k.value=t.value},[e("span",_e,o(t.label),1),e("span",fe,o(t.description),1)],10,pe))),128))])]),e("div",be,[s[14]||(s[14]=e("h3",null,"ç¢ºèªä¿¡æ¯",-1)),e("div",ke,[s[10]||(s[10]=e("span",{class:"confirm-label"},"ç­ç´š",-1)),e("span",ye,o(v.value.find(t=>t.id===u.value)?.class_name),1)]),e("div",he,[s[11]||(s[11]=e("span",{class:"confirm-label"},"æ–‡æœ¬",-1)),e("div",ge,[(l(!0),a(m,null,p(G.value,(t,y)=>(l(),a("div",{key:t.id,class:"confirm-text-item"},[e("span",Ce,o(y+1)+".",1),e("span",xe,o(t.title),1)]))),128))])]),e("div",Se,[s[12]||(s[12]=e("span",{class:"confirm-label"},"éšŠä¼",-1)),e("span",we,o(_.value)+" éšŠ",1)]),e("div",Te,[s[13]||(s[13]=e("span",{class:"confirm-label"},"æ™‚é–“",-1)),e("span",Ie,o(h(M).find(t=>t.value===k.value)?.description),1)])])])):c("",!0)]),i.value?(l(),a("p",Ne,o(i.value),1)):c("",!0),e("div",Oe,[n.value>1?(l(),a("button",{key:0,class:"btn-secondary",onClick:B,disabled:f.value}," ä¸Šä¸€æ­¥ ",8,Me)):c("",!0),n.value<C?(l(),a("button",{key:1,class:"btn-primary",onClick:A}," ä¸‹ä¸€æ­¥ ")):c("",!0),n.value===C?(l(),a("button",{key:2,class:"btn-primary",onClick:L,disabled:f.value},o(f.value?"å‰µå»ºä¸­...":"å‰µå»ºèª²å ‚é¬¥è±†"),9,Ee)):c("",!0)])])}}}),De=H(Ge,[["__scopeId","data-v-93a37f63"]]);export{De as default};
