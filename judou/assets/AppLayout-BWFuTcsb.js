import{d as j,u as te,c,r as h,w as L,o as ae,a as n,b as e,e as r,n as b,f as d,t as i,g as ne,F as w,h as C,i as oe,j as N,k as M,l as le,m as T,p as ie,q as t,_ as q,s as $}from"./index-BrunoeMr.js";import{u as re}from"./userStatsStore-DXh3wucG.js";import{u as ce}from"./assignmentStore-DdRF0qDc.js";const de={class:"sidebar-shell edamame-glass"},ue=["src","alt"],pe={key:1},ve={key:2,class:"level-badge"},me={class:"brand-info"},_e={class:"brand-title"},he={key:0,class:"brand-stats-wrapper"},be={class:"beans-value"},fe={class:"secondary-stats"},ge={key:0,class:"streak-display"},ye={key:1,class:"brand-subtitle"},ke={key:0,class:"arrow-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ae={key:0,class:"user-menu-dropdown"},Se={class:"sidebar-section"},we={key:0,class:"item-icon"},Ce={class:"item-title"},Ne={key:0,class:"badge"},Me={key:1,class:"edamame-sidebar-item disabled"},xe={key:0,class:"item-icon"},Be={class:"item-title"},Fe={key:1,class:"sidebar-section"},Ue={class:"item-title"},Pe={key:1,class:"edamame-sidebar-item disabled"},ze={class:"item-title"},Le={key:2,class:"sidebar-section super-admin-section"},$e={class:"item-title"},je={key:1,class:"edamame-sidebar-item disabled"},Te={class:"item-title"},qe=j({__name:"SidebarMenu",setup(D){const o=te(),v=re(),u=ce(),H=oe(),V=[{label:"é¦–é ",icon:"ðŸ ",to:{name:"home"}},{label:"å¥è±†",icon:"ðŸ«˜",to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:"ðŸ“–",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:"âš”ï¸",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:"ðŸ‘£",to:{name:"history"},description:"æ­·å²"},{label:"è±†èŽ¢",icon:"ðŸ«›",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:"âœï¸",to:{name:"my-texts"},teacherOnly:!0}],E=[{label:"ç·´ç¿’æ–‡åº«",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",to:{name:"admin-reading"}}],G=[{label:"ç”¨æˆ¶ç®¡ç†",to:{name:"admin-users"}}],I=c(()=>V.filter(l=>!l.teacherOnly||o.isTeacher)),x=c(()=>!o.isAuthenticated||!o.isAdmin?[]:E),B=c(()=>!o.isAuthenticated||!o.isSuperAdmin?[]:G),O=ie(),y=l=>l.to?O.name===l.to.name:!1,k=c(()=>o.isAuthenticated?o.displayName||"è±†å‹":"è¨ªå®¢"),R=c(()=>k.value.charAt(0)),W=c(()=>v.profile?.total_beans??0),J=c(()=>v.level),F=c(()=>v.profile?.streak_days??0),p=h(0),A=h(!1),f=h(null);let g=null;function K(l,a,_=800){const s=performance.now(),U=a-l;f.value=U>0?"up":"down",A.value=!0;function P(Z){const ee=Z-s,z=Math.min(ee/_,1),se=1-Math.pow(1-z,4);p.value=Math.round(l+U*se),z<1?g=requestAnimationFrame(P):(p.value=a,setTimeout(()=>{A.value=!1,f.value=null},500))}g&&cancelAnimationFrame(g),g=requestAnimationFrame(P)}L(W,(l,a)=>{if(a===void 0||p.value===0){p.value=l;return}l!==a&&K(p.value,l)},{immediate:!0});const S=h(!1);async function Q(){await o.loginWithGoogle()}function X(){o.isAuthenticated?H.push({name:"profile"}):S.value=!S.value}const m=h(0);L(()=>o.isAuthenticated,l=>{l?(console.log("[Sidebar] ç”¨æˆ¶å·²ç™»å…¥ï¼Œè¼‰å…¥ Profile"),v.fetchProfile(),o.isStudent&&u.fetchStudentAssignments().then(()=>{u.getPendingCount().then(a=>{m.value=a})})):m.value=0},{immediate:!0}),ae(()=>{o.isAuthenticated&&o.isStudent&&u.fetchStudentAssignments().then(()=>{u.getPendingCount().then(l=>{m.value=l})})});const Y="/judou/images/judou-logo.jpg";return(l,a)=>{const _=T("router-link");return t(),n("aside",de,[e("div",{class:"sidebar-brand",onClick:X},[e("div",{class:b(["brand-avatar",{"has-avatar":d(o).avatarUrl}])},[d(o).avatarUrl?(t(),n("img",{key:0,src:d(o).avatarUrl,alt:k.value},null,8,ue)):(t(),n("span",pe,i(R.value),1)),d(o).isAuthenticated?(t(),n("div",ve,i(J.value),1)):r("",!0)],2),e("div",me,[e("p",_e,i(k.value),1),d(o).isAuthenticated?(t(),n("div",he,[e("div",{class:b(["beans-card",{"beans-animating":A.value,"beans-up":f.value==="up","beans-down":f.value==="down"}])},[a[0]||(a[0]=e("div",{class:"beans-icon"},[e("span",{class:"bean-pod"},"ðŸ«›")],-1)),e("span",be,i(p.value.toLocaleString()),1)],2),e("div",fe,[F.value>0?(t(),n("span",ge,"ðŸ”¥ "+i(F.value)+"å¤©",1)):r("",!0)])])):(t(),n("p",ye,"é»žæ“Šç™»å…¥"))]),d(o).isAuthenticated?(t(),n("svg",ke,[...a[1]||(a[1]=[e("path",{d:"M9 18l6-6-6-6"},null,-1)])])):r("",!0)]),S.value&&!d(o).isAuthenticated?(t(),n("div",Ae,[e("button",{class:"login-btn",onClick:Q},[...a[2]||(a[2]=[ne('<svg class="google-icon" viewBox="0 0 24 24" width="16" height="16" data-v-79f15cd6><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-79f15cd6></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-79f15cd6></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-79f15cd6></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-79f15cd6></path></svg> ä½¿ç”¨ Google ç™»å…¥ ',2)])])])):r("",!0),e("nav",Se,[a[3]||(a[3]=e("p",{class:"section-label"},"å¸¸ç”¨åŠŸèƒ½",-1)),e("ul",null,[(t(!0),n(w,null,C(I.value,s=>(t(),n("li",{key:s.label},[s.to&&!s.disabled?(t(),N(_,{key:0,class:b(["edamame-sidebar-item",{active:y(s)}]),to:s.to},{default:M(()=>[s.icon?(t(),n("span",we,i(s.icon),1)):r("",!0),e("p",Ce,[le(i(s.label)+" ",1),s.label==="è±†èŽ¢"&&d(o).isStudent&&m.value>0?(t(),n("span",Ne,i(m.value),1)):r("",!0)])]),_:2},1032,["class","to"])):(t(),n("div",Me,[s.icon?(t(),n("span",xe,i(s.icon),1)):r("",!0),e("p",Be,i(s.label),1)]))]))),128))])]),x.value.length>0?(t(),n("nav",Fe,[a[4]||(a[4]=e("p",{class:"section-label"},"ç®¡ç†",-1)),e("ul",null,[(t(!0),n(w,null,C(x.value,s=>(t(),n("li",{key:s.label},[s.to&&!s.disabled?(t(),N(_,{key:0,class:b(["edamame-sidebar-item",{active:y(s)}]),to:s.to},{default:M(()=>[e("p",Ue,i(s.label),1)]),_:2},1032,["class","to"])):(t(),n("div",Pe,[e("p",ze,i(s.label),1)]))]))),128))])])):r("",!0),B.value.length>0?(t(),n("nav",Le,[a[5]||(a[5]=e("p",{class:"section-label"},"è¶…ç´šç®¡ç†",-1)),e("ul",null,[(t(!0),n(w,null,C(B.value,s=>(t(),n("li",{key:s.label},[s.to&&!s.disabled?(t(),N(_,{key:0,class:b(["edamame-sidebar-item super-admin-item",{active:y(s)}]),to:s.to},{default:M(()=>[e("p",$e,i(s.label),1)]),_:2},1032,["class","to"])):(t(),n("div",je,[e("p",Te,i(s.label),1)]))]))),128))])])):r("",!0),e("div",{class:"sidebar-footer"},[e("div",{class:"footer-brand"},[e("img",{src:Y,alt:"å¥è±†",class:"footer-logo"}),a[6]||(a[6]=e("span",{class:"footer-title"},"å¥è±† 2.0",-1))]),a[7]||(a[7]=e("div",{class:"footer-credits"},[e("p",null,"é–‹ç™¼ï¼šæ±ªæ¶µå±¹ã€å¼µè€å¸«"),e("p",null,"ç¾Žè¡“ï¼šä¸å¥•è¾°ã€å¾æšæ´‹")],-1))])])}}}),De=q(qe,[["__scopeId","data-v-79f15cd6"]]),He={class:"app-layout"},Ve={class:"app-main"},Ee={class:"app-content"},Ge=j({__name:"AppLayout",setup(D){return(o,v)=>{const u=T("router-view");return t(),n("div",He,[$(De),e("section",Ve,[e("div",Ee,[$(u)])])])}}}),We=q(Ge,[["__scopeId","data-v-a70dcd22"]]);export{We as default};
