import{d as O,r as u,c as h,a as l,b as s,e as d,f as c,i as P,m as N,t as a,F as b,g as f,v as V,n as S,s as o,_ as D}from"./index-CX_gJbtY.js";import{u as U,S as k,b as L,E as Y}from"./gameStore-BT8-uGez.js";import{u as z}from"./userStatsStore-D2HijxOz.js";import{T as G}from"./TextSelector-WgE-IPZ8.js";const j={class:"create-room-page"},q={class:"balance-card"},H={class:"balance-value"},J={class:"steps-indicator"},K={key:0},Q={key:1},W={class:"step-content"},X={key:0,class:"step-panel"},Z={key:1,class:"step-panel"},ss={class:"form-section"},es={class:"player-options"},ts=["onClick"],ls={class:"form-section"},os={class:"time-options"},as=["onClick"],ns={class:"option-label"},is={class:"option-desc"},rs={class:"form-section"},us={class:"fee-options"},ds=["disabled","onClick"],cs={key:0,class:"fee-info"},vs={class:"safety-notice"},ps={class:"notice-text"},_s={class:"confirm-card"},ms={class:"confirm-row texts-row"},bs={class:"confirm-texts"},fs={class:"text-order"},ks={class:"text-name"},ys={class:"confirm-row"},xs={class:"confirm-value"},Cs={class:"confirm-row"},Ss={class:"confirm-value"},hs={class:"confirm-row"},Ns={class:"confirm-value"},Is={key:0,class:"error-message"},gs={class:"nav-buttons"},Es=["disabled"],Ts=["disabled"],As=["disabled"],I=2,Ls=O({__name:"CreateRoom",setup(Ms){const g=P(),E=U(),M=z(),n=u(1),p=u([]),v=u(2),y=u(180),i=u(0),_=u(!1),r=u(""),T=u(null),x=h(()=>M.profile?.total_beans??0),A=h(()=>i.value===0?!0:x.value-i.value>=k.MIN_BALANCE),B=h(()=>T.value?.selectedTexts||[]);function w(m){p.value=m}function F(){if(n.value===1&&p.value.length===0){r.value="è«‹è‡³å°‘é¸æ“‡ä¸€ç¯‡æ–‡æœ¬";return}r.value="",n.value++}function $(){r.value="",n.value--}async function R(){if(p.value.length===0){r.value="è«‹é¸æ“‡æ–‡æœ¬";return}if(!A.value){r.value=`è±†å­ä¸è¶³ï¼Œè³¬æˆ¶éœ€ä¿ç•™è‡³å°‘ ${k.MIN_BALANCE} è±†`;return}_.value=!0,r.value="";const m=await E.createRoom({hostType:"student",gameMode:"pvp",textIds:p.value,timeLimit:y.value,maxPlayers:v.value,entryFee:i.value});m?g.push({name:"arena-lobby",params:{roomId:m.id}}):r.value=E.error||"å‰µå»ºå¤±æ•—",_.value=!1}return(m,e)=>(o(),l("div",j,[s("button",{class:"back-btn",onClick:e[0]||(e[0]=t=>c(g).push({name:"arena"}))}," â† è¿”å›žé¬¥è±† "),e[18]||(e[18]=s("header",{class:"page-header"},[s("h1",null,[s("span",{class:"title-icon"},"âž•"),N(" å‰µå»ºé¬¥è±†å ´ ")]),s("p",{class:"subtitle"},"é‚€è«‹åŒå­¸åŠ å…¥ï¼Œè´å–è±†å­ï¼")],-1)),s("div",q,[e[1]||(e[1]=s("span",{class:"balance-icon"},"ðŸ«˜",-1)),s("span",H,a(x.value),1),e[2]||(e[2]=s("span",{class:"balance-label"},"æˆ‘çš„è±†å­",-1))]),s("div",J,[(o(),l(b,null,f(I,t=>s("div",{key:t,class:S(["step-dot",{active:n.value===t,completed:n.value>t}])},[n.value>t?(o(),l("span",K,"âœ“")):(o(),l("span",Q,a(t),1))],2)),64))]),s("div",W,[n.value===1?(o(),l("div",X,[e[3]||(e[3]=s("h2",null,"é¸æ“‡æ¯”è³½æ–‡æœ¬",-1)),e[4]||(e[4]=s("p",{class:"step-hint"},"å¯é¸æ“‡å¤šç¯‡æ–‡ç« ï¼Œå°æˆ°æ™‚æŒ‰é †åºå®Œæˆ",-1)),V(G,{ref_key:"textSelector",ref:T,"show-custom-texts":!1,"onUpdate:selectedIds":w},null,512)])):d("",!0),n.value===2?(o(),l("div",Z,[e[16]||(e[16]=s("h2",null,"æ¯”è³½è¨­ç½®",-1)),e[17]||(e[17]=s("p",{class:"step-hint"},"è¨­ç½®å°æˆ°äººæ•¸ã€æ™‚é–“å’Œå…¥å ´è²»",-1)),s("div",ss,[e[5]||(e[5]=s("label",{class:"section-label"},"å°æˆ°äººæ•¸",-1)),s("div",es,[(o(),l(b,null,f([2,3,4],t=>s("button",{key:t,class:S(["option-btn",{selected:v.value===t}]),onClick:C=>v.value=t},a(t)+" äºº ",11,ts)),64))])]),s("div",ls,[e[6]||(e[6]=s("label",{class:"section-label"},"æ™‚é–“é™åˆ¶",-1)),s("div",os,[(o(!0),l(b,null,f(c(L),t=>(o(),l("button",{key:t.value,class:S(["option-btn time-btn",{selected:y.value===t.value}]),onClick:C=>y.value=t.value},[s("span",ns,a(t.label),1),s("span",is,a(t.description),1)],10,as))),128))])]),s("div",rs,[e[10]||(e[10]=s("label",{class:"section-label"},"å…¥å ´è²»",-1)),s("div",us,[(o(!0),l(b,null,f(c(Y),t=>(o(),l("button",{key:t,class:S(["fee-btn",{selected:i.value===t,disabled:t>0&&x.value-t<c(k).MIN_BALANCE}]),disabled:t>0&&x.value-t<c(k).MIN_BALANCE,onClick:C=>i.value=t},a(t===0?"å…è²»":`${t} è±†`),11,ds))),128))]),i.value>0?(o(),l("div",cs,[s("p",null,[e[7]||(e[7]=N(" å…¥å ´è²»ï¼š",-1)),s("strong",null,a(i.value)+" è±†",1),N(" Ã— "+a(v.value)+" äºº = çŽæ±  ",1),s("strong",null,a(i.value*v.value)+" è±†",1)]),e[8]||(e[8]=s("p",{class:"fee-note"},"ç²å‹è€…æ”¶è±†ï¼",-1))])):d("",!0),s("div",vs,[e[9]||(e[9]=s("span",{class:"notice-icon"},"ðŸ›¡ï¸",-1)),s("span",ps," è³¬æˆ¶ä¿ç•™ "+a(c(k).MIN_BALANCE)+" è±† ",1)])]),s("div",_s,[e[15]||(e[15]=s("h3",null,"ç¢ºèªä¿¡æ¯",-1)),s("div",ms,[e[11]||(e[11]=s("span",{class:"confirm-label"},"æ–‡æœ¬",-1)),s("div",bs,[(o(!0),l(b,null,f(B.value,(t,C)=>(o(),l("div",{key:t.id,class:"confirm-text-item"},[s("span",fs,a(C+1)+".",1),s("span",ks,a(t.title),1)]))),128))])]),s("div",ys,[e[12]||(e[12]=s("span",{class:"confirm-label"},"äººæ•¸",-1)),s("span",xs,a(v.value)+" äºº",1)]),s("div",Cs,[e[13]||(e[13]=s("span",{class:"confirm-label"},"æ™‚é–“",-1)),s("span",Ss,a(c(L).find(t=>t.value===y.value)?.description),1)]),s("div",hs,[e[14]||(e[14]=s("span",{class:"confirm-label"},"å…¥å ´è²»",-1)),s("span",Ns,a(i.value===0?"å…è²»":`${i.value} è±†`),1)])])])):d("",!0)]),r.value?(o(),l("p",Is,a(r.value),1)):d("",!0),s("div",gs,[n.value>1?(o(),l("button",{key:0,class:"btn-secondary",onClick:$,disabled:_.value}," ä¸Šä¸€æ­¥ ",8,Es)):d("",!0),n.value<I?(o(),l("button",{key:1,class:"btn-primary",onClick:F,disabled:p.value.length===0}," ä¸‹ä¸€æ­¥ ",8,Ts)):d("",!0),n.value===I?(o(),l("button",{key:2,class:"btn-primary",onClick:R,disabled:_.value||!A.value},a(_.value?"å‰µå»ºä¸­...":"å‰µå»ºé¬¥è±†å ´"),9,As)):d("",!0)])]))}}),Rs=D(Ls,[["__scopeId","data-v-5c52bc4e"]]);export{Rs as default};
