import{d as B,r as i,c as S,o as F,a as o,b as e,f as r,j as $,g as N,t as a,e as p,F as f,i as k,I as L,n as y,q as l,_ as R}from"./index-D0i31nFW.js";import{u as O,S as c,b as P,E as D}from"./gameStore-vrEVOaum.js";import{u as V}from"./userStatsStore-BdI2cOF1.js";const Y={class:"create-room-page"},q={class:"balance-card"},w={class:"balance-value"},j={class:"settings-form"},z={class:"form-section"},G={class:"text-grid"},U=["onClick"],H={key:0},J={key:0,class:"btn-text"},K={class:"form-section"},Q={class:"player-options"},W=["onClick"],X={class:"form-section"},Z={class:"time-options"},ee=["onClick"],se={class:"option-label"},te={class:"option-desc"},ae={class:"form-section"},oe={class:"fee-options"},le=["disabled","onClick"],ne={key:0,class:"fee-info"},ie={class:"safety-notice"},re={class:"notice-text"},ue={key:0,class:"error-message"},ce=["disabled"],de=B({__name:"CreateRoom",setup(ve){const h=$(),E=O(),M=V(),d=i(""),v=i(2),C=i(180),n=i(0),I=i([]),b=i(!1),u=i(""),m=S(()=>M.profile?.total_beans??0),A=S(()=>n.value===0?!0:m.value-n.value>=c.MIN_BALANCE);async function T(){if(!L)return;const{data:_}=await L.from("practice_texts").select("id, title, author, content").eq("is_public",!0).order("created_at",{ascending:!1}).limit(50);I.value=_||[]}async function x(){if(!d.value){u.value="è«‹é¸æ“‡æ–‡æœ¬";return}if(!A.value){u.value=`è±†å­ä¸è¶³ï¼Œè³¬æˆ¶éœ€ä¿ç•™è‡³å°‘ ${c.MIN_BALANCE} è±†`;return}b.value=!0,u.value="";const _=await E.createRoom({hostType:"student",gameMode:"pvp",textId:d.value,timeLimit:C.value,maxPlayers:v.value,entryFee:n.value});_?h.push({name:"arena-lobby",params:{roomId:_.id}}):u.value=E.error||"å‰µå»ºå¤±æ•—",b.value=!1}return F(()=>{T()}),(_,t)=>(l(),o("div",Y,[e("button",{class:"back-btn",onClick:t[0]||(t[0]=s=>r(h).push({name:"arena"}))}," â† è¿”å›é¬¥è±† "),t[10]||(t[10]=e("header",{class:"page-header"},[e("h1",null,[e("span",{class:"title-icon"},"â•"),N(" å‰µå»ºé¬¥è±†å ´ ")]),e("p",{class:"subtitle"},"é‚€è«‹åŒå­¸åŠ å…¥ï¼Œè´å–è±†å­ï¼")],-1)),e("div",q,[t[1]||(t[1]=e("span",{class:"balance-icon"},"ğŸ«˜",-1)),e("span",w,a(m.value),1),t[2]||(t[2]=e("span",{class:"balance-label"},"æˆ‘çš„è±†å­",-1))]),e("div",j,[e("div",z,[t[3]||(t[3]=e("label",{class:"section-label"},"é¸æ“‡æ¯”è³½æ–‡æœ¬",-1)),e("div",G,[(l(!0),o(f,null,k(I.value.slice(0,12),s=>(l(),o("button",{key:s.id,class:y(["text-card",{selected:d.value===s.id}]),onClick:g=>d.value=s.id},[e("h4",null,a(s.title),1),s.author?(l(),o("p",H,a(s.author),1)):p("",!0)],10,U))),128))]),I.value.length>12?(l(),o("button",J," æŸ¥çœ‹æ›´å¤š â†’ ")):p("",!0)]),e("div",K,[t[4]||(t[4]=e("label",{class:"section-label"},"å°æˆ°äººæ•¸",-1)),e("div",Q,[(l(),o(f,null,k([2,3,4],s=>e("button",{key:s,class:y(["option-btn",{selected:v.value===s}]),onClick:g=>v.value=s},a(s)+" äºº ",11,W)),64))])]),e("div",X,[t[5]||(t[5]=e("label",{class:"section-label"},"æ™‚é–“é™åˆ¶",-1)),e("div",Z,[(l(!0),o(f,null,k(r(P),s=>(l(),o("button",{key:s.value,class:y(["option-btn",{selected:C.value===s.value}]),onClick:g=>C.value=s.value},[e("span",se,a(s.label),1),e("span",te,a(s.description),1)],10,ee))),128))])]),e("div",ae,[t[9]||(t[9]=e("label",{class:"section-label"},"å…¥å ´è²»",-1)),e("div",oe,[(l(!0),o(f,null,k(r(D),s=>(l(),o("button",{key:s,class:y(["fee-btn",{selected:n.value===s,disabled:s>0&&m.value-s<r(c).MIN_BALANCE}]),disabled:s>0&&m.value-s<r(c).MIN_BALANCE,onClick:g=>n.value=s},a(s===0?"å…è²»":`${s} è±†`),11,le))),128))]),n.value>0?(l(),o("div",ne,[e("p",null,[t[6]||(t[6]=N(" å…¥å ´è²»ï¼š",-1)),e("strong",null,a(n.value)+" è±†",1),N(" Ã— "+a(v.value)+" äºº = çæ±  ",1),e("strong",null,a(n.value*v.value)+" è±†",1)]),t[7]||(t[7]=e("p",{class:"fee-note"},"ç²å‹è€…æ”¶è±†ï¼",-1))])):p("",!0),e("div",ie,[t[8]||(t[8]=e("span",{class:"notice-icon"},"ğŸ›¡ï¸",-1)),e("span",re," æ¯æ—¥å…¥å ´è²»ä¸Šé™ "+a(r(c).DAILY_FEE_LIMIT)+" è±† Â· è³¬æˆ¶ä¿ç•™ "+a(r(c).MIN_BALANCE)+" è±† ",1)])]),u.value?(l(),o("p",ue,a(u.value),1)):p("",!0),e("button",{class:"btn-primary btn-large",disabled:b.value||!d.value||!A.value,onClick:x},a(b.value?"å‰µå»ºä¸­...":"å‰µå»ºé¬¥è±†å ´"),9,ce)])]))}}),pe=R(de,[["__scopeId","data-v-fa51f546"]]);export{pe as default};
