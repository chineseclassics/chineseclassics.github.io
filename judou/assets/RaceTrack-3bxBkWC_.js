import{T as k}from"./TeamBadge-DoVgjdeR.js";import{d as A,c as v,a as c,g as s,h as d,k as B,F as _,j as f,n as x,b as M,m as S,t,o as n,_ as C}from"./index-pjl8OMS8.js";const F={class:"race-track-container"},V={class:"racer-rank-badge"},I={class:"racer-score-label"},w={class:"racer-tooltip"},N={class:"tooltip-name"},$={class:"tooltip-score"},j={key:0,class:"tooltip-members"},D={key:0,class:"rankings-info"},E={class:"ranking-number"},L={class:"ranking-name"},P={class:"ranking-score"},X=A({__name:"RaceTrack",props:{teams:{},maxScore:{default:void 0},height:{default:120},racerSize:{default:48},showRankings:{type:Boolean,default:!1}},setup(p){const r=p,i=v(()=>[...r.teams].sort((a,o)=>o.displayAvg-a.displayAvg)),h=v(()=>{if(r.maxScore!==void 0&&r.maxScore>0)return r.maxScore;const a=r.teams.map(e=>e.displayAvg);return Math.max(...a,1)}),b=v(()=>({height:typeof r.height=="number"?`${r.height}px`:r.height}));function T(a){let l;if(h.value<=0||i.value.length===0){const u=i.value.findIndex(m=>m.id===a.id);l=8+77/Math.max(1,i.value.length-1)*u}else{const u=a.displayAvg/h.value,R=8+Math.pow(u,.7)*77;l=Math.min(R,85);const y=i.value.filter(g=>Math.abs(g.displayAvg-a.displayAvg)<.01);if(y.length>1){const g=y.findIndex(z=>z.id===a.id);l+=g*.5}}return l=Math.max(8,Math.min(85,l)),{left:`${l}%`,top:"50%",transform:"translateX(-50%) translateY(-50%)"}}return(a,o)=>(n(),c("div",F,[s("div",{class:"race-track",style:x(b.value)},[o[0]||(o[0]=B('<div class="track-start" data-v-e85ceec0><span class="start-label" data-v-e85ceec0>起點</span></div><div class="track-finish" data-v-e85ceec0><span class="finish-label" data-v-e85ceec0>終點</span><div class="finish-line" data-v-e85ceec0></div></div>',2)),(n(!0),c(_,null,f(i.value,e=>(n(),c("div",{key:e.id,class:M(["team-racer",{"my-team":e.isMyTeam,"is-first":e.rank===1}]),style:x(T(e))},[e.productType?(n(),S(k,{key:0,"product-type":e.productType,size:p.racerSize,class:"racer-badge"},null,8,["product-type","size"])):d("",!0),s("div",V,t(e.rank),1),s("div",I,t(e.displayAvg.toFixed(1)),1),s("div",w,[s("div",N,t(e.name),1),s("div",$,"平均分: "+t(e.displayAvg.toFixed(2)),1),e.memberCount?(n(),c("div",j,t(e.completedCount)+"/"+t(e.memberCount)+" 完成 ",1)):d("",!0)])],6))),128))],4),p.showRankings?(n(),c("div",D,[(n(!0),c(_,null,f(i.value,e=>(n(),c("div",{key:e.id,class:M(["ranking-item",{"my-team":e.isMyTeam}])},[s("span",E,"#"+t(e.rank),1),e.productType?(n(),S(k,{key:0,"product-type":e.productType,size:24,class:"ranking-badge"},null,8,["product-type"])):d("",!0),s("span",L,t(e.name),1),s("span",P,t(e.displayAvg.toFixed(2)),1)],2))),128))])):d("",!0)]))}}),H=C(X,[["__scopeId","data-v-e85ceec0"]]);export{H as R};
