import{d as H,c as d,a,n as E,b as x,e as f,o as s,_ as $,u as ee,r as A,w as O,f as se,g as t,h as y,i as C,t as c,F as p,j as w,k as te,l as ae,m as v,p as D,q as T,s as b,v as G,x as ne}from"./index-uJe3jXWw.js";import{u as oe}from"./userStatsStore-DodV-lu6.js";import{u as ie}from"./assignmentStore-Bx9RQtx8.js";import{u as R}from"./avatarStore-Oox7WSgz.js";import{B as _}from"./BeanIcon-5m-asntM.js";import{H as le,S as ce,F as re,U as de,P as ue}from"./users-B-BcIH9x.js";import{B as pe}from"./book-open-B2_QHk7o.js";import{c as I}from"./createLucideIcon-DPZ8OCXv.js";import"./useSupabase-DDWGeXlc.js";const ve=["src","alt"],ye={key:1,class:"avatar-fallback"},me=H({__name:"UserAvatar",props:{size:{default:40},src:{default:void 0},alt:{default:"ç”¨æˆ¶é ­åƒ"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(m,{emit:o}){const l=m,u=o,h=R(),g=d(()=>l.src!==void 0?l.src:h.currentAvatarUrl),B=d(()=>{const r=typeof l.size=="number"?`${l.size}px`:l.size;return{width:r,height:r,minWidth:r,minHeight:r}}),M=d(()=>{const r=typeof l.size=="number"?l.size:parseInt(l.size);return Math.round(r*.5)});function U(){l.clickable&&u("click")}return(r,q)=>(s(),a("div",{class:x(["user-avatar",{clickable:m.clickable}]),style:E(B.value),onClick:U},[g.value?(s(),a("img",{key:0,src:g.value,alt:m.alt,class:"avatar-img"},null,8,ve)):(s(),a("div",ye,[f(_,{size:M.value},null,8,["size"])]))],6))}}),he=$(me,[["__scopeId","data-v-8f62ee97"]]);const ke=I("book-marked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const be=I("library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);const _e=I("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),fe={class:"sidebar-shell edamame-glass"},ge={class:"brand-avatar"},ze={class:"level-badge"},Se={class:"brand-info"},Ae={class:"beans-icon"},Ce={class:"beans-roller"},we={key:0,class:"secondary-stats"},Te={class:"streak-display"},xe={key:1,class:"login-section"},Be={class:"sidebar-section"},Me={key:0,class:"item-icon"},Ue={class:"item-title"},je={key:0,class:"badge"},Ne={key:1,class:"edamame-sidebar-item disabled"},He={key:0,class:"item-icon"},$e={class:"item-title"},Ie={key:2,class:"sidebar-section"},qe={key:0,class:"item-icon"},Le={class:"item-title"},Pe={key:1,class:"edamame-sidebar-item disabled"},Fe={key:0,class:"item-icon"},Oe={class:"item-title"},De=H({__name:"SidebarMenu",setup(m){const o=ee(),l=oe(),u=ie(),h=R(),g=ae(),B=[{label:"é¦–é ",icon:le,iconType:"lucide",to:{name:"home"}},{label:"å¥è±†",icon:_,iconType:"bean",to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:pe,iconType:"lucide",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:ce,iconType:"lucide",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:re,iconType:"lucide",to:{name:"history"},description:"æ­·å²"},{label:"è±†èŽ¢",icon:de,iconType:"lucide",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:ue,iconType:"lucide",to:{name:"my-texts"},teacherOnly:!0}],M=[{label:"ç·´ç¿’æ–‡åº«",icon:be,iconType:"lucide",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",icon:ke,iconType:"lucide",to:{name:"admin-reading"}},{label:"ç”¨æˆ¶ç®¡ç†",icon:_e,iconType:"lucide",to:{name:"admin-users"},superAdminOnly:!0}],U=d(()=>B.filter(i=>!i.teacherOnly||o.isTeacher)),r=d(()=>!o.isAuthenticated||!o.isAdmin?[]:M.filter(i=>i.superAdminOnly?o.isSuperAdmin:!0)),q=ne(),L=i=>i.to?q.name===i.to.name:!1,V=d(()=>o.isAuthenticated?o.displayName||"è±†å‹":"è¨ªå®¢"),W=d(()=>l.profile?.total_beans??0),Y=d(()=>l.level),P=d(()=>l.profile?.streak_days??0),j=A(0),N=A(!1),z=A(null),J=d(()=>j.value.toString().split("").map(n=>parseInt(n)));O(W,(i,n)=>{if(n===void 0||n===0){j.value=i;return}if(i===n)return;const S=i-n;z.value=S>0?"up":"down",N.value=!0,j.value=i,setTimeout(()=>{N.value=!1,z.value=null},800)},{immediate:!0});async function K(){await o.loginWithGoogle()}function Q(){g.push({name:"profile"})}const k=A(0);O(()=>o.isAuthenticated,i=>{i?(console.log("[Sidebar] ç”¨æˆ¶å·²ç™»å…¥ï¼Œè¼‰å…¥ Profile å’Œé ­åƒ"),l.fetchProfile(),h.initialize(),o.isStudent&&u.fetchStudentAssignments().then(()=>{u.getPendingCount().then(n=>{k.value=n})})):(k.value=0,h.reset())},{immediate:!0}),se(()=>{o.isAuthenticated&&o.isStudent&&u.fetchStudentAssignments().then(()=>{u.getPendingCount().then(i=>{k.value=i})})});const X="/judou/images/judou-logo.jpg";return(i,n)=>{const S=G("router-link");return s(),a("aside",fe,[C(o).isAuthenticated?(s(),a("div",{key:0,class:"sidebar-brand",onClick:Q},[t("div",ge,[f(he,{src:C(h).currentAvatarUrl||C(o).avatarUrl,size:52,alt:V.value},null,8,["src","alt"]),t("div",ze,c(Y.value),1)]),t("div",Se,[t("div",{class:x(["beans-card",{"beans-animating":N.value,"beans-up":z.value==="up","beans-down":z.value==="down"}])},[t("div",Ae,[f(_,{size:24})]),t("div",Ce,[(s(!0),a(p,null,w(J.value,(e,Z)=>(s(),a("div",{key:Z,class:"digit-slot"},[t("div",{class:"digit-roller",style:E({transform:`translateY(-${e*10}%)`})},[(s(),a(p,null,w(10,F=>t("span",{key:F,class:"digit"},c(F-1),1)),64))],4)]))),128))])],2),P.value>0?(s(),a("div",we,[t("span",Te,"ðŸ”¥ "+c(P.value)+"å¤©",1)])):y("",!0)]),n[0]||(n[0]=t("svg",{class:"arrow-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})],-1))])):(s(),a("div",xe,[t("button",{class:"google-login-btn",onClick:K},[...n[1]||(n[1]=[te('<svg class="google-icon" viewBox="0 0 24 24" width="18" height="18" data-v-7d5a0bbe><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-7d5a0bbe></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-7d5a0bbe></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-7d5a0bbe></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-7d5a0bbe></path></svg><span data-v-7d5a0bbe>ä½¿ç”¨ Google ç™»å…¥</span>',2)])]),n[2]||(n[2]=t("p",{class:"login-hint"},"ç™»å…¥å¾Œå¯ä¿å­˜å­¸ç¿’é€²åº¦",-1))])),t("nav",Be,[t("ul",null,[(s(!0),a(p,null,w(U.value,e=>(s(),a("li",{key:e.label},[e.to&&!e.disabled?(s(),v(S,{key:0,class:x(["edamame-sidebar-item",{active:L(e)}]),to:e.to},{default:D(()=>[e.icon?(s(),a("span",Me,[e.iconType==="bean"?(s(),v(_,{key:0,size:18})):e.iconType==="lucide"?(s(),v(T(e.icon),{key:1,size:18,"stroke-width":1.5,class:"lucide-icon"})):(s(),a(p,{key:2},[b(c(e.icon),1)],64))])):y("",!0),t("p",Ue,[b(c(e.label)+" ",1),e.label==="è±†èŽ¢"&&C(o).isStudent&&k.value>0?(s(),a("span",je,c(k.value),1)):y("",!0)])]),_:2},1032,["class","to"])):(s(),a("div",Ne,[e.icon?(s(),a("span",He,[e.iconType==="bean"?(s(),v(_,{key:0,size:18})):e.iconType==="lucide"?(s(),v(T(e.icon),{key:1,size:18,"stroke-width":1.5,class:"lucide-icon"})):(s(),a(p,{key:2},[b(c(e.icon),1)],64))])):y("",!0),t("p",$e,c(e.label),1)]))]))),128))])]),r.value.length>0?(s(),a("nav",Ie,[n[3]||(n[3]=t("p",{class:"section-label"},"ç®¡ç†",-1)),t("ul",null,[(s(!0),a(p,null,w(r.value,e=>(s(),a("li",{key:e.label},[e.to&&!e.disabled?(s(),v(S,{key:0,class:x(["edamame-sidebar-item",{active:L(e),"super-admin-item":e.superAdminOnly}]),to:e.to},{default:D(()=>[e.icon?(s(),a("span",qe,[e.iconType==="lucide"?(s(),v(T(e.icon),{key:0,size:16,"stroke-width":1.5,class:"lucide-icon"})):(s(),a(p,{key:1},[b(c(e.icon),1)],64))])):y("",!0),t("p",Le,c(e.label),1)]),_:2},1032,["class","to"])):(s(),a("div",Pe,[e.icon?(s(),a("span",Fe,[e.iconType==="lucide"?(s(),v(T(e.icon),{key:0,size:16,"stroke-width":1.5,class:"lucide-icon"})):(s(),a(p,{key:1},[b(c(e.icon),1)],64))])):y("",!0),t("p",Oe,c(e.label),1)]))]))),128))])])):y("",!0),t("div",{class:"sidebar-footer"},[t("div",{class:"footer-brand"},[t("img",{src:X,alt:"å¥è±†",class:"footer-logo"}),n[4]||(n[4]=t("span",{class:"footer-title"},"å¥è±† 2.0",-1))]),n[5]||(n[5]=t("div",{class:"footer-credits"},[t("p",null,"é–‹ç™¼ï¼šæ±ªæ¶µå±¹ã€å¼µè€å¸«"),t("p",null,"ç¾Žè¡“ï¼šä¸å¥•è¾°ã€å¾æšæ´‹")],-1))])])}}}),Ee=$(De,[["__scopeId","data-v-7d5a0bbe"]]),Ge={class:"app-layout"},Re={class:"app-main"},Ve={class:"app-content"},We=H({__name:"AppLayout",setup(m){return(o,l)=>{const u=G("router-view");return s(),a("div",Ge,[f(Ee),t("section",Re,[t("div",Ve,[f(u)])])])}}}),as=$(We,[["__scopeId","data-v-a70dcd22"]]);export{as as default};
