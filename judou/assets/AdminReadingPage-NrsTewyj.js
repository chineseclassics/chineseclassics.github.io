import{d as Me,u as Ee,r as f,K as z,c as S,f as Le,a as s,h as m,m as H,F as k,g as t,i as J,s as V,j as A,H as _,I as C,L,t as o,e as W,p as q,T as Q,M as X,b as ue,G as D,J as ce,o as l,_ as Oe}from"./index-B_C-lTFC.js";import{u as Pe}from"./readingStore-CUjFb4-T.js";import{u as Be}from"./practiceLibraryStore-ChNTxT0v.js";import{u as Ne}from"./useSupabase-BRrhj7CO.js";const Ke={class:"admin-reading-page"},Ge={class:"admin-header"},je={class:"header-actions"},ze=["disabled"],He=["disabled"],Je={class:"admin-layout"},We={class:"category-sidebar edamame-glass"},qe={class:"sidebar-header"},Qe={key:0,class:"sidebar-loading"},Xe={key:1,class:"sidebar-empty"},Ye={key:2,class:"category-tree"},Ze={key:0,class:"tree-item editing"},et=["onClick"],tt={class:"tree-label"},nt={class:"tree-count"},at={class:"tree-actions"},lt=["onClick"],st=["onClick"],ot={key:3,class:"add-category-inline"},it={class:"add-category-actions"},dt={class:"content-panel edamame-glass"},rt={key:0,class:"content-empty"},ut={class:"category-info"},ct={class:"category-meta"},vt={class:"text-list-section"},mt={key:0,class:"text-empty"},pt={key:1},gt=["onClick"],ft={class:"text-title"},yt={class:"text-preview"},bt=["onClick"],_t=["onClick"],kt=["onClick"],xt=["onClick"],ht=["onClick"],Ct={class:"text-meta edamame-glass"},wt={class:"detail-title"},$t={class:"meta-row"},Tt={key:0,class:"meta-item"},It={key:1,class:"meta-item"},At={class:"meta-item"},St={key:2,class:"meta-item"},Vt={class:"category-tags inline"},Dt={key:0,class:"selection-toolbar"},Rt={class:"selected-text"},Ft={class:"ai-actions-section edamame-glass"},Ut=["disabled"],Mt={key:1,class:"annotations-section edamame-glass"},Et={class:"section-title"},Lt={class:"annotation-list"},Ot={class:"annotation-term"},Pt={class:"annotation-content"},Bt=["onClick"],Nt={class:"modal-card edamame-glass large-modal"},Kt={class:"modal-body"},Gt={class:"form-row"},jt={class:"flex-2"},zt={class:"form-row"},Ht={class:"category-picker"},Jt=["onClick"],Wt={key:0,class:"tag-check"},qt={key:0,class:"new-category-inline"},Qt={key:0,class:"feedback"},Xt=["disabled"],Yt={class:"modal-card edamame-glass"},Zt={class:"modal-body"},en={class:"selected-preview"},tn={class:"preview-content"},nn={class:"preview-info"},an={class:"form-row"},ln=["value"],sn={class:"extract-note"},on={key:0,class:"feedback"},dn=["disabled"],rn={class:"modal-card edamame-glass",style:{"max-width":"800px","max-height":"80vh","overflow-y":"auto"}},un={class:"modal-body"},cn={class:"generated-annotations-list"},vn={class:"annotation-header"},mn={class:"annotation-term"},pn={key:0,class:"annotation-pinyin"},gn={class:"annotation-position"},fn={class:"annotation-content"},yn={key:0,class:"feedback"},bn=["disabled"],_n={class:"modal-card edamame-glass"},kn={class:"modal-body"},xn={class:"selected-preview"},hn={class:"preview-content annotation-term-preview"},Cn={key:0,class:"feedback"},wn=["disabled"],$n=Me({__name:"AdminReadingPage",setup(Tn){const r=Pe(),ae=Be(),ve=Ee(),P=f("list"),d=f(null),x=f(null),w=f(!1),R=f(!1),F=f(!1),p=f(!1),c=f(null),$=f(null),i=z({title:"",author:"",source:"",summary:"",content:"",reading_category_ids:[]}),h=f(!1),b=f(""),O=f(null),U=f(""),v=z({selectedText:"",startIndex:0,endIndex:0,title:"",category_id:null,difficulty:2}),g=z({selectedText:"",startIndex:0,endIndex:0,annotation:"",pinyin:""}),B=f(!1),T=f([]),M=f(!1),E=S(()=>r.readingCategories),me=S(()=>ae.state.categories.filter(a=>a.level===1).sort((a,e)=>a.order_index-e.order_index)),Y=S(()=>x.value&&r.readingCategories.find(a=>a.id===x.value)||null),Z=S(()=>x.value?r.readingTexts.filter(a=>a.reading_categories?.some(e=>e.id===x.value)):[]);function le(a){return r.readingTexts.filter(e=>e.reading_categories?.some(n=>n.id===a)).length}function pe(a){x.value=a}function ge(a){O.value=a.id,U.value=a.name}function N(){O.value=null,U.value=""}async function se(){if(!O.value||!U.value.trim()){N();return}try{await r.updateReadingCategory(O.value,{name:U.value.trim()}),N()}catch(a){alert(a?.message||"æ›´æ–°æ–‡é›†å¤±æ•—")}}async function fe(a){const e=le(a.id);if(e>0){alert(`ç„¡æ³•åˆªé™¤ã€Œ${a.name}ã€ï¼šæ­¤æ–‡é›†ä¸‹é‚„æœ‰ ${e} ç¯‡æ–‡ç« ã€‚è«‹å…ˆç§»é™¤æ–‡ç« å¾Œå†åˆªé™¤æ–‡é›†ã€‚`);return}if(confirm(`ç¢ºå®šè¦åˆªé™¤æ–‡é›†ã€Œ${a.name}ã€å—ï¼Ÿ`))try{await r.deleteReadingCategory(a.id),x.value===a.id&&(x.value=null)}catch(n){alert(n?.message||"åˆªé™¤æ–‡é›†å¤±æ•—")}}const ye=S(()=>{const a=r.currentText||d.value;return a?a.content.replace(/\|/g,""):""}),be=S(()=>{const a=r.currentText||d.value;if(!a)return[];const e=a.content.includes("||")?"||":/\n\n+/;return a.content.split(e).map(n=>n.replace(/\|/g,""))}),ee=S(()=>r.currentText?.annotations||[]);async function K(a){d.value=a,P.value="detail",await r.fetchTextDetail(a.id)}function oe(){P.value="list",d.value=null,r.clearCurrentText()}function ie(){$.value=null,i.title="",i.author="",i.source="",i.summary="",i.content="",i.reading_category_ids=[],c.value=null,w.value=!0}function _e(){const a=r.currentText||d.value;a&&de(a)}function de(a){$.value=a,i.title=a.title,i.author=a.author||"",i.source=a.source||"",i.summary=a.summary||"";let e=a.content;e.includes("||")&&(e=e.replace(/\|\|/g,`

`)),i.content=e,i.reading_category_ids=a.reading_categories?.map(n=>n.id)||[],c.value=null,w.value=!0}async function ke(a){if(confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${a.title}ã€å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚`))try{await r.deleteReadingText(a.id),d.value?.id===a.id&&oe()}catch(e){alert(e?.message||"åˆªé™¤å¤±æ•—")}}async function xe(){if(!i.title.trim()||!i.content.trim()){c.value="æ¨™é¡Œå’Œå…§å®¹ç‚ºå¿…å¡«";return}if(!i.reading_category_ids||i.reading_category_ids.length===0){c.value="è«‹è‡³å°‘é¸æ“‡ä¸€å€‹æ–‡é›†";return}try{p.value=!0;const a=Re(i.content);if(!a){c.value="å…§å®¹è™•ç†å¾Œç‚ºç©ºï¼Œè«‹æª¢æŸ¥è¼¸å…¥";return}if($.value){if(await r.updateReadingText($.value.id,{title:i.title.trim(),author:i.author.trim()||null,source:i.source.trim()||null,summary:i.summary.trim()||null,category_id:null,content:a,reading_category_ids:i.reading_category_ids}),$.value&&d.value?.id===$.value.id){const e=r.readingTexts.find(n=>n.id===$.value.id);e&&(d.value=e)}w.value=!1}else await r.createReadingText({title:i.title.trim(),author:i.author.trim()||null,source:i.source.trim()||null,summary:i.summary.trim()||null,content:a,category_id:null,reading_category_ids:i.reading_category_ids},ve.isAdmin),w.value=!1}catch(a){c.value=a?.message||"å„²å­˜å¤±æ•—"}finally{p.value=!1}}function he(){const a=window.getSelection();if(!a||a.isCollapsed)return;const e=a.toString().trim();if(!e||e.length===0)return;const u=ye.value.indexOf(e);u>=0&&Ce(e,u,u+e.length)}const y=z({show:!1,text:"",startIndex:0,endIndex:0});function Ce(a,e,n){y.text=a,y.startIndex=e,y.endIndex=n,y.show=!0}function te(){y.show=!1}function we(){d.value&&(v.selectedText=y.text,v.startIndex=y.startIndex,v.endIndex=y.endIndex,v.title=`${d.value.title}ï¼ˆç¯€é¸ï¼‰`,v.category_id=d.value.category_id||null,v.difficulty=2,c.value=null,te(),R.value=!0)}function $e(){g.selectedText=y.text,g.startIndex=y.startIndex,g.endIndex=y.endIndex,g.annotation="",c.value=null,te(),F.value=!0}async function Te(){if(!d.value||!v.selectedText){c.value="è«‹é¸å–è¦æå–çš„æ–‡å­—";return}if(!v.title.trim()){c.value="è«‹è¼¸å…¥æ¨™é¡Œ";return}try{p.value=!0;const a=d.value.content;let e="",n=0;for(let u=0;u<a.length;u++){const j=a[u];j==="|"?n>v.startIndex&&n<=v.endIndex&&(e+=j):(n>=v.startIndex&&n<v.endIndex&&(e+=j),n++)}await r.extractPracticeFragment(d.value.id,v.startIndex,v.endIndex,e,{title:v.title.trim(),category_id:v.category_id,difficulty:v.difficulty}),R.value=!1,alert("ç·´ç¿’ç´ ææå–æˆåŠŸï¼")}catch(a){c.value=a?.message||"æå–å¤±æ•—"}finally{p.value=!1}}async function Ie(){if(!d.value||!g.selectedText){c.value="è«‹é¸å–è¦è¨»é‡‹çš„æ–‡å­—";return}if(!g.annotation.trim()){c.value="è«‹è¼¸å…¥è¨»é‡‹å…§å®¹";return}try{p.value=!0,await r.addAnnotation({text_id:d.value.id,start_index:g.startIndex,end_index:g.endIndex,term:g.selectedText,annotation:g.annotation.trim(),pinyin:g.pinyin.trim()||null}),F.value=!1,alert("è¨»é‡‹æ·»åŠ æˆåŠŸï¼"),await r.fetchTextDetail(d.value.id)}catch(a){c.value=a?.message||"æ·»åŠ è¨»é‡‹å¤±æ•—"}finally{p.value=!1}}async function Ae(){if(!d.value){c.value="è«‹å…ˆé¸æ“‡ä¸€ç¯‡æ–‡ç« ";return}try{B.value=!0,c.value=null;const a=d.value.content.replace(/\|/g,""),e=Ne(),{data:n,error:u}=await e.functions.invoke("generate-annotations",{body:{content:a,title:d.value.title,author:d.value.author}});if(u)throw u;if(n.success&&n.data)T.value=n.data,M.value=!0,c.value=`æˆåŠŸç”Ÿæˆ ${n.count||0} å€‹è¨»é‡‹ï¼Œè«‹é è¦½ä¸¦ç¢ºèª`;else throw new Error(n.error||"ç”Ÿæˆè¨»é‡‹å¤±æ•—")}catch(a){console.error("ç”Ÿæˆè¨»é‡‹å¤±æ•—:",a),c.value=a?.message||"ç”Ÿæˆè¨»é‡‹æ™‚ç™¼ç”ŸéŒ¯èª¤"}finally{B.value=!1}}async function Se(){if(!(!d.value||T.value.length===0))try{p.value=!0,c.value=null;let a=0,e=0;for(const n of T.value)try{await r.addAnnotation({text_id:d.value.id,start_index:n.start_index,end_index:n.end_index,term:n.term,annotation:n.annotation,pinyin:n.pinyin||null}),a++}catch(u){console.error("ä¿å­˜è¨»é‡‹å¤±æ•—:",n.term,u),e++}await r.fetchTextDetail(d.value.id),M.value=!1,T.value=[],e>0?alert(`å·²ä¿å­˜ ${a} å€‹è¨»é‡‹ï¼Œ${e} å€‹å¤±æ•—`):alert(`æˆåŠŸä¿å­˜ ${a} å€‹è¨»é‡‹ï¼`)}catch(a){c.value=a?.message||"ä¿å­˜è¨»é‡‹å¤±æ•—"}finally{p.value=!1}}async function Ve(a){if(confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${a.term}ã€çš„è¨»é‡‹å—ï¼Ÿ`))try{await r.deleteAnnotation(a.id),d.value&&await r.fetchTextDetail(d.value.id)}catch(e){alert(e?.message||"åˆªé™¤å¤±æ•—")}}function De(a){return a.content.replace(/\|/g,"").slice(0,40)+"..."}function Re(a){const e=/[ã€‚ï¼Œã€ï¼›ï¼šï¼ï¼Ÿ,.;:!?]/g,n=/[ã€Œã€ã€ã€""''ï¼ˆï¼‰()ã€ã€‘\[\]ã€Šã€‹<>Â·â€”â€¦ï½\-]/g;return a.split(/\n+/).map(ne=>{let I=ne.trim();return I?(I=I.replace(n,""),I=I.replace(e,"|"),I=I.replace(/\|+/g,"|").replace(/^\|/,"").replace(/\|$/,""),I):""}).filter(ne=>ne.length>0).join(`

`)}function Fe(a){return a?new Date(a).toLocaleDateString():"--"}function re(a){return a.content.replace(/\|/g,"").length}function Ue(a){const e=i.reading_category_ids.indexOf(a);e>-1?i.reading_category_ids.splice(e,1):i.reading_category_ids.push(a)}async function G(){if(b.value.trim())try{const a=await r.createReadingCategory(b.value.trim());a&&i.reading_category_ids.push(a.id),b.value="",h.value=!1}catch(a){alert(a?.message||"æ–°å¢åˆ†é¡å¤±æ•—")}}return Le(async()=>{await Promise.all([r.fetchReadingCategories(),r.fetchReadingTexts(),ae.fetchLibrary()]),E.value.length>0&&!x.value&&E.value[0]&&(x.value=E.value[0].id)}),(a,e)=>(l(),s("div",Ke,[P.value==="list"?(l(),s(k,{key:0},[t("header",Ge,[e[33]||(e[33]=t("div",null,[t("p",{class:"edamame-text-level-detail"},"ç®¡ç†é–±è®€æ–‡ç« å’Œæå–ç·´ç¿’ç‰‡æ®µ"),t("h1",{class:"edamame-heading-gradient"},"é–±è®€æ–‡åº«")],-1)),t("div",je,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[0]||(e[0]=n=>{J(r).fetchReadingTexts(),J(r).fetchReadingCategories()}),disabled:J(r).isLoading}," é‡æ–°æ•´ç† ",8,ze),t("button",{class:"edamame-btn edamame-btn-primary",onClick:ie,disabled:!Y.value}," æ–°å¢é–±è®€æ–‡ç«  ",8,He)])]),t("div",Je,[t("aside",We,[t("div",qe,[e[35]||(e[35]=t("span",{class:"sidebar-title"},"æ–‡é›†å°èˆª",-1)),t("button",{class:"icon-btn",onClick:e[1]||(e[1]=n=>{h.value=!0,b.value=""}),title:"æ–°å¢æ–‡é›†"},[...e[34]||(e[34]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 5v14M5 12h14"})],-1)])])]),J(r).isLoading?(l(),s("div",Qe,"è¼‰å…¥ä¸­â‹¯")):E.value.length?(l(),s("nav",Ye,[(l(!0),s(k,null,A(E.value,n=>(l(),s("div",{key:n.id,class:"tree-node"},[O.value===n.id?(l(),s("div",Ze,[_(t("input",{"onUpdate:modelValue":e[3]||(e[3]=u=>U.value=u),type:"text",class:"edit-input",onKeyup:[L(se,["enter"]),L(N,["escape"])],ref_for:!0,ref:"editInput"},null,544),[[C,U.value]]),t("div",{class:"edit-actions"},[t("button",{class:"action-btn",onClick:se,title:"ç¢ºèª"},"âœ“"),t("button",{class:"action-btn",onClick:N,title:"å–æ¶ˆ"},"Ã—")])])):(l(),s("div",{key:1,class:ue(["tree-item",{selected:x.value===n.id}]),onClick:u=>pe(n.id)},[t("span",tt,o(n.name),1),t("span",nt,o(le(n.id)),1),t("div",at,[t("button",{class:"action-btn",onClick:D(u=>ge(n),["stop"]),title:"ç·¨è¼¯"},"âœ",8,lt),t("button",{class:"action-btn danger",onClick:D(u=>fe(n),["stop"]),title:"åˆªé™¤"},"Ã—",8,st)])],10,et))]))),128))])):(l(),s("div",Xe,[e[36]||(e[36]=V(" å°šç„¡æ–‡é›† ",-1)),t("button",{class:"link-btn",onClick:e[2]||(e[2]=n=>{h.value=!0,b.value=""})},"å»ºç«‹ç¬¬ä¸€å€‹æ–‡é›†")])),h.value?(l(),s("div",ot,[_(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>b.value=n),type:"text",placeholder:"è¼¸å…¥æ–‡é›†åç¨±...",class:"category-input",onKeyup:[L(G,["enter"]),e[5]||(e[5]=L(n=>h.value=!1,["escape"]))]},null,544),[[C,b.value]]),t("div",it,[t("button",{class:"action-btn",onClick:G,title:"ç¢ºèª"},"âœ“"),t("button",{class:"action-btn",onClick:e[6]||(e[6]=n=>h.value=!1),title:"å–æ¶ˆ"},"Ã—")])])):m("",!0)]),t("main",dt,[Y.value?(l(),s(k,{key:1},[t("div",ut,[t("h2",null,o(Y.value.name),1),t("p",ct,o(Z.value.length)+" ç¯‡æ–‡ç« ",1)]),t("div",vt,[Z.value.length?(l(),s("table",pt,[e[39]||(e[39]=t("thead",null,[t("tr",null,[t("th",{style:{width:"auto","min-width":"200px"}},"æ¨™é¡Œ"),t("th",{style:{width:"80px"}},"ä½œè€…"),t("th",{style:{width:"70px"}},"å­—æ•¸"),t("th",{style:{width:"100px"}},"å»ºç«‹æ—¥æœŸ"),t("th",{style:{width:"120px"}},"æ“ä½œ")])],-1)),t("tbody",null,[(l(!0),s(k,null,A(Z.value,n=>(l(),s("tr",{key:n.id,class:"text-row"},[t("td",{onClick:u=>K(n)},[t("p",ft,o(n.title),1),t("p",yt,o(De(n)),1)],8,gt),t("td",{onClick:u=>K(n)},o(n.author||"ä½šå"),9,bt),t("td",{onClick:u=>K(n)},o(re(n)),9,_t),t("td",{onClick:u=>K(n)},o(Fe(n.created_at)),9,kt),t("td",{class:"actions",onClick:e[7]||(e[7]=D(()=>{},["stop"]))},[t("button",{class:"ghost-btn",onClick:u=>de(n)},"ç·¨è¼¯",8,xt),t("button",{class:"ghost-btn danger",onClick:u=>ke(n)},"åˆªé™¤",8,ht)])]))),128))])])):(l(),s("div",mt,[e[38]||(e[38]=t("p",null,"æ­¤æ–‡é›†å°šç„¡æ–‡ç« ",-1)),t("button",{class:"edamame-btn edamame-btn-primary",onClick:ie},"æ–°å¢ç¬¬ä¸€ç¯‡æ–‡ç« ")]))])],64)):(l(),s("div",rt,[...e[37]||(e[37]=[t("p",null,"è«‹å¾å·¦å´é¸æ“‡ä¸€å€‹æ–‡é›†",-1)])]))])])],64)):P.value==="detail"&&d.value?(l(),s(k,{key:1},[t("header",{class:"detail-header"},[t("button",{class:"back-btn",onClick:oe},[...e[40]||(e[40]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),V(" è¿”å›åˆ—è¡¨ ",-1)])]),t("div",{class:"detail-actions"},[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:_e}," ç·¨è¼¯æ–‡ç«  ")])]),t("div",Ct,[t("h1",wt,o(d.value.title),1),t("div",$t,[d.value.author?(l(),s("span",Tt,[e[41]||(e[41]=t("strong",null,"ä½œè€…ï¼š",-1)),V(o(d.value.author),1)])):m("",!0),d.value.source?(l(),s("span",It,[e[42]||(e[42]=t("strong",null,"ä¾†æºï¼š",-1)),V(o(d.value.source),1)])):m("",!0),t("span",At,[e[43]||(e[43]=t("strong",null,"å­—æ•¸ï¼š",-1)),V(o(re(d.value)),1)]),d.value.reading_categories?.length?(l(),s("span",St,[e[44]||(e[44]=t("strong",null,"æ–‡é›†ï¼š",-1)),t("span",Vt,[(l(!0),s(k,null,A(d.value.reading_categories,n=>(l(),s("span",{key:n.id,class:"category-tag"},o(n.name),1))),128))])])):m("",!0)])]),e[46]||(e[46]=t("div",{class:"action-hint"}," ğŸ’¡ é¸å–æ–‡å­—å¾Œå¯ä»¥ã€Œæå–ç‚ºç·´ç¿’ã€æˆ–ã€Œæ·»åŠ è¨»é‡‹ã€ ",-1)),y.show?(l(),s("div",Dt,[t("span",Rt,"ã€Œ"+o(y.text.slice(0,20))+o(y.text.length>20?"...":"")+"ã€",1),t("button",{class:"toolbar-btn extract",onClick:we}," ğŸ“¤ æå–ç‚ºç·´ç¿’ "),t("button",{class:"toolbar-btn annotate",onClick:$e}," ğŸ“ æ·»åŠ è¨»é‡‹ "),t("button",{class:"toolbar-btn cancel",onClick:te}," âœ• ")])):m("",!0),t("div",{class:"text-content edamame-glass",onMouseup:he},[(l(!0),s(k,null,A(be.value,(n,u)=>(l(),s("div",{key:u,class:"paragraph"},o(n),1))),128))],32),t("div",Ft,[t("button",{class:"edamame-btn edamame-btn-primary",onClick:Ae,disabled:B.value||!d.value},o(B.value?"ğŸ¤– AI ç”Ÿæˆä¸­...":"ğŸ¤– AI ç”Ÿæˆè¨»é‡‹"),9,Ut),e[45]||(e[45]=t("p",{class:"action-hint"},"é»æ“ŠæŒ‰éˆ•ï¼ŒAI æœƒè‡ªå‹•è­˜åˆ¥éœ€è¦è¨»é‡‹çš„å­—è©ä¸¦ç”Ÿæˆè¨»é‡‹ï¼ˆå«æ‹¼éŸ³ï¼‰",-1))]),ee.value.length>0?(l(),s("div",Mt,[t("h3",Et,"ğŸ“ å·²æ·»åŠ çš„è¨»é‡‹ ("+o(ee.value.length)+")",1),t("div",Lt,[(l(!0),s(k,null,A(ee.value,n=>(l(),s("div",{key:n.id,class:"annotation-item"},[t("div",Ot,o(n.term),1),t("div",Pt,o(n.annotation),1),t("button",{class:"delete-btn",onClick:u=>Ve(n),title:"åˆªé™¤"}," âœ• ",8,Bt)]))),128))])])):m("",!0)],64)):m("",!0),(l(),H(X,{to:"body"},[W(Q,{name:"fade"},{default:q(()=>[w.value?(l(),s("div",{key:0,class:"modal-backdrop",onClick:e[18]||(e[18]=D(n=>w.value=!1,["self"]))},[t("div",Nt,[t("header",null,[t("h3",null,o($.value?"ç·¨è¼¯é–±è®€æ–‡ç« ":"æ–°å¢é–±è®€æ–‡ç« "),1),t("button",{class:"close-btn",onClick:e[8]||(e[8]=n=>w.value=!1)},"Ã—")]),t("div",Kt,[t("div",Gt,[t("label",jt,[e[47]||(e[47]=t("span",null,"æ¨™é¡Œ *",-1)),_(t("input",{"onUpdate:modelValue":e[9]||(e[9]=n=>i.title=n),type:"text",placeholder:"æ–‡ç« æ¨™é¡Œ"},null,512),[[C,i.title]])])]),t("div",zt,[t("label",null,[e[48]||(e[48]=t("span",null,"ä½œè€…",-1)),_(t("input",{"onUpdate:modelValue":e[10]||(e[10]=n=>i.author=n),type:"text",placeholder:"ä¾‹å¦‚ï¼šé™¶æ·µæ˜"},null,512),[[C,i.author]])]),t("label",null,[e[49]||(e[49]=t("span",null,"ä¾†æº",-1)),_(t("input",{"onUpdate:modelValue":e[11]||(e[11]=n=>i.source=n),type:"text",placeholder:"ä¾‹å¦‚ï¼šå¤æ–‡è§€æ­¢"},null,512),[[C,i.source]])])]),t("label",null,[e[50]||(e[50]=t("span",null,"æ–‡é›†ï¼ˆé»æ“Šé¸æ“‡ï¼‰*",-1)),t("div",Ht,[(l(!0),s(k,null,A(E.value,n=>(l(),s("button",{key:n.id,type:"button",class:ue(["category-tag-btn",{selected:i.reading_category_ids.includes(n.id)}]),onClick:u=>Ue(n.id)},[i.reading_category_ids.includes(n.id)?(l(),s("span",Wt,"âœ“")):m("",!0),V(" "+o(n.name),1)],10,Jt))),128)),h.value?(l(),s("div",qt,[_(t("input",{"onUpdate:modelValue":e[12]||(e[12]=n=>b.value=n),type:"text",class:"new-category-input-inline",onKeyup:[L(G,["enter"]),e[13]||(e[13]=L(n=>{h.value=!1,b.value=""},["escape"]))]},null,544),[[C,b.value]]),t("button",{type:"button",class:"inline-action confirm",onClick:G},"âœ“"),t("button",{type:"button",class:"inline-action cancel",onClick:e[14]||(e[14]=n=>{h.value=!1,b.value=""})},"Ã—")])):(l(),s("button",{key:1,type:"button",class:"category-tag-btn add-new",onClick:e[15]||(e[15]=n=>{h.value=!0,b.value=""})}," + æ–°å¢æ–‡é›† "))])]),t("label",null,[e[51]||(e[51]=t("span",null,"å…§å®¹ï¼ˆå¯ç›´æ¥ç²˜è²¼å¸¶æ¨™é»çš„åŸæ–‡ï¼‰",-1)),_(t("textarea",{"onUpdate:modelValue":e[16]||(e[16]=n=>i.content=n),rows:"10",placeholder:`ç›´æ¥ç²˜è²¼å¤æ–‡åŸæ–‡å³å¯ï¼Œç³»çµ±æœƒè‡ªå‹•è™•ç†æ¨™é»ç¬¦è™Ÿã€‚

ä¾‹å¦‚ï¼š
æ™‰å¤ªåŸä¸­ï¼Œæ­¦é™µäººæ•é­šç‚ºæ¥­ã€‚ç·£æºªè¡Œï¼Œå¿˜è·¯ä¹‹é è¿‘ã€‚

æ®µè½ä¹‹é–“ç”¨ç©ºè¡Œåˆ†éš”ã€‚`},null,512),[[C,i.content]])]),c.value?(l(),s("p",Qt,o(c.value),1)):m("",!0)]),t("footer",null,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[17]||(e[17]=n=>w.value=!1)}," å–æ¶ˆ "),t("button",{class:"edamame-btn edamame-btn-primary",disabled:p.value,onClick:xe},o(p.value?"å„²å­˜ä¸­...":"å„²å­˜"),9,Xt)])])])):m("",!0)]),_:1})])),(l(),H(X,{to:"body"},[W(Q,{name:"fade"},{default:q(()=>[R.value?(l(),s("div",{key:0,class:"modal-backdrop",onClick:e[24]||(e[24]=D(n=>R.value=!1,["self"]))},[t("div",Yt,[t("header",null,[e[52]||(e[52]=t("h3",null,"ğŸ“¤ æå–ç‚ºç·´ç¿’ç´ æ",-1)),t("button",{class:"close-btn",onClick:e[19]||(e[19]=n=>R.value=!1)},"Ã—")]),t("div",Zt,[t("div",en,[e[53]||(e[53]=t("p",{class:"preview-label"},"é¸å–çš„ç‰‡æ®µï¼š",-1)),t("p",tn,o(v.selectedText),1),t("p",nn," å…± "+o(v.selectedText.length)+" å­— ",1)]),t("label",null,[e[54]||(e[54]=t("span",null,"ç·´ç¿’æ¨™é¡Œ *",-1)),_(t("input",{"onUpdate:modelValue":e[20]||(e[20]=n=>v.title=n),type:"text",placeholder:"ä¾‹å¦‚ï¼šæ¡ƒèŠ±æºè¨˜ï¼ˆç¯€é¸ä¸€ï¼‰"},null,512),[[C,v.title]])]),t("div",an,[t("label",null,[e[56]||(e[56]=t("span",null,"åˆ†é¡",-1)),_(t("select",{"onUpdate:modelValue":e[21]||(e[21]=n=>v.category_id=n)},[e[55]||(e[55]=t("option",{value:null},"ä¸åˆ†é¡",-1)),(l(!0),s(k,null,A(me.value,n=>(l(),s("option",{key:n.id,value:n.id},o(n.name),9,ln))),128))],512),[[ce,v.category_id]])]),t("label",null,[e[58]||(e[58]=t("span",null,"é›£åº¦",-1)),_(t("select",{"onUpdate:modelValue":e[22]||(e[22]=n=>v.difficulty=n)},[...e[57]||(e[57]=[t("option",{value:1},"åˆç´š",-1),t("option",{value:2},"ä¸­ç´š",-1),t("option",{value:3},"é«˜ç´š",-1)])],512),[[ce,v.difficulty]])])]),t("p",sn," æå–å¾Œçš„ç·´ç¿’ç´ æå°‡é—œè¯åˆ°åŸæ–‡ç« ï¼Œå­¸ç”Ÿç·´ç¿’æ™‚å¯ä»¥çœ‹åˆ°ã€Œä¾†è‡ªã€Š"+o(d.value?.title)+"ã€‹ã€ ",1),c.value?(l(),s("p",on,o(c.value),1)):m("",!0)]),t("footer",null,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[23]||(e[23]=n=>R.value=!1)}," å–æ¶ˆ "),t("button",{class:"edamame-btn edamame-btn-primary",disabled:p.value,onClick:Te},o(p.value?"æå–ä¸­...":"ç¢ºèªæå–"),9,dn)])])])):m("",!0)]),_:1})])),(l(),H(X,{to:"body"},[W(Q,{name:"fade"},{default:q(()=>[M.value?(l(),s("div",{key:0,class:"modal-backdrop",onClick:e[27]||(e[27]=D(n=>M.value=!1,["self"]))},[t("div",rn,[t("header",null,[t("h3",null,"ğŸ¤– AI ç”Ÿæˆçš„è¨»é‡‹é è¦½ ("+o(T.value.length)+" å€‹)",1),t("button",{class:"close-btn",onClick:e[25]||(e[25]=n=>M.value=!1)},"Ã—")]),t("div",un,[e[59]||(e[59]=t("p",{class:"preview-hint"},"è«‹æª¢æŸ¥ä»¥ä¸‹è¨»é‡‹ï¼Œç¢ºèªç„¡èª¤å¾Œé»æ“Šã€Œå…¨éƒ¨ä¿å­˜ã€",-1)),t("div",cn,[(l(!0),s(k,null,A(T.value,(n,u)=>(l(),s("div",{key:u,class:"generated-annotation-item"},[t("div",vn,[t("span",mn,[V(o(n.term)+" ",1),n.pinyin?(l(),s("span",pn,"ï¼ˆ"+o(n.pinyin)+"ï¼‰",1)):m("",!0)]),t("span",gn,"ä½ç½®ï¼š"+o(n.start_index)+"-"+o(n.end_index),1)]),t("div",fn,o(n.annotation),1)]))),128))]),c.value?(l(),s("p",yn,o(c.value),1)):m("",!0)]),t("footer",null,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[26]||(e[26]=n=>M.value=!1)}," å–æ¶ˆ "),t("button",{class:"edamame-btn edamame-btn-primary",disabled:p.value||T.value.length===0,onClick:Se},o(p.value?"ä¿å­˜ä¸­...":`å…¨éƒ¨ä¿å­˜ (${T.value.length})`),9,bn)])])])):m("",!0)]),_:1})])),(l(),H(X,{to:"body"},[W(Q,{name:"fade"},{default:q(()=>[F.value?(l(),s("div",{key:0,class:"modal-backdrop",onClick:e[32]||(e[32]=D(n=>F.value=!1,["self"]))},[t("div",_n,[t("header",null,[e[60]||(e[60]=t("h3",null,"ğŸ“ æ·»åŠ è¨»é‡‹",-1)),t("button",{class:"close-btn",onClick:e[28]||(e[28]=n=>F.value=!1)},"Ã—")]),t("div",kn,[t("div",xn,[e[61]||(e[61]=t("p",{class:"preview-label"},"é¸å–çš„å­—è©ï¼š",-1)),t("p",hn,o(g.selectedText),1)]),t("label",null,[e[62]||(e[62]=t("span",null,"è¨»é‡‹å…§å®¹ *",-1)),_(t("textarea",{"onUpdate:modelValue":e[29]||(e[29]=n=>g.annotation=n),rows:"4",placeholder:"è¼¸å…¥å°é€™å€‹å­—è©çš„è§£é‡‹..."},null,512),[[C,g.annotation]])]),t("label",null,[e[63]||(e[63]=t("span",null,"æ‹¼éŸ³ï¼ˆå¯é¸ï¼Œç”¨æ–¼é›£è®€å­—ï¼‰",-1)),_(t("input",{"onUpdate:modelValue":e[30]||(e[30]=n=>g.pinyin=n),type:"text",placeholder:"ä¾‹å¦‚ï¼šzhÃ¬"},null,512),[[C,g.pinyin]])]),c.value?(l(),s("p",Cn,o(c.value),1)):m("",!0)]),t("footer",null,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[31]||(e[31]=n=>F.value=!1)}," å–æ¶ˆ "),t("button",{class:"edamame-btn edamame-btn-primary",disabled:p.value,onClick:Ie},o(p.value?"æ·»åŠ ä¸­...":"ç¢ºèªæ·»åŠ "),9,wn)])])])):m("",!0)]),_:1})]))]))}}),Dn=Oe($n,[["__scopeId","data-v-aa8d52e3"]]);export{Dn as default};
