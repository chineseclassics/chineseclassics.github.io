import{d as Be,u as Ne,r as f,K as W,c as F,f as Ke,a as s,h as p,m as q,F as x,g as t,i as Q,s as V,j as R,H as k,I as $,L as B,t as o,e as X,p as Y,T as Z,M as ee,b as ve,G as U,J as me,o as l,_ as Ge}from"./index-uJe3jXWw.js";import{u as je}from"./readingStore-BtnCwDTT.js";import{u as ze}from"./practiceLibraryStore-CnBBd3tt.js";import{u as He}from"./useSupabase-DDWGeXlc.js";const Je={class:"admin-reading-page"},We={class:"admin-header"},qe={class:"header-actions"},Qe=["disabled"],Xe=["disabled"],Ye={class:"admin-layout"},Ze={class:"category-sidebar edamame-glass"},et={class:"sidebar-header"},tt={key:0,class:"sidebar-loading"},nt={key:1,class:"sidebar-empty"},at={key:2,class:"category-tree"},lt={key:0,class:"tree-item editing"},st=["onClick"],ot={class:"tree-label"},it={class:"tree-count"},rt={class:"tree-actions"},dt=["onClick"],ut=["onClick"],ct={key:3,class:"add-category-inline"},vt={class:"add-category-actions"},mt={class:"content-panel edamame-glass"},pt={key:0,class:"content-empty"},ft={class:"category-info"},gt={class:"category-meta"},yt={class:"text-list-section"},bt={key:0,class:"text-empty"},_t={key:1},kt=["onClick"],ht={class:"text-title"},xt={class:"text-preview"},Ct=["onClick"],wt=["onClick"],$t=["onClick"],Tt=["onClick"],It=["onClick"],At={class:"detail-header"},St={class:"detail-actions"},Dt=["disabled"],Vt={class:"text-meta edamame-glass"},Rt={class:"detail-title"},Ft={class:"meta-row"},Ut={key:0,class:"meta-item"},Et={key:1,class:"meta-item"},Mt={class:"meta-item"},Pt={key:2,class:"meta-item"},Lt={class:"category-tags inline"},Ot={key:0,class:"selection-toolbar"},Bt={class:"selected-text"},Nt={key:1,class:"annotations-section edamame-glass"},Kt={class:"section-title"},Gt={class:"annotation-list"},jt={class:"annotation-term"},zt={key:0,class:"annotation-pinyin"},Ht={class:"annotation-content"},Jt={class:"annotation-actions"},Wt=["onClick"],qt=["onClick"],Qt={class:"modal-card edamame-glass large-modal"},Xt={class:"modal-body"},Yt={class:"form-row"},Zt={class:"flex-2"},en={class:"form-row"},tn={class:"category-picker"},nn=["onClick"],an={key:0,class:"tag-check"},ln={key:0,class:"new-category-inline"},sn={key:0,class:"feedback"},on=["disabled"],rn={class:"modal-card edamame-glass"},dn={class:"modal-body"},un={class:"selected-preview"},cn={class:"preview-content"},vn={class:"preview-info"},mn={class:"form-row"},pn=["value"],fn={class:"extract-note"},gn={key:0,class:"feedback"},yn=["disabled"],bn={class:"modal-card edamame-glass",style:{"max-width":"800px","max-height":"80vh","overflow-y":"auto"}},_n={class:"modal-body"},kn={class:"generated-annotations-list"},hn={class:"annotation-header"},xn={class:"annotation-term"},Cn={key:0,class:"annotation-pinyin"},wn={class:"annotation-position"},$n={class:"annotation-content"},Tn={key:0,class:"feedback"},In=["disabled"],An={class:"modal-card edamame-glass"},Sn={class:"modal-body"},Dn={class:"selected-preview"},Vn={class:"preview-content annotation-term-preview"},Rn={key:0,class:"feedback"},Fn=["disabled"],Un=Be({__name:"AdminReadingPage",setup(En){const d=je(),se=ze(),pe=Ne(),K=f("list"),r=f(null),C=f(null),I=f(!1),E=f(!1),A=f(!1),g=f(!1),c=f(null),S=f(null),i=W({title:"",author:"",source:"",summary:"",content:"",reading_category_ids:[]}),w=f(!1),b=f(""),N=f(null),M=f(""),v=W({selectedText:"",startIndex:0,endIndex:0,title:"",category_id:null,difficulty:2}),m=W({selectedText:"",startIndex:0,endIndex:0,annotation:"",pinyin:""}),_=f(null),G=f(!1),D=f([]),P=f(!1),L=F(()=>d.readingCategories),fe=F(()=>se.state.categories.filter(a=>a.level===1).sort((a,e)=>a.order_index-e.order_index)),te=F(()=>C.value&&d.readingCategories.find(a=>a.id===C.value)||null),ne=F(()=>C.value?d.readingTexts.filter(a=>a.reading_categories?.some(e=>e.id===C.value)):[]);function oe(a){return d.readingTexts.filter(e=>e.reading_categories?.some(n=>n.id===a)).length}function ge(a){C.value=a}function ye(a){N.value=a.id,M.value=a.name}function j(){N.value=null,M.value=""}async function ie(){if(!N.value||!M.value.trim()){j();return}try{await d.updateReadingCategory(N.value,{name:M.value.trim()}),j()}catch(a){alert(a?.message||"æ›´æ–°æ–‡é›†å¤±æ•—")}}async function be(a){const e=oe(a.id);if(e>0){alert(`ç„¡æ³•åˆªé™¤ã€Œ${a.name}ã€ï¼šæ­¤æ–‡é›†ä¸‹é‚„æœ‰ ${e} ç¯‡æ–‡ç« ã€‚è«‹å…ˆç§»é™¤æ–‡ç« å¾Œå†åˆªé™¤æ–‡é›†ã€‚`);return}if(confirm(`ç¢ºå®šè¦åˆªé™¤æ–‡é›†ã€Œ${a.name}ã€å—ï¼Ÿ`))try{await d.deleteReadingCategory(a.id),C.value===a.id&&(C.value=null)}catch(n){alert(n?.message||"åˆªé™¤æ–‡é›†å¤±æ•—")}}const _e=F(()=>{const a=d.currentText||r.value;return a?a.content.replace(/\|/g,""):""}),ke=F(()=>{const a=d.currentText||r.value;if(!a)return[];const e=a.content.includes("||")?"||":/\n\n+/;return a.content.split(e).map(n=>n.replace(/\|/g,""))}),ae=F(()=>d.currentText?.annotations||[]);async function z(a){r.value=a,K.value="detail",await d.fetchTextDetail(a.id)}function re(){K.value="list",r.value=null,d.clearCurrentText()}function de(){S.value=null,i.title="",i.author="",i.source="",i.summary="",i.content="",i.reading_category_ids=[],c.value=null,I.value=!0}function he(){const a=d.currentText||r.value;a&&ue(a)}function ue(a){S.value=a,i.title=a.title,i.author=a.author||"",i.source=a.source||"",i.summary=a.summary||"";let e=a.content;e.includes("||")&&(e=e.replace(/\|\|/g,`

`)),i.content=e,i.reading_category_ids=a.reading_categories?.map(n=>n.id)||[],c.value=null,I.value=!0}async function xe(a){if(confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${a.title}ã€å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚`))try{await d.deleteReadingText(a.id),r.value?.id===a.id&&re()}catch(e){alert(e?.message||"åˆªé™¤å¤±æ•—")}}async function Ce(){if(!i.title.trim()||!i.content.trim()){c.value="æ¨™é¡Œå’Œå…§å®¹ç‚ºå¿…å¡«";return}if(!i.reading_category_ids||i.reading_category_ids.length===0){c.value="è«‹è‡³å°‘é¸æ“‡ä¸€å€‹æ–‡é›†";return}try{g.value=!0;const a=Ee(i.content);if(!a){c.value="å…§å®¹è™•ç†å¾Œç‚ºç©ºï¼Œè«‹æª¢æŸ¥è¼¸å…¥";return}if(S.value){if(await d.updateReadingText(S.value.id,{title:i.title.trim(),author:i.author.trim()||null,source:i.source.trim()||null,summary:i.summary.trim()||null,category_id:null,content:a,reading_category_ids:i.reading_category_ids}),S.value&&r.value?.id===S.value.id){const e=d.readingTexts.find(n=>n.id===S.value.id);e&&(r.value=e)}I.value=!1}else await d.createReadingText({title:i.title.trim(),author:i.author.trim()||null,source:i.source.trim()||null,summary:i.summary.trim()||null,content:a,category_id:null,reading_category_ids:i.reading_category_ids},pe.isAdmin),I.value=!1}catch(a){c.value=a?.message||"å„²å­˜å¤±æ•—"}finally{g.value=!1}}function we(){const a=window.getSelection();if(!a||a.isCollapsed)return;const e=a.toString().trim();if(!e||e.length===0)return;const u=_e.value.indexOf(e);u>=0&&$e(e,u,u+e.length)}const y=W({show:!1,text:"",startIndex:0,endIndex:0});function $e(a,e,n){y.text=a,y.startIndex=e,y.endIndex=n,y.show=!0}function le(){y.show=!1}function Te(){r.value&&(v.selectedText=y.text,v.startIndex=y.startIndex,v.endIndex=y.endIndex,v.title=`${r.value.title}ï¼ˆç¯€é¸ï¼‰`,v.category_id=r.value.category_id||null,v.difficulty=2,c.value=null,le(),E.value=!0)}function Ie(){_.value=null,m.selectedText=y.text,m.startIndex=y.startIndex,m.endIndex=y.endIndex,m.annotation="",m.pinyin="",c.value=null,le(),A.value=!0}function Ae(a){_.value=a.id,m.selectedText=a.term,m.startIndex=a.start_index,m.endIndex=a.end_index,m.annotation=a.annotation,m.pinyin=a.pinyin||"",c.value=null,A.value=!0}async function Se(){if(!r.value||!v.selectedText){c.value="è«‹é¸å–è¦æå–çš„æ–‡å­—";return}if(!v.title.trim()){c.value="è«‹è¼¸å…¥æ¨™é¡Œ";return}try{g.value=!0;const a=r.value.content;let e="",n=0;for(let u=0;u<a.length;u++){const O=a[u];O==="|"?n>v.startIndex&&n<=v.endIndex&&(e+=O):(n>=v.startIndex&&n<v.endIndex&&(e+=O),n++)}await d.extractPracticeFragment(r.value.id,v.startIndex,v.endIndex,e,{title:v.title.trim(),category_id:v.category_id,difficulty:v.difficulty}),E.value=!1,alert("ç·´ç¿’ç´ ææå–æˆåŠŸï¼")}catch(a){c.value=a?.message||"æå–å¤±æ•—"}finally{g.value=!1}}async function De(){if(!r.value||!m.selectedText){c.value="è«‹é¸å–è¦è¨»é‡‹çš„æ–‡å­—";return}if(!m.annotation.trim()){c.value="è«‹è¼¸å…¥è¨»é‡‹å…§å®¹";return}try{g.value=!0,_.value?(await d.updateAnnotation(_.value,m.annotation.trim(),m.pinyin.trim()||null),A.value=!1,alert("è¨»é‡‹æ›´æ–°æˆåŠŸï¼")):(await d.addAnnotation({text_id:r.value.id,start_index:m.startIndex,end_index:m.endIndex,term:m.selectedText,annotation:m.annotation.trim(),pinyin:m.pinyin.trim()||null}),A.value=!1,alert("è¨»é‡‹æ·»åŠ æˆåŠŸï¼")),await d.fetchTextDetail(r.value.id)}catch(a){c.value=a?.message||(_.value?"æ›´æ–°è¨»é‡‹å¤±æ•—":"æ·»åŠ è¨»é‡‹å¤±æ•—")}finally{g.value=!1,_.value=null}}async function Ve(){if(!r.value){c.value="è«‹å…ˆé¸æ“‡ä¸€ç¯‡æ–‡ç« ";return}try{G.value=!0,c.value=null;const a=r.value.content,e=a.includes("||")?"||":/\n\n+/,n=a.split(e);let u="";for(const Le of n){const Oe=Le.replace(/[\|\s]+$/,"");for(const J of Oe)J!=="|"&&J!==`
`&&J!=="\r"&&(u+=J)}const O=He(),{data:T,error:h}=await O.functions.invoke("generate-annotations",{body:{content:u,title:r.value.title,author:r.value.author}});if(h)throw h;if(T.success&&T.data)D.value=T.data,P.value=!0,c.value=`æˆåŠŸç”Ÿæˆ ${T.count||0} å€‹è¨»é‡‹ï¼Œè«‹é è¦½ä¸¦ç¢ºèª`;else throw new Error(T.error||"ç”Ÿæˆè¨»é‡‹å¤±æ•—")}catch(a){console.error("ç”Ÿæˆè¨»é‡‹å¤±æ•—:",a),c.value=a?.message||"ç”Ÿæˆè¨»é‡‹æ™‚ç™¼ç”ŸéŒ¯èª¤"}finally{G.value=!1}}async function Re(){if(!(!r.value||D.value.length===0))try{g.value=!0,c.value=null;let a=0,e=0;for(const n of D.value)try{await d.addAnnotation({text_id:r.value.id,start_index:n.start_index,end_index:n.end_index,term:n.term,annotation:n.annotation,pinyin:n.pinyin||null}),a++}catch(u){console.error("ä¿å­˜è¨»é‡‹å¤±æ•—:",n.term,u),e++}await d.fetchTextDetail(r.value.id),P.value=!1,D.value=[],e>0?alert(`å·²ä¿å­˜ ${a} å€‹è¨»é‡‹ï¼Œ${e} å€‹å¤±æ•—`):alert(`æˆåŠŸä¿å­˜ ${a} å€‹è¨»é‡‹ï¼`)}catch(a){c.value=a?.message||"ä¿å­˜è¨»é‡‹å¤±æ•—"}finally{g.value=!1}}async function Fe(a){if(confirm(`ç¢ºå®šè¦åˆªé™¤ã€Œ${a.term}ã€çš„è¨»é‡‹å—ï¼Ÿ`))try{await d.deleteAnnotation(a.id),r.value&&await d.fetchTextDetail(r.value.id)}catch(e){alert(e?.message||"åˆªé™¤å¤±æ•—")}}function Ue(a){return a.content.replace(/\|/g,"").slice(0,40)+"..."}function Ee(a){const e=/[ã€‚ï¼Œã€ï¼›ï¼šï¼ï¼Ÿ,.;:!?]/g,n=/[ã€Œã€ã€ã€""''ï¼ˆï¼‰()ã€ã€‘\[\]ã€Šã€‹<>Â·â€”â€¦ï½\-]/g;return a.split(/\n+/).map(T=>{let h=T.trim();return h?(h=h.replace(n,""),h=h.replace(e,"|"),h=h.replace(/\|+/g,"|").replace(/^\|/,"").replace(/\|$/,""),h):""}).filter(T=>T.length>0).join(`

`)}function Me(a){return a?new Date(a).toLocaleDateString():"--"}function ce(a){return a.content.replace(/\|/g,"").length}function Pe(a){const e=i.reading_category_ids.indexOf(a);e>-1?i.reading_category_ids.splice(e,1):i.reading_category_ids.push(a)}async function H(){if(b.value.trim())try{const a=await d.createReadingCategory(b.value.trim());a&&i.reading_category_ids.push(a.id),b.value="",w.value=!1}catch(a){alert(a?.message||"æ–°å¢åˆ†é¡å¤±æ•—")}}return Ke(async()=>{await Promise.all([d.fetchReadingCategories(),d.fetchReadingTexts(),se.fetchLibrary()]),L.value.length>0&&!C.value&&L.value[0]&&(C.value=L.value[0].id)}),(a,e)=>(l(),s("div",Je,[K.value==="list"?(l(),s(x,{key:0},[t("header",We,[e[33]||(e[33]=t("div",null,[t("p",{class:"edamame-text-level-detail"},"ç®¡ç†é–±è®€æ–‡ç« å’Œæå–ç·´ç¿’ç‰‡æ®µ"),t("h1",{class:"edamame-heading-gradient"},"é–±è®€æ–‡åº«")],-1)),t("div",qe,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[0]||(e[0]=n=>{Q(d).fetchReadingTexts(),Q(d).fetchReadingCategories()}),disabled:Q(d).isLoading}," é‡æ–°æ•´ç† ",8,Qe),t("button",{class:"edamame-btn edamame-btn-primary",onClick:de,disabled:!te.value}," æ–°å¢é–±è®€æ–‡ç«  ",8,Xe)])]),t("div",Ye,[t("aside",Ze,[t("div",et,[e[35]||(e[35]=t("span",{class:"sidebar-title"},"æ–‡é›†å°èˆª",-1)),t("button",{class:"icon-btn",onClick:e[1]||(e[1]=n=>{w.value=!0,b.value=""}),title:"æ–°å¢æ–‡é›†"},[...e[34]||(e[34]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 5v14M5 12h14"})],-1)])])]),Q(d).isLoading?(l(),s("div",tt,"è¼‰å…¥ä¸­â‹¯")):L.value.length?(l(),s("nav",at,[(l(!0),s(x,null,R(L.value,n=>(l(),s("div",{key:n.id,class:"tree-node"},[N.value===n.id?(l(),s("div",lt,[k(t("input",{"onUpdate:modelValue":e[3]||(e[3]=u=>M.value=u),type:"text",class:"edit-input",onKeyup:[B(ie,["enter"]),B(j,["escape"])],ref_for:!0,ref:"editInput"},null,544),[[$,M.value]]),t("div",{class:"edit-actions"},[t("button",{class:"action-btn",onClick:ie,title:"ç¢ºèª"},"âœ“"),t("button",{class:"action-btn",onClick:j,title:"å–æ¶ˆ"},"Ã—")])])):(l(),s("div",{key:1,class:ve(["tree-item",{selected:C.value===n.id}]),onClick:u=>ge(n.id)},[t("span",ot,o(n.name),1),t("span",it,o(oe(n.id)),1),t("div",rt,[t("button",{class:"action-btn",onClick:U(u=>ye(n),["stop"]),title:"ç·¨è¼¯"},"âœ",8,dt),t("button",{class:"action-btn danger",onClick:U(u=>be(n),["stop"]),title:"åˆªé™¤"},"Ã—",8,ut)])],10,st))]))),128))])):(l(),s("div",nt,[e[36]||(e[36]=V(" å°šç„¡æ–‡é›† ",-1)),t("button",{class:"link-btn",onClick:e[2]||(e[2]=n=>{w.value=!0,b.value=""})},"å»ºç«‹ç¬¬ä¸€å€‹æ–‡é›†")])),w.value?(l(),s("div",ct,[k(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>b.value=n),type:"text",placeholder:"è¼¸å…¥æ–‡é›†åç¨±...",class:"category-input",onKeyup:[B(H,["enter"]),e[5]||(e[5]=B(n=>w.value=!1,["escape"]))]},null,544),[[$,b.value]]),t("div",vt,[t("button",{class:"action-btn",onClick:H,title:"ç¢ºèª"},"âœ“"),t("button",{class:"action-btn",onClick:e[6]||(e[6]=n=>w.value=!1),title:"å–æ¶ˆ"},"Ã—")])])):p("",!0)]),t("main",mt,[te.value?(l(),s(x,{key:1},[t("div",ft,[t("h2",null,o(te.value.name),1),t("p",gt,o(ne.value.length)+" ç¯‡æ–‡ç« ",1)]),t("div",yt,[ne.value.length?(l(),s("table",_t,[e[39]||(e[39]=t("thead",null,[t("tr",null,[t("th",{style:{width:"auto","min-width":"200px"}},"æ¨™é¡Œ"),t("th",{style:{width:"80px"}},"ä½œè€…"),t("th",{style:{width:"70px"}},"å­—æ•¸"),t("th",{style:{width:"100px"}},"å»ºç«‹æ—¥æœŸ"),t("th",{style:{width:"120px"}},"æ“ä½œ")])],-1)),t("tbody",null,[(l(!0),s(x,null,R(ne.value,n=>(l(),s("tr",{key:n.id,class:"text-row"},[t("td",{onClick:u=>z(n)},[t("p",ht,o(n.title),1),t("p",xt,o(Ue(n)),1)],8,kt),t("td",{onClick:u=>z(n)},o(n.author||"ä½šå"),9,Ct),t("td",{onClick:u=>z(n)},o(ce(n)),9,wt),t("td",{onClick:u=>z(n)},o(Me(n.created_at)),9,$t),t("td",{class:"actions",onClick:e[7]||(e[7]=U(()=>{},["stop"]))},[t("button",{class:"ghost-btn",onClick:u=>ue(n)},"ç·¨è¼¯",8,Tt),t("button",{class:"ghost-btn danger",onClick:u=>xe(n)},"åˆªé™¤",8,It)])]))),128))])])):(l(),s("div",bt,[e[38]||(e[38]=t("p",null,"æ­¤æ–‡é›†å°šç„¡æ–‡ç« ",-1)),t("button",{class:"edamame-btn edamame-btn-primary",onClick:de},"æ–°å¢ç¬¬ä¸€ç¯‡æ–‡ç« ")]))])],64)):(l(),s("div",pt,[...e[37]||(e[37]=[t("p",null,"è«‹å¾å·¦å´é¸æ“‡ä¸€å€‹æ–‡é›†",-1)])]))])])],64)):K.value==="detail"&&r.value?(l(),s(x,{key:1},[t("header",At,[t("button",{class:"back-btn",onClick:re},[...e[40]||(e[40]=[t("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),V(" è¿”å›åˆ—è¡¨ ",-1)])]),t("div",St,[t("button",{class:"edamame-btn edamame-btn-primary",onClick:Ve,disabled:G.value||!r.value,title:"ä½¿ç”¨ AI è‡ªå‹•ç”Ÿæˆè¨»é‡‹ï¼ˆå«æ‹¼éŸ³ï¼‰"},o(G.value?"ğŸ¤– AI ç”Ÿæˆä¸­...":"ğŸ¤– AI ç”Ÿæˆè¨»é‡‹"),9,Dt),t("button",{class:"edamame-btn edamame-btn-secondary",onClick:he}," ç·¨è¼¯æ–‡ç«  ")])]),t("div",Vt,[t("h1",Rt,o(r.value.title),1),t("div",Ft,[r.value.author?(l(),s("span",Ut,[e[41]||(e[41]=t("strong",null,"ä½œè€…ï¼š",-1)),V(o(r.value.author),1)])):p("",!0),r.value.source?(l(),s("span",Et,[e[42]||(e[42]=t("strong",null,"ä¾†æºï¼š",-1)),V(o(r.value.source),1)])):p("",!0),t("span",Mt,[e[43]||(e[43]=t("strong",null,"å­—æ•¸ï¼š",-1)),V(o(ce(r.value)),1)]),r.value.reading_categories?.length?(l(),s("span",Pt,[e[44]||(e[44]=t("strong",null,"æ–‡é›†ï¼š",-1)),t("span",Lt,[(l(!0),s(x,null,R(r.value.reading_categories,n=>(l(),s("span",{key:n.id,class:"category-tag"},o(n.name),1))),128))])])):p("",!0)])]),e[45]||(e[45]=t("div",{class:"action-hint"}," ğŸ’¡ é¸å–æ–‡å­—å¾Œå¯ä»¥ã€Œæå–ç‚ºç·´ç¿’ã€æˆ–ã€Œæ·»åŠ è¨»é‡‹ã€ ",-1)),y.show?(l(),s("div",Ot,[t("span",Bt,"ã€Œ"+o(y.text.slice(0,20))+o(y.text.length>20?"...":"")+"ã€",1),t("button",{class:"toolbar-btn extract",onClick:Te}," ğŸ“¤ æå–ç‚ºç·´ç¿’ "),t("button",{class:"toolbar-btn annotate",onClick:Ie}," ğŸ“ æ·»åŠ è¨»é‡‹ "),t("button",{class:"toolbar-btn cancel",onClick:le}," âœ• ")])):p("",!0),t("div",{class:"text-content edamame-glass",onMouseup:we},[(l(!0),s(x,null,R(ke.value,(n,u)=>(l(),s("div",{key:u,class:"paragraph"},o(n),1))),128))],32),ae.value.length>0?(l(),s("div",Nt,[t("h3",Kt,"ğŸ“ å·²æ·»åŠ çš„è¨»é‡‹ ("+o(ae.value.length)+")",1),t("div",Gt,[(l(!0),s(x,null,R(ae.value,n=>(l(),s("div",{key:n.id,class:"annotation-item"},[t("div",jt,[V(o(n.term)+" ",1),n.pinyin?(l(),s("span",zt,"ï¼ˆ"+o(n.pinyin)+"ï¼‰",1)):p("",!0)]),t("div",Ht,o(n.annotation),1),t("div",Jt,[t("button",{class:"edit-btn",onClick:u=>Ae(n),title:"ç·¨è¼¯"}," âœï¸ ",8,Wt),t("button",{class:"delete-btn",onClick:u=>Fe(n),title:"åˆªé™¤"}," âœ• ",8,qt)])]))),128))])])):p("",!0)],64)):p("",!0),(l(),q(ee,{to:"body"},[X(Z,{name:"fade"},{default:Y(()=>[I.value?(l(),s("div",{key:0,class:"modal-backdrop",onClick:e[18]||(e[18]=U(n=>I.value=!1,["self"]))},[t("div",Qt,[t("header",null,[t("h3",null,o(S.value?"ç·¨è¼¯é–±è®€æ–‡ç« ":"æ–°å¢é–±è®€æ–‡ç« "),1),t("button",{class:"close-btn",onClick:e[8]||(e[8]=n=>I.value=!1)},"Ã—")]),t("div",Xt,[t("div",Yt,[t("label",Zt,[e[46]||(e[46]=t("span",null,"æ¨™é¡Œ *",-1)),k(t("input",{"onUpdate:modelValue":e[9]||(e[9]=n=>i.title=n),type:"text",placeholder:"æ–‡ç« æ¨™é¡Œ"},null,512),[[$,i.title]])])]),t("div",en,[t("label",null,[e[47]||(e[47]=t("span",null,"ä½œè€…",-1)),k(t("input",{"onUpdate:modelValue":e[10]||(e[10]=n=>i.author=n),type:"text",placeholder:"ä¾‹å¦‚ï¼šé™¶æ·µæ˜"},null,512),[[$,i.author]])]),t("label",null,[e[48]||(e[48]=t("span",null,"ä¾†æº",-1)),k(t("input",{"onUpdate:modelValue":e[11]||(e[11]=n=>i.source=n),type:"text",placeholder:"ä¾‹å¦‚ï¼šå¤æ–‡è§€æ­¢"},null,512),[[$,i.source]])])]),t("label",null,[e[49]||(e[49]=t("span",null,"æ–‡é›†ï¼ˆé»æ“Šé¸æ“‡ï¼‰*",-1)),t("div",tn,[(l(!0),s(x,null,R(L.value,n=>(l(),s("button",{key:n.id,type:"button",class:ve(["category-tag-btn",{selected:i.reading_category_ids.includes(n.id)}]),onClick:u=>Pe(n.id)},[i.reading_category_ids.includes(n.id)?(l(),s("span",an,"âœ“")):p("",!0),V(" "+o(n.name),1)],10,nn))),128)),w.value?(l(),s("div",ln,[k(t("input",{"onUpdate:modelValue":e[12]||(e[12]=n=>b.value=n),type:"text",class:"new-category-input-inline",onKeyup:[B(H,["enter"]),e[13]||(e[13]=B(n=>{w.value=!1,b.value=""},["escape"]))]},null,544),[[$,b.value]]),t("button",{type:"button",class:"inline-action confirm",onClick:H},"âœ“"),t("button",{type:"button",class:"inline-action cancel",onClick:e[14]||(e[14]=n=>{w.value=!1,b.value=""})},"Ã—")])):(l(),s("button",{key:1,type:"button",class:"category-tag-btn add-new",onClick:e[15]||(e[15]=n=>{w.value=!0,b.value=""})}," + æ–°å¢æ–‡é›† "))])]),t("label",null,[e[50]||(e[50]=t("span",null,"å…§å®¹ï¼ˆå¯ç›´æ¥ç²˜è²¼å¸¶æ¨™é»çš„åŸæ–‡ï¼‰",-1)),k(t("textarea",{"onUpdate:modelValue":e[16]||(e[16]=n=>i.content=n),rows:"10",placeholder:`ç›´æ¥ç²˜è²¼å¤æ–‡åŸæ–‡å³å¯ï¼Œç³»çµ±æœƒè‡ªå‹•è™•ç†æ¨™é»ç¬¦è™Ÿã€‚

ä¾‹å¦‚ï¼š
æ™‰å¤ªåŸä¸­ï¼Œæ­¦é™µäººæ•é­šç‚ºæ¥­ã€‚ç·£æºªè¡Œï¼Œå¿˜è·¯ä¹‹é è¿‘ã€‚

æ®µè½ä¹‹é–“ç”¨ç©ºè¡Œåˆ†éš”ã€‚`},null,512),[[$,i.content]])]),c.value?(l(),s("p",sn,o(c.value),1)):p("",!0)]),t("footer",null,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[17]||(e[17]=n=>I.value=!1)}," å–æ¶ˆ "),t("button",{class:"edamame-btn edamame-btn-primary",disabled:g.value,onClick:Ce},o(g.value?"å„²å­˜ä¸­...":"å„²å­˜"),9,on)])])])):p("",!0)]),_:1})])),(l(),q(ee,{to:"body"},[X(Z,{name:"fade"},{default:Y(()=>[E.value?(l(),s("div",{key:0,class:"modal-backdrop",onClick:e[24]||(e[24]=U(n=>E.value=!1,["self"]))},[t("div",rn,[t("header",null,[e[51]||(e[51]=t("h3",null,"ğŸ“¤ æå–ç‚ºç·´ç¿’ç´ æ",-1)),t("button",{class:"close-btn",onClick:e[19]||(e[19]=n=>E.value=!1)},"Ã—")]),t("div",dn,[t("div",un,[e[52]||(e[52]=t("p",{class:"preview-label"},"é¸å–çš„ç‰‡æ®µï¼š",-1)),t("p",cn,o(v.selectedText),1),t("p",vn," å…± "+o(v.selectedText.length)+" å­— ",1)]),t("label",null,[e[53]||(e[53]=t("span",null,"ç·´ç¿’æ¨™é¡Œ *",-1)),k(t("input",{"onUpdate:modelValue":e[20]||(e[20]=n=>v.title=n),type:"text",placeholder:"ä¾‹å¦‚ï¼šæ¡ƒèŠ±æºè¨˜ï¼ˆç¯€é¸ä¸€ï¼‰"},null,512),[[$,v.title]])]),t("div",mn,[t("label",null,[e[55]||(e[55]=t("span",null,"åˆ†é¡",-1)),k(t("select",{"onUpdate:modelValue":e[21]||(e[21]=n=>v.category_id=n)},[e[54]||(e[54]=t("option",{value:null},"ä¸åˆ†é¡",-1)),(l(!0),s(x,null,R(fe.value,n=>(l(),s("option",{key:n.id,value:n.id},o(n.name),9,pn))),128))],512),[[me,v.category_id]])]),t("label",null,[e[57]||(e[57]=t("span",null,"é›£åº¦",-1)),k(t("select",{"onUpdate:modelValue":e[22]||(e[22]=n=>v.difficulty=n)},[...e[56]||(e[56]=[t("option",{value:1},"åˆç´š",-1),t("option",{value:2},"ä¸­ç´š",-1),t("option",{value:3},"é«˜ç´š",-1)])],512),[[me,v.difficulty]])])]),t("p",fn," æå–å¾Œçš„ç·´ç¿’ç´ æå°‡é—œè¯åˆ°åŸæ–‡ç« ï¼Œå­¸ç”Ÿç·´ç¿’æ™‚å¯ä»¥çœ‹åˆ°ã€Œä¾†è‡ªã€Š"+o(r.value?.title)+"ã€‹ã€ ",1),c.value?(l(),s("p",gn,o(c.value),1)):p("",!0)]),t("footer",null,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[23]||(e[23]=n=>E.value=!1)}," å–æ¶ˆ "),t("button",{class:"edamame-btn edamame-btn-primary",disabled:g.value,onClick:Se},o(g.value?"æå–ä¸­...":"ç¢ºèªæå–"),9,yn)])])])):p("",!0)]),_:1})])),(l(),q(ee,{to:"body"},[X(Z,{name:"fade"},{default:Y(()=>[P.value?(l(),s("div",{key:0,class:"modal-backdrop",onClick:e[27]||(e[27]=U(n=>P.value=!1,["self"]))},[t("div",bn,[t("header",null,[t("h3",null,"ğŸ¤– AI ç”Ÿæˆçš„è¨»é‡‹é è¦½ ("+o(D.value.length)+" å€‹)",1),t("button",{class:"close-btn",onClick:e[25]||(e[25]=n=>P.value=!1)},"Ã—")]),t("div",_n,[e[58]||(e[58]=t("p",{class:"preview-hint"},"è«‹æª¢æŸ¥ä»¥ä¸‹è¨»é‡‹ï¼Œç¢ºèªç„¡èª¤å¾Œé»æ“Šã€Œå…¨éƒ¨ä¿å­˜ã€",-1)),t("div",kn,[(l(!0),s(x,null,R(D.value,(n,u)=>(l(),s("div",{key:u,class:"generated-annotation-item"},[t("div",hn,[t("span",xn,[V(o(n.term)+" ",1),n.pinyin?(l(),s("span",Cn,"ï¼ˆ"+o(n.pinyin)+"ï¼‰",1)):p("",!0)]),t("span",wn,"ä½ç½®ï¼š"+o(n.start_index)+"-"+o(n.end_index),1)]),t("div",$n,o(n.annotation),1)]))),128))]),c.value?(l(),s("p",Tn,o(c.value),1)):p("",!0)]),t("footer",null,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[26]||(e[26]=n=>P.value=!1)}," å–æ¶ˆ "),t("button",{class:"edamame-btn edamame-btn-primary",disabled:g.value||D.value.length===0,onClick:Re},o(g.value?"ä¿å­˜ä¸­...":`å…¨éƒ¨ä¿å­˜ (${D.value.length})`),9,In)])])])):p("",!0)]),_:1})])),(l(),q(ee,{to:"body"},[X(Z,{name:"fade"},{default:Y(()=>[A.value?(l(),s("div",{key:0,class:"modal-backdrop",onClick:e[32]||(e[32]=U(n=>{A.value=!1,_.value=null},["self"]))},[t("div",An,[t("header",null,[t("h3",null,o(_.value?"âœï¸ ç·¨è¼¯è¨»é‡‹":"ğŸ“ æ·»åŠ è¨»é‡‹"),1),t("button",{class:"close-btn",onClick:e[28]||(e[28]=n=>{A.value=!1,_.value=null})},"Ã—")]),t("div",Sn,[t("div",Dn,[e[59]||(e[59]=t("p",{class:"preview-label"},"é¸å–çš„å­—è©ï¼š",-1)),t("p",Vn,o(m.selectedText),1)]),t("label",null,[e[60]||(e[60]=t("span",null,"è¨»é‡‹å…§å®¹ *",-1)),k(t("textarea",{"onUpdate:modelValue":e[29]||(e[29]=n=>m.annotation=n),rows:"4",placeholder:"è¼¸å…¥å°é€™å€‹å­—è©çš„è§£é‡‹..."},null,512),[[$,m.annotation]])]),t("label",null,[e[61]||(e[61]=t("span",null,"æ‹¼éŸ³ï¼ˆå¯é¸ï¼Œç”¨æ–¼é›£è®€å­—ï¼‰",-1)),k(t("input",{"onUpdate:modelValue":e[30]||(e[30]=n=>m.pinyin=n),type:"text",placeholder:"ä¾‹å¦‚ï¼šzhÃ¬"},null,512),[[$,m.pinyin]])]),c.value?(l(),s("p",Rn,o(c.value),1)):p("",!0)]),t("footer",null,[t("button",{class:"edamame-btn edamame-btn-secondary",onClick:e[31]||(e[31]=n=>{A.value=!1,_.value=null})}," å–æ¶ˆ "),t("button",{class:"edamame-btn edamame-btn-primary",disabled:g.value,onClick:De},o(g.value?_.value?"æ›´æ–°ä¸­...":"æ·»åŠ ä¸­...":_.value?"ç¢ºèªæ›´æ–°":"ç¢ºèªæ·»åŠ "),9,Fn)])])])):p("",!0)]),_:1})]))]))}}),Bn=Ge(Un,[["__scopeId","data-v-2ad3afde"]]);export{Bn as default};
