import{d as Ts,u as As,x as is,r as u,c as x,o as xs,a,e as c,F as p,b as s,t as i,f as o,A as j,B as G,i as C,n as g,h as $s,z as H,g as $,j as Ms,q as l,_ as zs}from"./index-DdpXNWNL.js";import{u as Ds}from"./classStore-BywemyFG.js";import{u as Ps}from"./assignmentStore-CW9sAPHh.js";import{u as Ls,a as Ns}from"./practiceLibraryStore-DOrRjr_3.js";import"./useSupabase-C8VqEUNi.js";const Vs={class:"my-classes-container"},Is={class:"page-header"},Us={class:"page-subtitle"},Es={key:0,class:"create-form edamame-glass"},Bs={class:"form-group"},qs={class:"form-group"},Fs={class:"form-actions"},Ws=["disabled"],Rs={key:1,class:"loading"},js={key:2,class:"classes-grid"},Gs=["onClick"],Hs={class:"class-header"},Js={class:"class-name"},Ks={class:"member-count"},Os={key:0,class:"class-desc"},Qs={class:"class-footer"},Xs={class:"class-date"},Ys={key:3,class:"empty-state edamame-glass"},Zs={key:0},se={key:1},ee={class:"page-header"},te={class:"header-with-back"},ae={class:"page-title"},le={class:"page-subtitle"},ne={key:0,class:"header-actions"},ie={key:0,class:"tabs"},oe={key:1,class:"tab-content"},ce={class:"section-header"},de={key:0,class:"empty-members edamame-glass"},ue={key:1,class:"members-list"},re={class:"member-info"},ve={class:"member-details"},_e={class:"member-name"},me={class:"member-email"},pe={class:"member-actions"},he=["onClick"],ye={key:2,class:"tab-content"},ge={key:0,class:"loading"},fe={key:1,class:"empty-assignments edamame-glass"},ke={key:2,class:"assignments-list"},be=["onClick"],Ce={class:"assignment-info"},Se={class:"assignment-title"},we={class:"assignment-meta"},Te={class:"assignment-date"},Ae={key:0,class:"assignment-stats"},xe={class:"stat-item"},$e={class:"stat-value"},Me={class:"stat-label"},ze={key:0,class:"stat-item"},De={class:"stat-value"},Pe={key:1,class:"stat-empty"},Le={class:"assignment-actions"},Ne={key:0,class:"completed-badge"},Ve=["onClick"],Ie=["onClick"],Ue={key:3,class:"tab-content"},Ee={key:0,class:"loading"},Be={key:1,class:"empty-progress edamame-glass"},qe={key:2,class:"progress-list"},Fe={class:"col-rank"},We={key:0,class:"rank-badge gold"},Re={key:1,class:"rank-badge silver"},je={key:2,class:"rank-badge bronze"},Ge={key:3,class:"rank-number"},He={class:"col-student"},Je={class:"student-avatar"},Ke={class:"student-info"},Oe={class:"student-name"},Qe={class:"student-email"},Xe={class:"col-level"},Ye={class:"level-badge"},Ze={class:"col-beans"},st={class:"col-exp"},et={class:"col-practice"},tt={class:"col-accuracy"},at={class:"col-streak"},lt={key:0,class:"streak-badge"},nt={key:1,class:"streak-empty"},it={class:"modal-content edamame-glass"},ot={key:0,class:"add-students-error"},ct={key:1,class:"add-students-success"},dt={class:"modal-actions"},ut=["disabled"],rt={class:"modal-content modal-large edamame-glass"},vt={class:"modal-header"},_t={class:"source-tabs"},mt={key:0,class:"category-filter"},pt=["onClick"],ht={class:"text-list-container"},yt={class:"text-list-header"},gt={class:"text-count"},ft={class:"text-list-actions"},kt={key:0,class:"empty-text-list"},bt={key:0},Ct={key:1},St={key:1,class:"text-list"},wt=["onClick"],Tt={class:"text-checkbox"},At={key:0,class:"check-icon"},xt={class:"text-info"},$t={class:"text-title"},Mt={class:"text-author"},zt={class:"text-meta"},Dt={key:1,class:"form-group"},Pt={key:2,class:"selection-summary"},Lt={class:"modal-actions"},Nt=["disabled"],Vt={class:"modal-content modal-large edamame-glass"},It={class:"modal-header"},Ut={key:0,class:"loading"},Et={class:"detail-stats"},Bt={class:"stat-card"},qt={class:"stat-number"},Ft={class:"stat-card"},Wt={class:"stat-number"},Rt={class:"stat-card"},jt={class:"stat-number"},Gt={class:"detail-section"},Ht={key:0,class:"empty-section"},Jt={key:1,class:"completion-list"},Kt={class:"completion-student"},Ot={class:"mini-avatar"},Qt={class:"completion-name"},Xt={class:"completion-stats"},Yt={key:0,class:"completion-accuracy"},Zt={class:"completion-time"},sa={class:"detail-section"},ea={key:0,class:"empty-section complete-msg"},ta={key:1,class:"incomplete-list"},aa={class:"mini-avatar pending"},la={class:"incomplete-name"},na=Ts({__name:"MyClassesPage",setup(ia){const d=As(),h=Ds(),m=Ps(),J=Ls(),K=Ns(),os=Ms(),{classes:ss,classMembers:N,pendingStudents:cs,studentProgress:es,loading:ts}=is(h),{assignments:O,completions:k,loading:ds}=is(m),V=u("list"),r=u(null),y=u("members"),M=u(!1),T=u(""),I=u(""),U=u(!1),E=u(!1),A=u(""),B=u(!1),z=u(null),D=u(null),S=u(!1),v=u(new Set),q=u(""),F=u(!1),b=u("system"),f=u(null),us=x(()=>K.state.categories.filter(n=>n.level===1)),as=x(()=>J.texts.filter(n=>n.is_system===!0)),rs=x(()=>J.texts.filter(n=>n.is_system===!1&&n.created_by===d.user?.id)),w=x(()=>{if(b.value==="custom")return rs.value;if(!f.value)return as.value;const n=new Set([f.value]),t=e=>{K.state.categories.filter(_=>_.parent_id===e).forEach(_=>{n.add(_.id),t(_.id)})};return t(f.value),as.value.filter(e=>e.category_id&&n.has(e.category_id))});function vs(n){const t=new Set(v.value);t.has(n)?t.delete(n):t.add(n),v.value=t}function _s(){v.value.size===w.value.length?v.value=new Set:v.value=new Set(w.value.map(n=>n.id))}function ms(){v.value=new Set}function W(){v.value=new Set,q.value="",b.value="system",f.value=null}const Q=u(!1),P=u(null),X=u(!1),Y=x(()=>{const n=N.value.map(e=>({id:e.id,email:e.student?.email||"æœªçŸ¥",displayName:e.student?.display_name||e.student?.email?.split("@")[0]||"æœªçŸ¥",status:"active",addedAt:e.added_at,student_id:e.student_id})),t=cs.value.map(e=>({id:e.id,email:e.email,displayName:e.email.split("@")[0]||"æœªçŸ¥",status:"pending",addedAt:e.added_at,student_id:void 0}));return[...n,...t].sort((e,_)=>new Date(_.addedAt).getTime()-new Date(e.addedAt).getTime())});async function ps(){if(T.value.trim()){U.value=!0;try{await h.createClass(T.value.trim(),I.value.trim()),T.value="",I.value="",M.value=!1}catch(n){console.error("å‰µå»ºç­ç´šå¤±æ•—:",n)}finally{U.value=!1}}}const Z=u(new Map);async function hs(n){if(r.value=n,V.value="detail",y.value=d.isTeacher?"members":"assignments",d.isTeacher){await Promise.all([h.fetchClassMembers(n.id),h.fetchPendingStudents(n.id),m.fetchClassAssignments(n.id)]);const t=N.value.length;await m.fetchAssignmentStats(n.id,t)}else if(await m.fetchClassAssignments(n.id),d.isStudent)for(const t of O.value){const e=await m.checkAssignmentCompletion(t.id);Z.value.set(t.id,e)}}async function ys(n){P.value=n,Q.value=!0,X.value=!0;try{await m.fetchAssignmentCompletions(n.id)}finally{X.value=!1}}function ls(){Q.value=!1,P.value=null}function L(n){return m.getAssignmentStats(n)}const R=x(()=>{if(!P.value)return[];const n=new Set(k.value.map(t=>t.student_id));return N.value.filter(t=>!n.has(t.student_id)).map(t=>({id:t.student_id,display_name:t.student?.display_name||t.student?.email?.split("@")[0]||"æœªçŸ¥",email:t.student?.email||""}))});function gs(){V.value="list",r.value=null}async function fs(){y.value="progress",r.value&&await h.fetchStudentProgress(r.value.id)}async function ks(){if(!(!r.value||!A.value.trim())){B.value=!0,z.value=null,D.value=null;try{const n=await h.batchAddStudents(r.value.id,A.value);let t=`æˆåŠŸæ·»åŠ  ${n.added} åå­¸ç”Ÿ`;n.duplicates>0&&(t+=`ï¼Œ${n.duplicates} å€‹éƒµç®±å·²åœ¨ç­ç´šä¸­`),n.invalidEmails>0&&(t+=`ï¼Œ${n.invalidEmails} å€‹ç„¡æ•ˆéƒµç®±ï¼ˆéœ€ä½¿ç”¨ @student.isf.edu.hk æ ¼å¼ï¼‰`),D.value=t,await h.fetchPendingStudents(r.value.id),await h.fetchClassMembers(r.value.id),n.invalidEmails===0&&(A.value="")}catch(n){console.error("æ‰¹é‡æ·»åŠ å¤±æ•—:",n),z.value=n.message}finally{B.value=!1}}}function ns(){E.value=!1,z.value=null,D.value=null}async function bs(n){if(!r.value)return;const t=n.status==="pending"?"ç¢ºå®šè¦ç§»é™¤é€™å€‹å¾…æ¿€æ´»çš„å­¸ç”Ÿå—ï¼Ÿ":"ç¢ºå®šè¦å°‡æ­¤å­¸ç”Ÿå¾ç­ç´šä¸­ç§»é™¤å—ï¼Ÿ";confirm(t)&&(n.status==="pending"?await h.removePendingStudent(n.id):n.student_id&&await h.removeStudent(r.value.id,n.student_id))}async function Cs(){if(!(!r.value||v.value.size===0)){F.value=!0;try{const n=Array.from(v.value);for(const e of n)await m.createAssignment(r.value.id,e,n.length===1&&q.value||void 0);W(),S.value=!1,await m.fetchClassAssignments(r.value.id);const t=N.value.length;await m.fetchAssignmentStats(r.value.id,t)}catch(n){console.error("å¸ƒç½®ä½œæ¥­å¤±æ•—:",n)}finally{F.value=!1}}}async function Ss(n){confirm("ç¢ºå®šè¦åˆªé™¤é€™å€‹ä½œæ¥­å—ï¼Ÿ")&&(await m.deleteAssignment(n),r.value&&await m.fetchClassAssignments(r.value.id))}function ws(n){os.push({name:"practice",query:{textId:n.text_id,assignmentId:n.id}})}return xs(async()=>{d.isAuthenticated&&(d.isTeacher?await Promise.all([h.fetchMyClasses(),J.fetchTexts(),K.fetchLibrary()]):await Promise.all([h.fetchStudentClasses(),m.fetchStudentAssignments()]))}),(n,t)=>(l(),a("main",Vs,[V.value==="list"?(l(),a(p,{key:0},[s("header",Is,[s("div",null,[t[20]||(t[20]=s("h1",{class:"page-title"},"æˆ‘çš„ç­ç´š",-1)),s("p",Us,i(o(d).isTeacher?"å‰µå»ºå’Œç®¡ç†ä½ çš„ç­ç´š":"æŸ¥çœ‹ç­ç´šå’Œä½œæ¥­"),1)]),o(d).isTeacher?(l(),a("button",{key:0,class:"create-btn",onClick:t[0]||(t[0]=e=>M.value=!0)}," + æ–°å»ºç­ç´š ")):c("",!0)]),M.value&&o(d).isTeacher?(l(),a("section",Es,[t[23]||(t[23]=s("h2",null,"æ–°å»ºç­ç´š",-1)),s("div",Bs,[t[21]||(t[21]=s("label",null,"ç­ç´šåç¨± *",-1)),j(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>T.value=e),type:"text",placeholder:"ä¾‹å¦‚ï¼šä¸ƒå¹´ç´šAç­",class:"form-input"},null,512),[[G,T.value]])]),s("div",qs,[t[22]||(t[22]=s("label",null,"ç­ç´šæè¿°",-1)),j(s("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>I.value=e),placeholder:"é¸å¡«ï¼Œç°¡å–®æè¿°é€™å€‹ç­ç´š",class:"form-textarea",rows:"2"},null,512),[[G,I.value]])]),s("div",Fs,[s("button",{class:"cancel-btn",onClick:t[3]||(t[3]=e=>M.value=!1)},"å–æ¶ˆ"),s("button",{class:"submit-btn",onClick:ps,disabled:!T.value.trim()||U.value},i(U.value?"å‰µå»ºä¸­...":"å‰µå»ºç­ç´š"),9,Ws)])])):c("",!0),o(ts)?(l(),a("div",Rs,"è¼‰å…¥ä¸­...")):o(ss).length>0?(l(),a("section",js,[(l(!0),a(p,null,C(o(ss),e=>(l(),a("article",{key:e.id,class:"class-card edamame-glass",onClick:_=>hs(e)},[s("div",Hs,[s("h3",Js,i(e.class_name),1),s("span",Ks,i(o(d).isTeacher?`${e.member_count||0} åå­¸ç”Ÿ`:"æŸ¥çœ‹ä½œæ¥­"),1)]),e.description?(l(),a("p",Os,i(e.description),1)):c("",!0),s("div",Qs,[s("span",Xs,i(o(d).isTeacher?"å‰µå»ºæ–¼":"åŠ å…¥æ–¼")+" "+i(new Date(e.created_at).toLocaleDateString("zh-TW")),1)])],8,Gs))),128))])):(l(),a("section",Ys,[t[24]||(t[24]=s("div",{class:"empty-icon"},"ğŸ“š",-1)),s("h2",null,i(o(d).isTeacher?"é‚„æ²’æœ‰ç­ç´š":"é‚„æ²’æœ‰åŠ å…¥ä»»ä½•ç­ç´š"),1),o(d).isTeacher?(l(),a("p",Zs," é»æ“Šã€Œæ–°å»ºç­ç´šã€é–‹å§‹å‰µå»ºä½ çš„ç¬¬ä¸€å€‹ç­ç´š ")):(l(),a("p",se," ç­‰å¾…è€å¸«å°‡ä½ æ·»åŠ åˆ°ç­ç´šä¸­ ")),o(d).isTeacher?(l(),a("button",{key:2,class:"create-btn",onClick:t[4]||(t[4]=e=>M.value=!0)}," + æ–°å»ºç­ç´š ")):c("",!0)]))],64)):V.value==="detail"&&r.value?(l(),a(p,{key:1},[s("header",ee,[s("div",te,[s("button",{class:"back-btn",onClick:gs},"â† è¿”å›"),s("div",null,[s("h1",ae,i(r.value.class_name),1),s("p",le,i(r.value.description||""),1)])]),o(d).isTeacher?(l(),a("div",ne,[y.value==="assignments"?(l(),a("button",{key:0,class:"create-btn",onClick:t[5]||(t[5]=e=>S.value=!0)}," + å¸ƒç½®ä½œæ¥­ ")):c("",!0),y.value==="members"?(l(),a("button",{key:1,class:"create-btn",onClick:t[6]||(t[6]=e=>E.value=!0)}," + æ·»åŠ å­¸ç”Ÿ ")):c("",!0),s("button",{class:"game-btn",onClick:t[7]||(t[7]=e=>n.$router.push({name:"arena-teacher-create",query:{classId:r.value?.id}}))}," âš”ï¸ ç™¼èµ·æ¯”è³½ ")])):c("",!0)]),o(d).isTeacher?(l(),a("div",ie,[s("button",{class:g(["tab-btn",{active:y.value==="members"}]),onClick:t[8]||(t[8]=e=>y.value="members")}," æˆå“¡ ",2),s("button",{class:g(["tab-btn",{active:y.value==="assignments"}]),onClick:t[9]||(t[9]=e=>y.value="assignments")}," ä½œæ¥­ ",2),s("button",{class:g(["tab-btn",{active:y.value==="progress"}]),onClick:fs}," é€²åº¦ ",2)])):c("",!0),o(d).isTeacher&&y.value==="members"?(l(),a("section",oe,[s("div",ce,[s("h2",null,"ç­ç´šæˆå“¡ ("+i(Y.value.length)+")",1)]),Y.value.length===0?(l(),a("div",de,[t[25]||(t[25]=s("p",null,"ç­ç´šä¸­é‚„æ²’æœ‰å­¸ç”Ÿ",-1)),s("button",{class:"create-btn",onClick:t[10]||(t[10]=e=>E.value=!0)}," + æ·»åŠ å­¸ç”Ÿ ")])):(l(),a("div",ue,[(l(!0),a(p,null,C(Y.value,e=>(l(),a("div",{key:e.id,class:"member-card edamame-glass"},[s("div",re,[s("div",{class:g(["member-avatar",{pending:e.status==="pending"}])},i((e.displayName||"?").charAt(0).toUpperCase()),3),s("div",ve,[s("p",_e,i(e.displayName||"æœªçŸ¥"),1),s("p",me,i(e.email),1)])]),s("div",pe,[s("span",{class:g(["status-badge",e.status==="pending"?"pending":"active"])},i(e.status==="pending"?"å¾…æ¿€æ´»":"å·²æ¿€æ´»"),3),s("button",{class:"remove-btn",onClick:_=>bs(e),title:"ç§»é™¤"}," âœ• ",8,he)])]))),128))]))])):c("",!0),y.value==="assignments"?(l(),a("section",ye,[o(ds)?(l(),a("div",ge,"è¼‰å…¥ä¸­...")):o(O).length===0?(l(),a("div",fe,[s("p",null,i(o(d).isTeacher?"é‚„æ²’æœ‰å¸ƒç½®ä½œæ¥­":"é‚„æ²’æœ‰ä½œæ¥­"),1),o(d).isTeacher?(l(),a("button",{key:0,class:"create-btn",onClick:t[11]||(t[11]=e=>S.value=!0)}," + å¸ƒç½®ä½œæ¥­ ")):c("",!0)])):(l(),a("div",ke,[(l(!0),a(p,null,C(o(O),e=>(l(),a("div",{key:e.id,class:g(["assignment-card edamame-glass",{clickable:o(d).isTeacher}]),onClick:_=>o(d).isTeacher?ys(e):void 0},[s("div",Ce,[s("h3",Se,i(e.title||e.text?.title||"æœªå‘½åä½œæ¥­"),1),s("p",we,i(e.text?.author||"ä½šå")+" Â· é›£åº¦ï¼š"+i(e.text?.difficulty===1?"åˆç´š":e.text?.difficulty===2?"ä¸­ç´š":"é«˜ç´š"),1),s("p",Te," å¸ƒç½®æ–¼ "+i(new Date(e.assigned_at).toLocaleDateString("zh-TW")),1),o(d).isTeacher?(l(),a("div",Ae,[L(e.id)?(l(),a(p,{key:0},[s("span",xe,[s("span",$e,i(L(e.id)?.completed_count||0),1),s("span",Me,"/"+i(L(e.id)?.total_students||0)+" å®Œæˆ",1)]),L(e.id)?.average_accuracy!==null?(l(),a("span",ze,[t[26]||(t[26]=s("span",{class:"stat-label"},"å¹³å‡æ­£ç¢ºç‡",-1)),s("span",De,i(L(e.id)?.average_accuracy)+"%",1)])):c("",!0)],64)):(l(),a("span",Pe,"æš«ç„¡æ•¸æ“š"))])):c("",!0)]),s("div",Le,[o(d).isStudent&&Z.value.get(e.id)?(l(),a("span",Ne," å·²å®Œæˆ ")):c("",!0),o(d).isStudent&&!Z.value.get(e.id)?(l(),a("button",{key:1,class:"start-btn",onClick:_=>ws(e)}," é–‹å§‹ä½œæ¥­ ",8,Ve)):c("",!0),o(d).isTeacher?(l(),a("button",{key:2,class:"delete-btn",onClick:H(_=>Ss(e.id),["stop"])}," åˆªé™¤ ",8,Ie)):c("",!0)])],10,be))),128))]))])):c("",!0),o(d).isTeacher&&y.value==="progress"?(l(),a("section",Ue,[o(ts)?(l(),a("div",Ee,"è¼‰å…¥ä¸­...")):o(es).length===0?(l(),a("div",Be,[...t[27]||(t[27]=[s("p",null,"ç­ç´šä¸­é‚„æ²’æœ‰å­¸ç”Ÿæ•¸æ“š",-1)])])):(l(),a("div",qe,[t[28]||(t[28]=$s('<div class="progress-header" data-v-a1a070bc><span class="col-rank" data-v-a1a070bc>#</span><span class="col-student" data-v-a1a070bc>å­¸ç”Ÿ</span><span class="col-level" data-v-a1a070bc>ç­‰ç´š</span><span class="col-beans" data-v-a1a070bc>ğŸ«˜ è±†å­</span><span class="col-exp" data-v-a1a070bc>ç¶“é©—</span><span class="col-practice" data-v-a1a070bc>ç·´ç¿’æ¬¡æ•¸</span><span class="col-accuracy" data-v-a1a070bc>æ­£ç¢ºç‡</span><span class="col-streak" data-v-a1a070bc>é€£çºŒå¤©æ•¸</span></div>',1)),(l(!0),a(p,null,C(o(es),(e,_)=>(l(),a("div",{key:e.student_id,class:"progress-row edamame-glass"},[s("span",Fe,[_===0?(l(),a("span",We,"ğŸ¥‡")):_===1?(l(),a("span",Re,"ğŸ¥ˆ")):_===2?(l(),a("span",je,"ğŸ¥‰")):(l(),a("span",Ge,i(_+1),1))]),s("span",He,[s("div",Je,i((e.display_name||"?").charAt(0).toUpperCase()),1),s("div",Ke,[s("span",Oe,i(e.display_name),1),s("span",Qe,i(e.email),1)])]),s("span",Xe,[s("span",Ye,"Lv."+i(e.level),1)]),s("span",Ze,i(e.beans),1),s("span",st,i(e.total_exp),1),s("span",et,i(e.total_practices),1),s("span",tt,i(e.total_practices>0?Math.round(e.correct_count/e.total_practices*100):0)+"% ",1),s("span",at,[e.streak_days>0?(l(),a("span",lt," ğŸ”¥ "+i(e.streak_days)+"å¤© ",1)):(l(),a("span",nt,"-"))])]))),128))]))])):c("",!0)],64)):c("",!0),E.value?(l(),a("div",{key:2,class:"modal-overlay",onClick:H(ns,["self"])},[s("div",it,[t[29]||(t[29]=s("h2",null,"æ‰¹é‡æ·»åŠ å­¸ç”Ÿ",-1)),t[30]||(t[30]=s("p",{class:"modal-hint"},[$(" è«‹è¼¸å…¥å­¸ç”Ÿéƒµç®±åœ°å€ï¼Œæ¯è¡Œä¸€å€‹æˆ–ç”¨é€—è™Ÿ/åˆ†è™Ÿåˆ†éš”ã€‚åƒ…æ”¯æŒ "),s("code",null,"xxxx@student.isf.edu.hk"),$(" æ ¼å¼ã€‚ ")],-1)),z.value?(l(),a("div",ot," âŒ "+i(z.value),1)):c("",!0),D.value?(l(),a("div",ct," âœ… "+i(D.value),1)):c("",!0),j(s("textarea",{"onUpdate:modelValue":t[12]||(t[12]=e=>A.value=e),placeholder:`ä¾‹å¦‚ï¼š
student1@student.isf.edu.hk
student2@student.isf.edu.hk`,class:"form-textarea",rows:"10"},null,512),[[G,A.value]]),s("div",dt,[s("button",{class:"cancel-btn",onClick:ns},"å–æ¶ˆ"),s("button",{class:"submit-btn",onClick:ks,disabled:!A.value.trim()||B.value},i(B.value?"æ·»åŠ ä¸­...":"æ·»åŠ å­¸ç”Ÿ"),9,ut)])])])):c("",!0),S.value?(l(),a("div",{key:3,class:"modal-overlay",onClick:t[19]||(t[19]=H(e=>{S.value=!1,W()},["self"]))},[s("div",rt,[s("div",vt,[t[31]||(t[31]=s("h2",null,"å¸ƒç½®ä½œæ¥­",-1)),s("button",{class:"close-btn",onClick:t[13]||(t[13]=e=>{S.value=!1,W()})},"âœ•")]),s("div",_t,[s("button",{class:g(["source-tab",{active:b.value==="system"}]),onClick:t[14]||(t[14]=e=>{b.value="system",f.value=null})}," ğŸ“š ç³»çµ±æ–‡åº« ",2),s("button",{class:g(["source-tab",{active:b.value==="custom"}]),onClick:t[15]||(t[15]=e=>{b.value="custom",f.value=null})}," âœï¸ è‡ªè¨‚ç·´ç¿’ ",2)]),b.value==="system"?(l(),a("div",mt,[s("button",{class:g(["category-chip",{active:!f.value}]),onClick:t[16]||(t[16]=e=>f.value=null)}," å…¨éƒ¨ ",2),(l(!0),a(p,null,C(us.value,e=>(l(),a("button",{key:e.id,class:g(["category-chip",{active:f.value===e.id}]),onClick:_=>f.value=e.id},i(e.name),11,pt))),128))])):c("",!0),s("div",ht,[s("div",yt,[s("span",gt,[$(i(w.value.length)+" ç¯‡æ–‡ç«  ",1),v.value.size>0?(l(),a(p,{key:0},[$(" Â· å·²é¸ "+i(v.value.size)+" ç¯‡ ",1)],64)):c("",!0)]),s("div",ft,[w.value.length>0?(l(),a("button",{key:0,class:"text-action-btn",onClick:_s},i(v.value.size===w.value.length?"å–æ¶ˆå…¨é¸":"å…¨é¸"),1)):c("",!0),v.value.size>0?(l(),a("button",{key:1,class:"text-action-btn",onClick:ms}," æ¸…ç©º ")):c("",!0)])]),w.value.length===0?(l(),a("div",kt,[b.value==="custom"?(l(),a("p",bt,"é‚„æ²’æœ‰è‡ªè¨‚ç·´ç¿’æ–‡ç« ")):(l(),a("p",Ct,"æ­¤åˆ†é¡ä¸‹æ²’æœ‰æ–‡ç« "))])):(l(),a("div",St,[(l(!0),a(p,null,C(w.value,e=>(l(),a("div",{key:e.id,class:g(["text-item",{selected:v.value.has(e.id)}]),onClick:_=>vs(e.id)},[s("div",Tt,[v.value.has(e.id)?(l(),a("span",At,"âœ“")):c("",!0)]),s("div",xt,[s("span",$t,i(e.title),1),s("span",Mt,i(e.author||"ä½šå"),1)]),s("div",zt,[s("span",{class:g(["difficulty-badge","diff-"+e.difficulty])},i(e.difficulty===1?"åˆç´š":e.difficulty===2?"ä¸­ç´š":"é«˜ç´š"),3)])],10,wt))),128))]))]),v.value.size===1?(l(),a("div",Dt,[t[32]||(t[32]=s("label",null,"ä½œæ¥­æ¨™é¡Œï¼ˆå¯é¸ï¼‰",-1)),j(s("input",{"onUpdate:modelValue":t[17]||(t[17]=e=>q.value=e),type:"text",placeholder:"ä¾‹å¦‚ï¼šé€±æœ«ç·´ç¿’",class:"form-input"},null,512),[[G,q.value]])])):c("",!0),v.value.size>0?(l(),a("div",Pt,[t[33]||(t[33]=$(" å°‡å¸ƒç½® ",-1)),s("strong",null,i(v.value.size),1),t[34]||(t[34]=$(" å€‹ç·´ç¿’ä½œæ¥­çµ¦ç­ç´šå­¸ç”Ÿ ",-1))])):c("",!0),s("div",Lt,[s("button",{class:"cancel-btn",onClick:t[18]||(t[18]=e=>{S.value=!1,W()})},"å–æ¶ˆ"),s("button",{class:"submit-btn",onClick:Cs,disabled:v.value.size===0||F.value},i(F.value?"å¸ƒç½®ä¸­...":`å¸ƒç½® ${v.value.size} å€‹ä½œæ¥­`),9,Nt)])])])):c("",!0),Q.value?(l(),a("div",{key:4,class:"modal-overlay",onClick:H(ls,["self"])},[s("div",Vt,[s("div",It,[s("h2",null,i(P.value?.title||P.value?.text?.title||"ä½œæ¥­è©³æƒ…"),1),s("button",{class:"close-btn",onClick:ls},"âœ•")]),X.value?(l(),a("div",Ut,"è¼‰å…¥ä¸­...")):(l(),a(p,{key:1},[s("div",Et,[s("div",Bt,[s("span",qt,i(o(k).length),1),t[35]||(t[35]=s("span",{class:"stat-desc"},"å·²å®Œæˆ",-1))]),s("div",Ft,[s("span",Wt,i(R.value.length),1),t[36]||(t[36]=s("span",{class:"stat-desc"},"æœªå®Œæˆ",-1))]),s("div",Rt,[s("span",jt,i(o(k).length>0?Math.round(o(k).reduce((e,_)=>e+(_.accuracy||0),0)/o(k).length):0)+"% ",1),t[37]||(t[37]=s("span",{class:"stat-desc"},"å¹³å‡æ­£ç¢ºç‡",-1))])]),s("div",Gt,[s("h3",null,"å·²å®Œæˆ ("+i(o(k).length)+")",1),o(k).length===0?(l(),a("div",Ht," é‚„æ²’æœ‰å­¸ç”Ÿå®Œæˆæ­¤ä½œæ¥­ ")):(l(),a("div",Jt,[(l(!0),a(p,null,C(o(k),e=>(l(),a("div",{key:e.id,class:"completion-item"},[s("div",Kt,[s("div",Ot,i((e.student?.display_name||"?").charAt(0).toUpperCase()),1),s("span",Qt,i(e.student?.display_name||e.student?.email?.split("@")[0]||"æœªçŸ¥"),1)]),s("div",Xt,[e.accuracy!==null?(l(),a("span",Yt," æ­£ç¢ºç‡: "+i(e.accuracy)+"% ",1)):c("",!0),s("span",Zt,i(new Date(e.completed_at).toLocaleString("zh-TW")),1)])]))),128))]))]),s("div",sa,[s("h3",null,"æœªå®Œæˆ ("+i(R.value.length)+")",1),R.value.length===0?(l(),a("div",ea," ğŸ‰ æ‰€æœ‰å­¸ç”Ÿéƒ½å·²å®Œæˆï¼ ")):(l(),a("div",ta,[(l(!0),a(p,null,C(R.value,e=>(l(),a("div",{key:e.id,class:"incomplete-item"},[s("div",aa,i((e.display_name||"?").charAt(0).toUpperCase()),1),s("span",la,i(e.display_name),1)]))),128))]))])],64))])])):c("",!0)]))}}),va=zs(na,[["__scopeId","data-v-a1a070bc"]]);export{va as default};
