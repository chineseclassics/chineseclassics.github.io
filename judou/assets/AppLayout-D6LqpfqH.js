import{d as F,c,a as n,n as G,b as y,e as C,o as t,_ as H,u as se,r as S,w as T,f as te,g as e,h as p,i as z,t as r,F as v,j as f,k as ae,l as ne,m as g,p as I,q as P,s as R,v as le}from"./index-Jcla3pSS.js";import{u as ie}from"./userStatsStore-CzR-l0I_.js";import{u as oe}from"./assignmentStore-B_uOAbPh.js";import{u as W}from"./avatarStore-CtgGydcO.js";import{B as D}from"./BeanIcon-Hope0cNP.js";import"./useSupabase-Dzb3yNyS.js";const re=["src","alt"],ce={key:1,class:"avatar-fallback"},de=F({__name:"UserAvatar",props:{size:{default:40},src:{default:void 0},alt:{default:"ç”¨æˆ¶é ­åƒ"},clickable:{type:Boolean,default:!1}},emits:["click"],setup(m,{emit:l}){const i=m,u=l,b=W(),k=c(()=>i.src!==void 0?i.src:b.currentAvatarUrl),N=c(()=>{const d=typeof i.size=="number"?`${i.size}px`:i.size;return{width:d,height:d,minWidth:d,minHeight:d}}),B=c(()=>{const d=typeof i.size=="number"?i.size:parseInt(i.size);return Math.round(d*.5)});function w(){i.clickable&&u("click")}return(d,x)=>(t(),n("div",{class:y(["user-avatar",{clickable:m.clickable}]),style:G(N.value),onClick:w},[k.value?(t(),n("img",{key:0,src:k.value,alt:m.alt,class:"avatar-img"},null,8,re)):(t(),n("div",ce,[C(D,{size:B.value},null,8,["size"])]))],6))}}),ue=H(de,[["__scopeId","data-v-8f62ee97"]]),ve={class:"sidebar-shell edamame-glass"},pe={class:"brand-avatar"},me={class:"level-badge"},be={class:"brand-info"},_e={class:"beans-roller"},he={key:0,class:"secondary-stats"},fe={class:"streak-display"},ge={key:1,class:"login-section"},ye={class:"sidebar-section"},ke={key:0,class:"item-icon"},Ae={class:"item-title"},Se={key:0,class:"badge"},ze={key:1,class:"edamame-sidebar-item disabled"},Ce={key:0,class:"item-icon"},Ne={class:"item-title"},Be={key:2,class:"sidebar-section"},we={class:"item-title"},xe={key:1,class:"edamame-sidebar-item disabled"},$e={class:"item-title"},Me={key:3,class:"sidebar-section super-admin-section"},Ue={class:"item-title"},Ie={key:1,class:"edamame-sidebar-item disabled"},Pe={class:"item-title"},j="bean",je=F({__name:"SidebarMenu",setup(m){const l=se(),i=ie(),u=oe(),b=W(),k=ne(),N=[{label:"é¦–é ",icon:"ðŸ ",to:{name:"home"}},{label:"å¥è±†",icon:j,to:{name:"practice"},description:"ç·´ç¿’"},{label:"å“è±†",icon:"ðŸ“–",to:{name:"reading-list"},description:"é–±è®€"},{label:"é¬¥è±†",icon:"âš”ï¸",to:{name:"arena"},description:"å°æˆ°"},{label:"è±†è·¡",icon:"ðŸ‘£",to:{name:"history"},description:"æ­·å²"},{label:"è±†èŽ¢",icon:"ðŸ«›",to:{name:"my-classes"},description:"ç­ç´š"},{label:"è‡ªè¨‚ç·´ç¿’",icon:"âœï¸",to:{name:"my-texts"},teacherOnly:!0}],B=[{label:"ç·´ç¿’æ–‡åº«",to:{name:"admin-texts"}},{label:"é–±è®€æ–‡åº«",to:{name:"admin-reading"}}],w=[{label:"ç”¨æˆ¶ç®¡ç†",to:{name:"admin-users"}}],d=c(()=>N.filter(o=>!o.teacherOnly||l.isTeacher)),x=c(()=>!l.isAuthenticated||!l.isAdmin?[]:B),L=c(()=>!l.isAuthenticated||!l.isSuperAdmin?[]:w),q=le(),$=o=>o.to?q.name===o.to.name:!1,V=c(()=>l.isAuthenticated?l.displayName||"è±†å‹":"è¨ªå®¢"),Y=c(()=>i.profile?.total_beans??0),J=c(()=>i.level),E=c(()=>i.profile?.streak_days??0),M=S(0),U=S(!1),A=S(null),K=c(()=>M.value.toString().split("").map(a=>parseInt(a)));T(Y,(o,a)=>{if(a===void 0||a===0){M.value=o;return}if(o===a)return;const h=o-a;A.value=h>0?"up":"down",U.value=!0,M.value=o,setTimeout(()=>{U.value=!1,A.value=null},800)},{immediate:!0});async function Q(){await l.loginWithGoogle()}function X(){k.push({name:"profile"})}const _=S(0);T(()=>l.isAuthenticated,o=>{o?(console.log("[Sidebar] ç”¨æˆ¶å·²ç™»å…¥ï¼Œè¼‰å…¥ Profile å’Œé ­åƒ"),i.fetchProfile(),b.initialize(),l.isStudent&&u.fetchStudentAssignments().then(()=>{u.getPendingCount().then(a=>{_.value=a})})):(_.value=0,b.reset())},{immediate:!0}),te(()=>{l.isAuthenticated&&l.isStudent&&u.fetchStudentAssignments().then(()=>{u.getPendingCount().then(o=>{_.value=o})})});const Z="/judou/images/judou-logo.jpg";return(o,a)=>{const h=R("router-link");return t(),n("aside",ve,[z(l).isAuthenticated?(t(),n("div",{key:0,class:"sidebar-brand",onClick:X},[e("div",pe,[C(ue,{src:z(b).currentAvatarUrl||z(l).avatarUrl,size:52,alt:V.value},null,8,["src","alt"]),e("div",me,r(J.value),1)]),e("div",be,[e("div",{class:y(["beans-card",{"beans-animating":U.value,"beans-up":A.value==="up","beans-down":A.value==="down"}])},[a[0]||(a[0]=e("div",{class:"beans-icon"},[e("span",{class:"bean-pod"},"ðŸ«›")],-1)),e("div",_e,[(t(!0),n(v,null,f(K.value,(s,ee)=>(t(),n("div",{key:ee,class:"digit-slot"},[e("div",{class:"digit-roller",style:G({transform:`translateY(-${s*10}%)`})},[(t(),n(v,null,f(10,O=>e("span",{key:O,class:"digit"},r(O-1),1)),64))],4)]))),128))])],2),E.value>0?(t(),n("div",he,[e("span",fe,"ðŸ”¥ "+r(E.value)+"å¤©",1)])):p("",!0)]),a[1]||(a[1]=e("svg",{class:"arrow-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1))])):(t(),n("div",ge,[e("button",{class:"google-login-btn",onClick:Q},[...a[2]||(a[2]=[ae('<svg class="google-icon" viewBox="0 0 24 24" width="18" height="18" data-v-e5c212b6><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-e5c212b6></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-e5c212b6></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-e5c212b6></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-e5c212b6></path></svg><span data-v-e5c212b6>ä½¿ç”¨ Google ç™»å…¥</span>',2)])]),a[3]||(a[3]=e("p",{class:"login-hint"},"ç™»å…¥å¾Œå¯ä¿å­˜å­¸ç¿’é€²åº¦",-1))])),e("nav",ye,[a[4]||(a[4]=e("p",{class:"section-label"},"å¸¸ç”¨åŠŸèƒ½",-1)),e("ul",null,[(t(!0),n(v,null,f(d.value,s=>(t(),n("li",{key:s.label},[s.to&&!s.disabled?(t(),g(h,{key:0,class:y(["edamame-sidebar-item",{active:$(s)}]),to:s.to},{default:I(()=>[s.icon?(t(),n("span",ke,[s.icon===j?(t(),g(D,{key:0,size:20})):(t(),n(v,{key:1},[P(r(s.icon),1)],64))])):p("",!0),e("p",Ae,[P(r(s.label)+" ",1),s.label==="è±†èŽ¢"&&z(l).isStudent&&_.value>0?(t(),n("span",Se,r(_.value),1)):p("",!0)])]),_:2},1032,["class","to"])):(t(),n("div",ze,[s.icon?(t(),n("span",Ce,[s.icon===j?(t(),g(D,{key:0,size:20})):(t(),n(v,{key:1},[P(r(s.icon),1)],64))])):p("",!0),e("p",Ne,r(s.label),1)]))]))),128))])]),x.value.length>0?(t(),n("nav",Be,[a[5]||(a[5]=e("p",{class:"section-label"},"ç®¡ç†",-1)),e("ul",null,[(t(!0),n(v,null,f(x.value,s=>(t(),n("li",{key:s.label},[s.to&&!s.disabled?(t(),g(h,{key:0,class:y(["edamame-sidebar-item",{active:$(s)}]),to:s.to},{default:I(()=>[e("p",we,r(s.label),1)]),_:2},1032,["class","to"])):(t(),n("div",xe,[e("p",$e,r(s.label),1)]))]))),128))])])):p("",!0),L.value.length>0?(t(),n("nav",Me,[a[6]||(a[6]=e("p",{class:"section-label"},"è¶…ç´šç®¡ç†",-1)),e("ul",null,[(t(!0),n(v,null,f(L.value,s=>(t(),n("li",{key:s.label},[s.to&&!s.disabled?(t(),g(h,{key:0,class:y(["edamame-sidebar-item super-admin-item",{active:$(s)}]),to:s.to},{default:I(()=>[e("p",Ue,r(s.label),1)]),_:2},1032,["class","to"])):(t(),n("div",Ie,[e("p",Pe,r(s.label),1)]))]))),128))])])):p("",!0),e("div",{class:"sidebar-footer"},[e("div",{class:"footer-brand"},[e("img",{src:Z,alt:"å¥è±†",class:"footer-logo"}),a[7]||(a[7]=e("span",{class:"footer-title"},"å¥è±† 2.0",-1))]),a[8]||(a[8]=e("div",{class:"footer-credits"},[e("p",null,"é–‹ç™¼ï¼šæ±ªæ¶µå±¹ã€å¼µè€å¸«"),e("p",null,"ç¾Žè¡“ï¼šä¸å¥•è¾°ã€å¾æšæ´‹")],-1))])])}}}),De=H(je,[["__scopeId","data-v-e5c212b6"]]),Fe={class:"app-layout"},He={class:"app-main"},Le={class:"app-content"},Ee=F({__name:"AppLayout",setup(m){return(l,i)=>{const u=R("router-view");return t(),n("div",Fe,[C(De),e("section",He,[e("div",Le,[C(u)])])])}}}),Ve=H(Ee,[["__scopeId","data-v-a70dcd22"]]);export{Ve as default};
