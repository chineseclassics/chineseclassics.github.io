# 🎨 你畫我猜 - 初步開發計劃

> **項目定位**：教育導向的多人繪畫猜詞遊戲，支持中文概念和詩句的視覺化學習  
> **參考產品**：skribbl.io  
> **教育目標**：通過繪畫和猜測，幫助學生掌握概念名詞和詩句

---

## 📋 目錄

1. [項目概述](#項目概述)
2. [核心功能](#核心功能)
3. [教育場景](#教育場景)
4. [技術架構](#技術架構)
5. [開發階段](#開發階段)
6. [命名建議](#命名建議)

---

## 項目概述

### 核心理念

「你畫我猜」是一個**教育導向**的多人繪畫猜詞遊戲，與 skribbl.io 的娛樂性質不同，本應用專注於：

1. **中文教學**：支持繁體中文詞彙、概念名詞、詩句
2. **靈活詞庫**：房主可以選擇系統預設詞庫（管理員維護），或完全自定義詞語（像 skribbl.io）
3. **視覺化學習**：通過繪畫加深對概念和詩句的理解
4. **多人協作**：支持課堂多人同時參與，增強互動

### 與 skribbl.io 的差異

| 特性 | skribbl.io | 你畫我猜 |
|------|-----------|---------|
| **目標** | 娛樂社交 | 教育學習 |
| **詞庫** | 隨機英文單詞 | 系統預設詞庫 OR 自定義詞語 |
| **語言** | 多語言（英文為主） | 繁體中文 |
| **教育功能** | 無 | 詞庫管理、學習記錄 |
| **適用場景** | 朋友聚會 | 課堂教學 |

---

## 核心功能

### 1. 房間系統

**創建房間**：
- 房主輸入房間名稱
- **構建詞語列表**（混合模式）：
  - **從系統詞庫選擇**：
    - 瀏覽系統詞庫（按主題分類，如「文學概念詞庫」、「詩詞名句庫」）
    - 點選需要的詞語/詩句，插入到詞語列表
    - 支持多個詞庫，可以從不同詞庫中選擇
    - 可以搜索和篩選詞庫
  - **自定義輸入**：
    - 在「Custom words」輸入區即時輸入其他詞語
    - 支持多行輸入（一行一個詞語）
    - 可以隨時添加或刪除
  - **詞語列表預覽**：
    - 顯示已選中的所有詞語（來自詞庫 + 自定義）
    - 可以刪除已選中的詞語
    - 顯示詞語總數
- 設置遊戲參數：
  - 每輪繪畫時間（60-180秒）
  - 總輪數（3-10輪，不能超過詞語總數）
  - 是否顯示提示（提示數量：0-5）
- 生成房間碼（6位數字）
- 分享房間碼給其他玩家

**加入房間**：
- 輸入房間碼
- 輸入暱稱
- 進入等待大廳

**房間狀態**：
- 等待中：顯示已加入玩家列表
- 進行中：顯示當前輪次、當前畫家、倒計時
- 已結束：顯示最終排名和統計

### 2. 繪畫系統

**畫布功能**：
- Canvas 繪圖（支持鼠標和觸摸）
- 畫筆工具：
  - 畫筆（多種顏色）
  - 橡皮擦
  - 清空畫布
  - 畫筆粗細調整
- 實時同步：所有玩家看到相同的畫作進度

**繪畫限制**：
- 禁止輸入文字（純繪畫）
- 禁止複製貼上圖片
- 時間限制（倒計時顯示）

### 3. 猜詞系統

**猜詞界面**：
- 顯示畫作（實時更新）
- 輸入框（支持中文輸入）
- 提示顯示（可選，逐步顯示）
- 已猜中玩家列表
- 當前得分顯示

**計分規則**：
- 第一個猜中：100% 分數
- 第二個猜中：80% 分數
- 第三個猜中：60% 分數
- 依此類推（最低 20%）
- 畫家得分：根據猜中玩家數量計算

### 4. 詞庫系統

#### 4.1 系統預設詞庫（管理員功能）

**管理員後台**：
- 只有管理員可以訪問（通過特殊 URL 或權限檢查）
- 管理員可以創建/編輯/刪除系統預設詞庫
- 支持批量導入（CSV/JSON）
- 詞庫按主題分類（如「文學概念詞庫」、「詩詞名句庫」）

**詞庫主題示例**：
1. **文學概念詞庫**
   - 例如：「春天」、「友誼」、「勇氣」、「責任」
   - 適合：抽象概念理解

2. **詩詞名句庫**
   - 例如：「春風又綠江南岸」、「舉頭望明月」、「床前明月光」
   - 適合：詩句記憶和理解

3. **其他主題詞庫**
   - 可以根據教學需要創建更多主題詞庫
   - 如「成語庫」、「古詩詞意象庫」等

**房主使用**：
- 創建房間時，瀏覽系統詞庫（按主題分類展示）
- 點選需要的詞語/詩句，插入到詞語列表
- 可以從多個詞庫中選擇詞語
- 支持搜索和篩選功能

#### 4.2 自定義詞語輸入（房主功能）

**即時輸入模式**：
- 在「Custom words」輸入區即時輸入其他詞語
- 支持多行輸入（一行一個詞語，或逗號分隔）
- 可以隨時添加、編輯、刪除
- 與系統詞庫選擇的詞語混合在一起

**使用場景**：
- 補充系統詞庫沒有的詞語
- 添加臨時創意的詞語
- 完全自定義遊戲詞語（不選系統詞庫）

**示例輸入**：
```
春天
友誼
勇氣
春風又綠江南岸
舉頭望明月
```

**詞庫結構示例**：
```json
{
  "name": "文學概念詞庫",
  "theme": "文學概念",
  "description": "常用文學概念和抽象名詞",
  "words": [
    {
      "text": "春天",
      "hints": ["季節", "溫暖", "花開"],
      "difficulty": 1
    },
    {
      "text": "友誼",
      "hints": ["朋友", "感情", "珍貴"],
      "difficulty": 2
    }
  ]
}
```

**房間詞語列表結構**：
```json
{
  "room_id": "xxx",
  "words": [
    {
      "text": "春天",
      "source": "wordlist",  // 來自系統詞庫
      "wordlist_id": "xxx",
      "word_id": "xxx"
    },
    {
      "text": "友誼",
      "source": "wordlist",
      "wordlist_id": "xxx",
      "word_id": "xxx"
    },
    {
      "text": "臨時創意詞",
      "source": "custom"  // 自定義輸入
    }
  ]
}
```

### 5. 實時同步系統

**使用 Supabase Realtime**：
- 房間狀態同步（玩家加入/離開）
- 畫作實時同步（繪畫筆觸）
- 猜詞結果同步（誰猜中了）
- 輪次切換同步（下一輪開始）

**技術實現**：
- 參考 `story-vocab` 和 `judou` 的房間系統
- 使用 Supabase Realtime Channels
- 繪畫數據壓縮和優化（減少傳輸量）

---

## 教育場景

### 場景 1：課堂複習（混合使用系統詞庫和自定義）

**使用流程**：
1. 管理員提前創建系統詞庫（如「文學概念詞庫」、「詩詞名句庫」）
2. 課堂上，老師或學生創建房間
3. 從「文學概念詞庫」中點選插入相關概念（如「春天」、「友誼」）
4. 從「詩詞名句庫」中點選插入相關詩句（如「春風又綠江南岸」）
5. 在 Custom words 輸入區即時補充其他詞語
6. 其他學生加入房間（輸入房間碼）
7. 開始遊戲，輪流畫畫和猜詞
8. 遊戲結束後，可以查看統計（哪些詞容易猜、哪些難）

**教育價值**：
- 複習本單元概念和詩句
- 視覺化理解抽象概念
- 增強記憶和聯想

### 場景 2：詩句專題練習

**使用流程**：
1. 管理員創建「詩詞名句庫」
2. 房主創建房間，從「詩詞名句庫」中點選插入多個詩句
3. 可以補充一些相關的概念詞語（從其他詞庫或自定義）
4. 學生輪流畫詩句，其他人猜
5. 通過繪畫加深對詩句意象的理解

**教育價值**：
- 詩句記憶
- 理解詩句的視覺意象
- 培養詩意聯想能力

### 場景 3：自由創意遊戲

**使用流程**：
1. 房主創建房間
2. 完全使用 Custom words 輸入區，輸入想要玩的詞語
3. 或者從系統詞庫中選擇一些有趣的詞語，再補充自定義詞語
4. 朋友加入房間，開始遊戲
5. 輪流畫畫和猜詞

**適用場景**：
- 朋友聚會
- 課後娛樂
- 創意發揮

---

## 技術架構

### 前端技術

**核心技術**：
- HTML5 Canvas（繪畫功能）
- Vanilla JavaScript（ES6+）
- Supabase JavaScript Client（實時同步）
- Tailwind CSS（樣式）

**繪畫實現**：
- 參考 `sealdesgin.html` 的 Canvas 繪圖實現
- 支持鼠標和觸摸事件
- 繪畫數據序列化（點陣數據）
- 實時同步優化（節流處理）

### 後端架構

**Supabase 數據庫設計**：

```sql
-- 房間表
CREATE TABLE game_rooms (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  code TEXT UNIQUE NOT NULL,  -- 6位房間碼
  name TEXT NOT NULL,
  host_id UUID REFERENCES auth.users(id),
  words JSONB NOT NULL,  -- 詞語列表（混合：系統詞庫選擇 + 自定義）
  -- words 結構：[{"text": "春天", "source": "wordlist", "word_id": "xxx"}, {"text": "自定義詞", "source": "custom"}]
  status TEXT DEFAULT 'waiting',  -- waiting, playing, finished
  settings JSONB,  -- 遊戲設置（時間、輪數等）
  current_round INT DEFAULT 0,
  current_drawer_id UUID,
  created_at TIMESTAMP DEFAULT NOW()
);

-- 玩家參與表
CREATE TABLE room_participants (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  room_id UUID REFERENCES game_rooms(id),
  user_id UUID REFERENCES auth.users(id),
  nickname TEXT NOT NULL,
  score INT DEFAULT 0,
  joined_at TIMESTAMP DEFAULT NOW()
);

-- 系統詞庫表（只有管理員可以管理）
CREATE TABLE wordlists (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,  -- 詞庫名稱，如「文學概念詞庫」、「詩詞名句庫」
  description TEXT,
  theme TEXT NOT NULL,  -- 主題標籤（用於分類展示）
  is_system BOOLEAN DEFAULT TRUE,  -- 系統詞庫標記
  created_by UUID REFERENCES auth.users(id),  -- 管理員 ID
  created_at TIMESTAMP DEFAULT NOW()
);

-- 詞彙表
CREATE TABLE words (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  wordlist_id UUID REFERENCES wordlists(id),
  text TEXT NOT NULL,  -- 詞彙內容
  hints TEXT[],        -- 提示列表
  difficulty INT,      -- 難度等級
  created_at TIMESTAMP DEFAULT NOW()
);

-- 遊戲記錄表
CREATE TABLE game_rounds (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  room_id UUID REFERENCES game_rooms(id),
  round_number INT NOT NULL,
  drawer_id UUID REFERENCES auth.users(id),
  word_id UUID REFERENCES words(id),  -- NULL 表示使用自定義詞語
  word_text TEXT NOT NULL,  -- 詞語文本（必須，作為主要標識）
  word_source TEXT,  -- 'wordlist' | 'custom'
  drawing_data JSONB,  -- 繪畫數據（壓縮後）
  started_at TIMESTAMP DEFAULT NOW(),
  ended_at TIMESTAMP
);

-- 猜詞記錄表
CREATE TABLE guesses (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  round_id UUID REFERENCES game_rounds(id),
  user_id UUID REFERENCES auth.users(id),
  guess_text TEXT NOT NULL,
  is_correct BOOLEAN DEFAULT FALSE,
  score_earned INT DEFAULT 0,
  guessed_at TIMESTAMP DEFAULT NOW()
);
```

**實時同步策略**：
- 使用 Supabase Realtime Channels
- 房間狀態變化：`postgres_changes` 監聽
- 繪畫數據：`broadcast` 消息（高頻率）
- 猜詞結果：`postgres_changes` 監聽

### 文件結構

```
draw-guess/
├── index.html              # 主入口（房間列表/創建）
├── room.html              # 遊戲房間頁面
├── admin/
│   └── wordlist-manager.html  # 系統詞庫管理（管理員功能）
│
├── components/                # 可重用組件（可選）
│   └── wordlist-selector.html # 詞庫選擇器組件
│
├── js/
│   ├── config.js          # Supabase 配置
│   ├── app.js             # 應用入口
│   ├── core/
│   │   ├── room-manager.js      # 房間管理
│   │   ├── game-state.js        # 遊戲狀態
│   │   └── realtime-sync.js     # 實時同步
│   ├── features/
│   │   ├── drawing-canvas.js   # 繪畫功能
│   │   ├── guessing-system.js  # 猜詞系統
│   │   ├── scoring-system.js    # 計分系統
│   │   ├── wordlist-manager.js      # 系統詞庫管理（管理員）
│   │   ├── wordlist-selector.js     # 詞庫選擇器（房主：瀏覽和選擇詞語）
│   │   └── custom-words.js         # 自定義詞語輸入（房主）
│   └── ui/
│       ├── screens.js           # 界面顯示
│       ├── modals.js            # 彈窗管理
│       └── leaderboard.js       # 排行榜
│
├── css/
│   ├── main.css          # 主樣式
│   └── canvas.css        # 畫布樣式
│
├── assets/
│   └── images/           # 圖標、背景等
│
├── supabase/
│   ├── migrations/       # 數據庫遷移
│   └── functions/        # Edge Functions（如需要）
│
└── docs/
    ├── DEVELOPMENT_PLAN.md    # 本文檔
    └── DESIGN.md              # 詳細設計文檔（後續）
```

---

## 開發階段

### 階段 1：MVP 核心功能（2-3週）

**目標**：實現基本的你畫我猜功能

**任務清單**：
- [ ] 創建項目文件結構
- [ ] 設計數據庫架構並實施遷移
- [ ] 實現房間系統（創建/加入/離開）
- [ ] 實現基礎繪畫功能（Canvas）
- [ ] 實現猜詞系統（輸入/匹配）
- [ ] 實現基礎計分系統
- [ ] 實現實時同步（房間狀態、猜詞結果）
- [ ] 基礎 UI（房間列表、遊戲界面）

**驗收標準**：
- 可以創建房間並加入
- 可以輪流畫畫和猜詞
- 分數正確計算
- 實時同步基本正常

### 階段 2：詞庫系統（1-2週）

**目標**：實現系統詞庫管理和混合詞語選擇功能

**任務清單**：
- [ ] 管理員後台（系統詞庫管理）
  - [ ] 詞庫 CRUD 功能（創建/編輯/刪除）
  - [ ] 詞彙管理（添加/編輯/刪除）
  - [ ] 批量導入功能（CSV/JSON）
  - [ ] 詞庫主題分類
- [ ] 房主功能（創建房間時）
  - [ ] 詞庫瀏覽界面（按主題分類展示）
  - [ ] 詞語選擇器（點選插入詞語到列表）
  - [ ] 搜索和篩選功能
  - [ ] 自定義詞語輸入區（多行輸入）
  - [ ] 詞語列表預覽和管理（顯示已選詞語，可刪除）
  - [ ] 詞語驗證和去重
  - [ ] 混合詞語列表保存

**驗收標準**：
- 管理員可以管理系統預設詞庫（按主題分類）
- 房主可以從系統詞庫中點選插入詞語
- 房主可以即時輸入自定義詞語
- 系統詞庫選擇和自定義詞語可以混合使用
- 詞語列表正確保存到房間

### 階段 3：優化和增強（1-2週）

**目標**：優化體驗，增加教育功能

**任務清單**：
- [ ] 繪畫實時同步優化（節流、壓縮）
- [ ] 提示系統（逐步顯示提示）
- [ ] 遊戲統計（哪些詞容易/難猜）
- [ ] 歷史記錄（查看過往遊戲）
- [ ] 移動端優化（觸摸繪畫）
- [ ] 性能優化（減少延遲）

**驗收標準**：
- 繪畫同步流暢
- 移動端體驗良好
- 統計功能可用

### 階段 4：教育功能增強（可選）

**目標**：增加更多教育價值

**任務清單**：
- [ ] 學習報告（學生掌握情況）
- [ ] 詞彙難度分析
- [ ] 班級管理（教師管理多個班級）
- [ ] 作業功能（布置詞庫作業）

---

## 命名建議

### 當前名稱：「你畫我猜」

**優點**：
- ✅ 直白易懂
- ✅ 符合遊戲玩法
- ✅ 容易記憶

**缺點**：
- ❌ 比較普通，缺乏特色
- ❌ 沒有體現教育價值
- ❌ 與其他「你畫我猜」遊戲區分度低

### 替代命名建議

#### 1. **「畫意詩心」**
- **寓意**：通過繪畫理解詩意和概念
- **特點**：文雅，符合中文教學氛圍
- **適用**：更偏向詩句學習

#### 2. **「墨繪詞境」**
- **寓意**：用墨（繪畫）描繪詞語的意境
- **特點**：古典雅致，有文化底蘊
- **適用**：概念和詩句都適用

#### 3. **「筆繪詞庫」**
- **寓意**：用筆繪畫詞庫中的概念
- **特點**：直接說明功能
- **適用**：強調詞庫管理功能

#### 4. **「畫說詞語」**
- **寓意**：用畫來說明詞語
- **特點**：簡潔，有教育意義
- **適用**：低年級更適合

#### 5. **「視覺詞典」**
- **寓意**：通過視覺化學習詞彙
- **特點**：強調教育功能
- **適用**：更偏向學習工具

### 推薦方案

**首選**：「**墨繪詞境**」
- 文雅有文化底蘊
- 符合太虛幻境的古典氛圍
- 既適合概念也適合詩句

**次選**：「**畫意詩心**」
- 更偏向詩句學習
- 如果主要用於詩句，這個名字更貼切

**保留選項**：「**你畫我猜**」
- 如果希望更直白，保留原名也可以
- 可以加上副標題：「你畫我猜 - 視覺化學習」

---

## 權限設計

### 用戶角色

**所有人**：
- ✅ 創建房間
- ✅ 加入房間
- ✅ 選擇系統詞庫或自定義詞語
- ✅ 參與遊戲

**管理員**（只有你）：
- ✅ 管理系統預設詞庫（創建/編輯/刪除）
- ✅ 批量導入詞彙
- ✅ 管理詞庫分類和標籤

### 管理員後台訪問方式

**方案 1：特殊 URL**
- 訪問 `/draw-guess/admin/wordlist-manager.html`
- 簡單直接，不需要複雜權限檢查

**方案 2：權限檢查**
- 檢查用戶 ID 是否在管理員列表中
- 更安全，但需要額外配置

**推薦**：先使用方案 1（特殊 URL），後續可以升級為方案 2

---

## 下一步行動

1. **確定命名**：討論並確定最終應用名稱
2. **確認需求**：確認核心功能和優先級
3. **開始開發**：創建項目結構，開始階段 1 開發

---

**文檔版本**：v0.1  
**創建日期**：2025-01-XX  
**狀態**：初步計劃，待討論確認

