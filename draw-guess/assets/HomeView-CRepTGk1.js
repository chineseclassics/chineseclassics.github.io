import{d as N,u as X,c as l,a as f,b as o,e,t as r,o as i,_ as D,r as y,f as G,g as me,h as Ce,w as F,n as Q,i as R,j as le,v as ie,k as E,l as Re,F as de,m as re,p as K,q as A,s as Se,x as Me}from"./index-DAV_pZ_l.js";import{u as Y,a as Ve,I as ue,W as We}from"./WaitingLobby-DHiPK60r.js";import{u as ve,a as Ae,f as Te}from"./useAIWordGenerator-BAsrDLxC.js";const Le={class:"user-auth"},Ge={key:0},Ee=["disabled"],Ue={key:1},He={class:"user-info-card border margin-bottom-small"},je={class:"row flex-middle margin-bottom-small"},ze={class:"col-8"},qe={class:"row flex-middle"},Fe={class:"col-auto"},Ne=["src","alt"],De={key:1,class:"user-avatar border user-avatar-placeholder"},Ie={class:"col"},Oe={class:"text-hand user-name"},Je={class:"text-small user-status"},Be={class:"col-4 text-right"},Pe=["disabled"],Qe={key:0,class:"user-stats-inline"},Ke={class:"stats-row"},Xe={class:"stat-item"},Ye={class:"stat-value"},Ze={key:2,class:"alert alert-danger margin-top-small"},et=N({__name:"UserAuth",setup(I){const u=X();async function v(){const g=await u.signInWithGoogle();g&&!g.success&&console.error("Google ç™»å…¥å¤±æ•—:",g.error)}async function V(){const g=await u.signOut();g.success||console.error("ç™»å‡ºå¤±æ•—:",g.error)}function k(g){return g.toLocaleString("zh-TW")}return(g,p)=>(i(),l("div",Le,[o(u).isAuthenticated?(i(),l("div",Ue,[e("div",He,[e("div",je,[e("div",ze,[e("div",qe,[e("div",Fe,[o(u).profile?.avatar_url?(i(),l("img",{key:0,src:o(u).profile.avatar_url,alt:o(u).profile.display_name,class:"user-avatar border"},null,8,Ne)):(i(),l("div",De,r(o(u).profile?.display_name?.charAt(0)||"?"),1))]),e("div",Ie,[e("div",Oe,r(o(u).profile?.display_name||"ç”¨æˆ¶"),1),e("div",Je,r(o(u).isAnonymous?"åŒ¿åéŠç©":"å·²ç™»å…¥"),1)])])]),e("div",Be,[e("button",{onClick:V,disabled:o(u).loading,class:"paper-btn btn-small"},r(o(u).loading?"è™•ç†ä¸­...":"ç™»å‡º"),9,Pe)])]),o(u).isRegistered&&o(u).profile?(i(),l("div",Qe,[e("div",Ke,[e("div",Xe,[p[0]||(p[0]=e("span",{class:"stat-label"},"ç¸½ç©åˆ†",-1)),e("span",Ye,r(k(o(u).profile.total_score||0)),1)])]),p[1]||(p[1]=e("div",{class:"gamification-placeholder margin-top-small"},null,-1))])):f("",!0)])])):(i(),l("div",Ge,[f("",!0),e("button",{onClick:v,disabled:o(u).loading,class:"paper-btn btn-primary btn-block"},r(o(u).loading?"è™•ç†ä¸­...":"Google ç™»å…¥"),9,Ee)])),o(u).error?(i(),l("div",Ze,r(o(u).error),1)):f("",!0)]))}}),ce=D(et,[["__scopeId","data-v-7ac95212"]]),tt={class:"room-create"},st={class:"card"},ot={class:"card-body"},at={class:"form-group game-mode-group"},nt={class:"game-mode-options"},lt={key:0,class:"form-group room-theme-group"},it={key:1,class:"form-group single-round-group"},dt={class:"checkbox-label"},rt={key:2,class:"form-group"},ut={key:0,class:"text-small text-secondary"},ct={key:1,class:"word-library-dropdown"},mt={class:"dropdown-wrapper"},vt={class:"dropdown-text"},pt={class:"dropdown-arrow"},_t={key:0,class:"dropdown-menu"},ft=["onClick"],gt={class:"dropdown-item-content"},ht={class:"dropdown-item-main"},bt={class:"dropdown-item-title"},yt={class:"dropdown-item-desc"},wt={class:"dropdown-item-count"},kt=["onClick","disabled"],$t={key:0,class:"collection-detail-panel"},xt={class:"detail-header"},Ct={class:"detail-title-section"},Rt={class:"detail-title"},St={class:"detail-desc"},Mt={class:"detail-count"},Vt={class:"detail-entries"},Wt={key:0,class:"text-small text-secondary text-center"},At={key:1,class:"text-small text-secondary text-center"},Tt={key:2,class:"entries-list"},Lt={class:"entry-checkbox"},Gt=["checked","onChange"],Et={class:"entry-text"},Ut={class:"detail-actions"},Ht=["disabled"],jt=["disabled"],zt={key:1,class:"text-small info-hint margin-top-small"},qt={key:3,class:"form-group words-input-group"},Ft={class:"words-label-row"},Nt={class:"form-group room-theme-group-inline"},Dt=["disabled"],It={key:0,class:"ai-btn-loading"},Ot={key:1,class:"ai-btn-limited"},Jt={key:2},Bt={key:0,class:"ai-error-message"},Pt={key:1,class:"ai-info-message"},Qt={class:"words-stats"},Kt={class:"text-small"},Xt={key:0,class:"text-small",style:{color:"#e8590c"}},Yt={key:4,class:"storyboard-info"},Zt={class:"margin-top-medium game-settings-section"},es={class:"form-group"},ts={key:5,class:"alert alert-danger margin-top-small"},ss={class:"row flex-spaces submit-buttons-section"},os=["disabled"],as=N({__name:"RoomCreate",emits:["cancel","created"],setup(I,{emit:u}){const v=u,{createRoom:V,loading:k}=Y(),{collections:g,entriesMap:p,loadingCollections:c,loadingEntries:U,loadCollections:W,loadEntries:w}=ve(),{isGenerating:h,isRateLimited:_,error:$,generateWords:O}=Ae(),S=y(null),d=y({name:"",wordsText:"",settings:{draw_time:60,rounds:0,word_count_per_round:1,hints_count:2},gameMode:"classic",singleRoundMode:!1}),x=y(null),T=y(null),m=y(!1),n=y(null),b=y({}),M=y(new Set);function J(s){return s.split(/[ï¼Œ,\n]/).map(t=>t.trim()).filter(t=>t.length>0)}function pe(){x.value=null}const _e=G(()=>J(d.value.wordsText)),H=G(()=>{const s=new Set,t=[];for(const a of _e.value)s.has(a)||(s.add(a),t.push(a));return t}),z=G(()=>H.value.length),Z=G(()=>d.value.wordsText.length),ee=G(()=>{const s=d.value.name.trim().length>0&&d.value.name.length<=50;return d.value.gameMode==="storyboard"?s:s&&z.value>=6&&Z.value<=600&&H.value.every(t=>t.length>=1&&t.length<=32)});function te(){const s=new Set(H.value);M.value=new Set([...M.value].filter(t=>s.has(t)))}function fe(s,t){return b.value[s]?.has(t)??!1}function ge(s,t){const a=b.value[s]||new Set;a.has(t)?a.delete(t):a.add(t),b.value={...b.value,[s]:a}}function se(s){return(b.value[s]?.size||0)>0}function q(s){if(b.value[s]){const t={...b.value};delete t[s],b.value=t}}function oe(s){const t=s.map(j=>j.trim()).filter(Boolean),a=H.value,C=new Set(a),L=[...a];let B=0,P=0;t.forEach(j=>{C.has(j)?P++:(C.add(j),L.push(j),B++)}),d.value.wordsText=L.join(`
`),M.value=new Set([...M.value,...t]),te(),P>0?T.value=`å·²åŠ å…¥ ${B} å€‹è©æ¢ï¼Œè·³é ${P} å€‹é‡è¤‡è©æ¢`:T.value=`å·²åŠ å…¥ ${B} å€‹è©æ¢`}function he(){m.value=!m.value,m.value}async function be(s){const t=g.value.find(a=>a.id===s);t&&(n.value={id:t.id,title:t.title,description:t.description,entry_count:t.entry_count},m.value=!1,await w(s))}async function ye(s){m.value=!1,await ae(s)}function we(){const s=n.value?.id;s&&q(s),n.value=null}async function ke(s){const t=p.value[s]||await w(s),a=b.value[s];if(!a||a.size===0)return;const C=t?.filter(L=>a.has(L.id)).map(L=>L.text)||[];oe(C),q(s),n.value=null}async function ae(s){const a=(p.value[s]||await w(s)||[]).map(C=>C.text);oe(a),q(s),n.value=null}function ne(s){!s.target.closest(".word-library-dropdown")&&m.value&&(m.value=!1)}async function $e(){if(!d.value.name.trim()){S.value="è«‹å…ˆè¼¸å…¥è©å¥ä¸»é¡Œ";return}S.value=null;const s=await O(d.value.name.trim());s&&(d.value.wordsText=Te(s.words),s.isThemeAdjusted&&s.adjustedTheme?S.value=`å·²æ ¹æ“šã€Œ${s.adjustedTheme}ã€ä¸»é¡Œç”Ÿæˆ ${s.words.length} å€‹è©èª`:S.value=`å·²ç”Ÿæˆ ${s.words.length} å€‹è©èª`,M.value=new Set)}me(()=>{W(),document.addEventListener("click",ne)}),Ce(()=>{document.removeEventListener("click",ne)});async function xe(){if(!ee.value){x.value="è«‹æª¢æŸ¥è¡¨å–®è¼¸å…¥";return}x.value=null,te();try{const s=d.value.gameMode==="storyboard"?[]:H.value.map(a=>({text:a,source:M.value.has(a)?"wordlist":"custom"})),t=await V({name:d.value.name.trim(),words:s,settings:d.value.settings,gameMode:d.value.gameMode,singleRoundMode:d.value.singleRoundMode});t.success&&t.room?v("created",t.room.code):(x.value=t.error||"å‰µå»ºæˆ¿é–“å¤±æ•—",console.error("å‰µå»ºæˆ¿é–“å¤±æ•—:",t.error))}catch(s){x.value=s instanceof Error?s.message:"å‰µå»ºæˆ¿é–“æ™‚ç™¼ç”ŸéŒ¯èª¤",console.error("å‰µå»ºæˆ¿é–“ç•°å¸¸:",s)}}return(s,t)=>(i(),l("div",tt,[e("div",st,[e("div",ot,[t[21]||(t[21]=e("h2",{class:"card-title text-hand-title"},"å‰µå»ºæˆ¿é–“",-1)),e("form",{onSubmit:F(xe,["prevent"])},[e("div",at,[t[13]||(t[13]=e("label",null,"éŠæˆ²æ¨¡å¼",-1)),e("div",nt,[e("label",{class:Q(["game-mode-option",{active:d.value.gameMode==="classic"}])},[R(e("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=a=>d.value.gameMode=a),value:"classic",name:"gameMode"},null,512),[[ie,d.value.gameMode]]),t[11]||(t[11]=le('<div class="mode-content" data-v-8f3a3279><span class="mode-icon" data-v-8f3a3279>ğŸ¨</span><div class="mode-text" data-v-8f3a3279><span class="mode-name" data-v-8f3a3279>å‚³çµ±æ¨¡å¼</span><span class="mode-desc" data-v-8f3a3279>çŒœè©ç«¶æŠ€ï¼ŒçŒœå°å¾—åˆ†</span></div></div>',1))],2),e("label",{class:Q(["game-mode-option",{active:d.value.gameMode==="storyboard"}])},[R(e("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=a=>d.value.gameMode=a),value:"storyboard",name:"gameMode"},null,512),[[ie,d.value.gameMode]]),t[12]||(t[12]=le('<div class="mode-content" data-v-8f3a3279><span class="mode-icon" data-v-8f3a3279>ğŸ“–</span><div class="mode-text" data-v-8f3a3279><span class="mode-name" data-v-8f3a3279>åˆ†é¡æ¥é¾</span><span class="mode-desc" data-v-8f3a3279>åˆä½œå‰µä½œæ•…äº‹æ¼«ç•«</span></div></div>',1))],2)])]),d.value.gameMode==="storyboard"?(i(),l("div",lt,[t[14]||(t[14]=e("label",null,"æ•…äº‹æ¨™é¡Œ",-1)),R(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>d.value.name=a),type:"text",placeholder:"æ±ºå®šé›†é«”å‰µä½œæ•…äº‹çš„èµ°å‘ï¼Œå¦‚ã€Œæ—é»›ç‰çš„æ¸¯æ¼‚æ—¥è¨˜ã€",maxlength:"50",required:"",class:"room-theme-input"},null,512),[[E,d.value.name]])])):f("",!0),d.value.gameMode==="storyboard"?(i(),l("div",it,[e("label",dt,[R(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=a=>d.value.singleRoundMode=a)},null,512),[[Re,d.value.singleRoundMode]]),t[15]||(t[15]=e("span",{class:"checkbox-text"},"å–®å ´æ¨¡å¼",-1)),t[16]||(t[16]=e("span",{class:"checkbox-hint"},"ï¼ˆå‹¾é¸å¾ŒéŠæˆ²åªé€²è¡Œä¸€å ´å³çµæŸï¼‰",-1))])])):f("",!0),d.value.gameMode==="classic"?(i(),l("div",rt,[t[17]||(t[17]=e("label",{class:"library-label"},"é è¨­ä¸»é¡Œè©å¥åº«",-1)),o(c)?(i(),l("div",ut,"è©å¥åº«è¼‰å…¥ä¸­...")):(i(),l("div",ct,[e("div",mt,[e("div",{class:Q(["dropdown-trigger",{"dropdown-open":m.value}]),onClick:he},[e("span",vt,r(n.value?n.value.title:"é¸æ“‡ä¸»é¡Œæˆ–ä¸€éµåŠ å…¥..."),1),e("span",pt,r(m.value?"â–²":"â–¼"),1)],2),m.value?(i(),l("div",_t,[(i(!0),l(de,null,re(o(g),a=>(i(),l("div",{key:a.id,class:"dropdown-item",onClick:F(C=>be(a.id),["stop"])},[e("div",gt,[e("div",ht,[e("div",bt,r(a.title),1),e("div",yt,r(a.description),1),e("div",wt,r(a.entry_count)+" æ¢",1)]),e("button",{type:"button",class:"paper-btn btn-primary btn-small dropdown-quick-add",onClick:F(C=>ye(a.id),["stop"]),disabled:a.entry_count===0}," ä¸€éµåŠ å…¥ ",8,kt)])],8,ft))),128))])):f("",!0)]),n.value&&!m.value?(i(),l("div",$t,[e("div",xt,[e("div",Ct,[e("h4",Rt,"ğŸ“š "+r(n.value.title),1),e("p",St,r(n.value.description),1),e("span",Mt,"å…± "+r(n.value.entry_count)+" æ¢",1)]),e("button",{type:"button",class:"paper-btn btn-small",onClick:we}," é—œé–‰ ")]),e("div",Vt,[o(U)[n.value.id]?(i(),l("div",Wt," è©æ¢è¼‰å…¥ä¸­... ")):(o(p)[n.value.id]||[]).length===0?(i(),l("div",At," è©²ä¸»é¡Œæš«ç„¡è©æ¢ ")):(i(),l("div",Tt,[(i(!0),l(de,null,re(o(p)[n.value.id]||[],a=>(i(),l("div",{key:a.id,class:"entry-item"},[e("label",Lt,[e("input",{type:"checkbox",checked:fe(n.value.id,a.id),onChange:C=>ge(n.value.id,a.id)},null,40,Gt),e("span",Et,r(a.text),1)])]))),128))]))]),e("div",Ut,[e("button",{type:"button",class:"paper-btn btn-primary btn-small",disabled:!se(n.value.id),onClick:t[4]||(t[4]=a=>ke(n.value.id))}," åŠ å…¥å·²å‹¾é¸ ",8,Ht),e("button",{type:"button",class:"paper-btn btn-secondary btn-small",onClick:t[5]||(t[5]=a=>ae(n.value.id)),disabled:n.value.entry_count===0}," å…¨éƒ¨åŠ å…¥ ",8,jt),se(n.value.id)?(i(),l("button",{key:0,type:"button",class:"paper-btn btn-link btn-small",onClick:t[6]||(t[6]=a=>q(n.value.id))}," æ¸…é™¤ ")):f("",!0)])])):f("",!0),T.value?(i(),l("div",zt,r(T.value),1)):f("",!0)]))])):f("",!0),d.value.gameMode==="classic"?(i(),l("div",qt,[e("div",Ft,[e("div",Nt,[t[18]||(t[18]=e("label",null,"è‡ªå®šç¾©è©å¥ä¸»é¡Œ",-1)),R(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>d.value.name=a),type:"text",placeholder:"ç‚ºç©å®¶æç¤ºçŒœè©ç¯„åœï¼Œå¦‚ã€Œé¦™æ¸¯å°åƒã€",maxlength:"50",required:"",class:"room-theme-input"},null,512),[[E,d.value.name]])]),e("button",{type:"button",class:"paper-btn ai-generate-btn",disabled:o(h)||o(_),onClick:$e},[o(h)?(i(),l("span",It,"â³ ç”Ÿæˆä¸­...")):o(_)?(i(),l("span",Ot,"ğŸš« è«‹ç¨å¾Œå†è©¦")):(i(),l("span",Jt,"âœ¨ ç”Ÿæˆè©å¥åº«"))],8,Dt)]),o($)?(i(),l("div",Bt,r(o($)),1)):f("",!0),S.value?(i(),l("div",Pt,r(S.value),1)):f("",!0),R(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=a=>d.value.wordsText=a),rows:"6",placeholder:`è‡ªå®šç¾©è©èªï¼ˆè‡³å°‘ 6 å€‹ï¼Œæ”¯æŒä¸­è‹±æ–‡è©èªï¼‰
è¼¸å…¥è©èªï¼Œç”¨é€—è™Ÿï¼ˆï¼Œæˆ–,ï¼‰æˆ–æ›è¡Œåˆ†éš”
ä¾‹å¦‚ï¼šæ˜¥å¤©ï¼Œå‹èª¼ï¼Œå‹‡æ°£`,onInput:pe,class:"words-textarea"},null,544),[[E,d.value.wordsText]]),e("div",Qt,[e("div",Kt," å·²è¼¸å…¥ "+r(z.value)+" å€‹è©èªï¼Œ"+r(Z.value)+" / 600 å­—ç¬¦ ",1),z.value<6?(i(),l("div",Xt," é‚„éœ€è¦ "+r(6-z.value)+" å€‹è©èª ",1)):f("",!0)])])):f("",!0),d.value.gameMode==="storyboard"?(i(),l("div",Yt,[...t[19]||(t[19]=[e("div",{class:"info-card"},[e("h4",null,"ğŸ“– åˆ†é¡æ¥é¾æ¨¡å¼èªªæ˜"),e("ul",null,[e("li",null,"ğŸ¨ åˆ†é¡å¸«æ ¹æ“šä¸Šä¸€é¡å‹å‡ºå¥å­ç¹ªç•«"),e("li",null,"âœï¸ ç·¨åŠ‡æ ¹æ“šç•«ä½œå‰µä½œä¸‹ä¸€å¥æ•…äº‹"),e("li",null,"ğŸ—³ï¸ æ‰€æœ‰ç©å®¶æŠ•ç¥¨é¸å‡ºæœ€ä½³å¥å­"),e("li",null,"ğŸ“š æœ€çµ‚ç”¢å‡ºä¸€å€‹åœ–æ–‡äº¤æ›¿çš„æ•…äº‹æ¿")]),e("p",{class:"info-note"},"âš ï¸ åˆ†é¡æ¨¡å¼éœ€è¦è‡³å°‘ 3 ä½ç©å®¶")],-1)])])):f("",!0),e("div",Zt,[e("div",es,[t[20]||(t[20]=e("label",null,"ç¹ªç•«æ™‚é–“ï¼ˆç§’ï¼‰",-1)),R(e("input",{"onUpdate:modelValue":t[9]||(t[9]=a=>d.value.settings.draw_time=a),type:"number",min:"60",max:"180",required:""},null,512),[[E,d.value.settings.draw_time,void 0,{number:!0}]])])]),x.value?(i(),l("div",ts,r(x.value),1)):f("",!0),e("div",ss,[e("button",{type:"submit",disabled:o(k)||!ee.value,class:"paper-btn btn-primary"},r(o(k)?"å‰µå»ºä¸­...":"å‰µå»ºæˆ¿é–“"),9,os),e("button",{type:"button",onClick:t[10]||(t[10]=a=>s.$emit("cancel")),class:"paper-btn btn-secondary"}," å–æ¶ˆ ")])],32)])])]))}}),ns=D(as,[["__scopeId","data-v-8f3a3279"]]),ls={class:"room-join"},is={class:"card"},ds={class:"card-body"},rs={class:"form-group"},us={class:"form-group"},cs={key:0,class:"alert alert-danger"},ms={class:"row flex-spaces margin-top-medium"},vs=["disabled"],ps=N({__name:"RoomJoin",emits:["cancel","joined"],setup(I,{emit:u}){const v=u,{joinRoom:V,loading:k}=Y(),g=X(),p=y({code:"",nickname:g.profile?.display_name||""}),c=y(null);function U(h){const _=h.target;p.value.code=_.value.replace(/\D/g,"").slice(0,6),c.value=null}const W=G(()=>p.value.code.length===6&&p.value.nickname.trim().length>0&&p.value.nickname.length<=20);async function w(){if(!W.value){c.value="è«‹æª¢æŸ¥è¡¨å–®è¼¸å…¥";return}c.value=null;const h=await V(p.value.code,p.value.nickname.trim());h.success?v("joined"):c.value=h.error||"åŠ å…¥æˆ¿é–“å¤±æ•—"}return(h,_)=>(i(),l("div",ls,[e("div",is,[e("div",ds,[_[6]||(_[6]=e("h2",{class:"card-title text-hand-title"},"åŠ å…¥æˆ¿é–“",-1)),e("form",{onSubmit:F(w,["prevent"])},[e("div",rs,[_[3]||(_[3]=e("label",null,"æˆ¿é–“ç¢¼",-1)),R(e("input",{"onUpdate:modelValue":_[0]||(_[0]=$=>p.value.code=$),type:"text",class:"text-center",style:{"font-size":"2rem","letter-spacing":"0.5rem"},placeholder:"000000",maxlength:"6",pattern:"[0-9]{6}",required:"",onInput:U},null,544),[[E,p.value.code]]),_[4]||(_[4]=e("div",{class:"text-small"}," è¼¸å…¥ 6 ä½æ•¸å­—æˆ¿é–“ç¢¼ ",-1))]),e("div",us,[_[5]||(_[5]=e("label",null,"æš±ç¨±",-1)),R(e("input",{"onUpdate:modelValue":_[1]||(_[1]=$=>p.value.nickname=$),type:"text",placeholder:"è¼¸å…¥æ‚¨çš„æš±ç¨±",maxlength:"20",required:""},null,512),[[E,p.value.nickname]])]),c.value?(i(),l("div",cs,r(c.value),1)):f("",!0),e("div",ms,[e("button",{type:"submit",disabled:o(k)||!W.value,class:"paper-btn btn-primary"},r(o(k)?"åŠ å…¥ä¸­...":"åŠ å…¥æˆ¿é–“"),9,vs),e("button",{type:"button",onClick:_[2]||(_[2]=$=>h.$emit("cancel")),class:"paper-btn btn-secondary"}," å–æ¶ˆ ")])],32)])])]))}}),_s=D(ps,[["__scopeId","data-v-35f98c69"]]),fs={class:"container margin-top-large"},gs={class:"row flex-center"},hs={class:"col-12 col-lg-10"},bs={class:"text-center margin-bottom-large"},ys={class:"text-hand-title",style:{"font-size":"2.25rem","margin-bottom":"1rem",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"}},ws={key:0,class:"home-welcome-section"},ks={class:"welcome-card"},$s={class:"welcome-icon"},xs={class:"welcome-auth"},Cs={key:1,class:"margin-bottom-medium"},Rs={key:2,class:"margin-bottom-medium"},Ss={key:3},Ms={key:0,class:"margin-bottom-medium"},Vs={key:1,class:"margin-bottom-medium"},Ws={key:2,class:"home-main-layout"},As={class:"home-user-section"},Ts={class:"user-info-card"},Ls={class:"user-header"},Gs=["src","alt"],Es={key:1,class:"user-avatar user-avatar-placeholder"},Us={class:"user-details"},Hs={class:"user-name"},js={class:"user-status"},zs={key:0,class:"user-stats"},qs={class:"stat-item"},Fs={class:"stat-value"},Ns={class:"user-actions"},Ds=["disabled"],Is={class:"home-actions-section"},Os={class:"actions-card"},Js={class:"actions-buttons"},Bs={key:3,class:"home-main-layout"},Ps={class:"home-auth-section"},Qs={class:"anonymous-upgrade-card"},Ks=N({__name:"HomeView",setup(I){const u=Me(),{currentRoom:v,participants:V,leaveRoom:k,isHost:g}=Y(),{subscribeRoom:p}=Ve(),c=X(),{isAdmin:U,refreshAdminStatus:W}=ve(),w=y(!1),h=y(!1);function _(m){w.value=!1,v.value&&u.push(`/room/${v.value.code}`)}function $(){h.value=!1,v.value&&u.push(`/room/${v.value.code}`)}function O(){console.log("[HomeView] æ”¶åˆ°éŠæˆ²é–‹å§‹äº‹ä»¶"),v.value&&u.push(`/room/${v.value.code}`)}async function S(){(await k()).success&&(w.value=!1,h.value=!1)}K(()=>v.value,m=>{m&&c.user&&p(m.code,m.id,c.user.id,{nickname:c.profile?.display_name||"ç©å®¶"})},{immediate:!0}),K(()=>v.value?.status,async(m,n)=>{if(console.log("[HomeView] æˆ¿é–“ç‹€æ…‹è®ŠåŒ–:",{oldStatus:n,newStatus:m,currentRoute:u.currentRoute.value.name,isHost:g.value}),v.value&&(m==="playing"||m==="finished")){const b=u.currentRoute.value;if(b.name!=="room"||b.params.code!==v.value.code){console.log("[HomeView] æº–å‚™è·³è½‰åˆ° RoomView:",v.value.code,"(isHost:",g.value,")");const M=`/room/${v.value.code}`;try{await u.push(M),console.log("[HomeView] è·¯ç”±è·³è½‰æˆåŠŸ")}catch(J){console.error("[HomeView] è·¯ç”±è·³è½‰éŒ¯èª¤:",J)}}else console.log("[HomeView] å·²åœ¨ RoomViewï¼Œç„¡éœ€è·³è½‰")}}),me(()=>{c.profile?.email&&W(!0)}),K(()=>c.profile?.email,m=>{m&&W(!0)});function d(){u.push("/word-library")}async function x(){const m=await c.signOut();m.success||console.error("ç™»å‡ºå¤±æ•—:",m.error)}function T(m){return m.toLocaleString("zh-TW")}return(m,n)=>(i(),l("div",fs,[e("div",gs,[e("div",hs,[e("div",bs,[e("h1",ys,[A(o(ue),{size:32,weight:"duotone",style:{color:"var(--color-primary)"}}),n[4]||(n[4]=Se(" ä½ ç•«æˆ‘çŒœ ",-1))])]),o(c).isAuthenticated?f("",!0):(i(),l("div",ws,[e("div",ks,[e("div",$s,[A(o(ue),{size:48,weight:"duotone"})]),n[5]||(n[5]=e("p",{class:"welcome-text"},"èˆ‡æœ‹å‹ä¸€èµ·ç•«ç•«çŒœè©ï¼Œè€ƒé©—é»˜å¥‘ï¼",-1)),e("div",xs,[A(ce)]),n[6]||(n[6]=e("p",{class:"welcome-hint"},"ä½¿ç”¨ Google å¸³è™Ÿç™»å…¥å³å¯é–‹å§‹éŠæˆ²",-1))])])),o(v)&&o(v).status==="waiting"?(i(),l("div",Cs,[A(We,{room:o(v),participants:o(V),onStartGame:O,onLeaveRoom:S},null,8,["room","participants"])])):o(v)&&(o(v).status==="playing"||o(v).status==="finished")?(i(),l("div",Rs,[...n[7]||(n[7]=[e("div",{class:"text-center"},[e("p",{class:"text-hand"},"æ­£åœ¨è·³è½‰åˆ°éŠæˆ²æˆ¿é–“...")],-1)])])):(i(),l("div",Ss,[w.value?(i(),l("div",Ms,[A(ns,{onCreated:_,onCancel:n[0]||(n[0]=()=>{console.log("å–æ¶ˆå‰µå»ºæˆ¿é–“"),w.value=!1})})])):h.value?(i(),l("div",Vs,[A(_s,{onJoined:$,onCancel:n[1]||(n[1]=b=>h.value=!1)})])):o(c).isRegistered?(i(),l("div",Ws,[e("div",As,[e("div",Ts,[e("div",Ls,[o(c).profile?.avatar_url?(i(),l("img",{key:0,src:o(c).profile.avatar_url,alt:o(c).profile.display_name,class:"user-avatar"},null,8,Gs)):(i(),l("div",Es,r(o(c).profile?.display_name?.charAt(0)||"?"),1)),e("div",Us,[e("div",Hs,r(o(c).profile?.display_name||"ç”¨æˆ¶"),1),e("div",js,r(o(c).isAnonymous?"åŒ¿åéŠç©":"å·²ç™»å…¥"),1)])]),o(c).isRegistered&&o(c).profile?(i(),l("div",zs,[e("div",qs,[n[8]||(n[8]=e("span",{class:"stat-label"},"ç¸½ç©åˆ†",-1)),e("span",Fs,r(T(o(c).profile.total_score||0)),1)])])):f("",!0),e("div",Ns,[e("button",{onClick:x,disabled:o(c).loading,class:"paper-btn btn-small btn-block"},r(o(c).loading?"è™•ç†ä¸­...":"ç™»å‡º"),9,Ds)])])]),e("div",Is,[e("div",Os,[e("div",Js,[e("button",{onClick:n[2]||(n[2]=b=>w.value=!0),class:"paper-btn btn-primary btn-block margin-bottom-small"}," å‰µå»ºæˆ¿é–“ "),e("button",{onClick:n[3]||(n[3]=b=>h.value=!0),class:"paper-btn btn-secondary btn-block margin-bottom-small"}," åŠ å…¥æˆ¿é–“ "),o(U)?(i(),l("button",{key:0,class:"paper-btn btn-warning btn-block",onClick:d}," è©å¥åº«ç®¡ç† ")):f("",!0)])])])])):o(c).isAuthenticated&&!o(c).isRegistered?(i(),l("div",Bs,[e("div",Ps,[e("div",Qs,[n[9]||(n[9]=e("p",{class:"text-hand"},"æ‚¨ç›®å‰æ˜¯åŒ¿åç”¨æˆ¶",-1)),n[10]||(n[10]=e("p",{class:"text-small text-secondary"},"ä½¿ç”¨ Google ç™»å…¥ä»¥ä¿å­˜éŠæˆ²è¨˜éŒ„",-1)),A(ce)])])])):f("",!0)]))])]),n[11]||(n[11]=e("footer",{class:"home-footer"},[e("div",{class:"footer-content"},[e("p",{class:"footer-text"},"Â© 2025 å¤ªè™›å¹»å¢ƒ"),e("p",{class:"footer-text"},"ä½œè€…ï¼šå¼µè€å¸«")])],-1))]))}}),eo=D(Ks,[["__scopeId","data-v-aff2610b"]]);export{eo as default};
