import{d as N,u as Q,c as l,a as h,b as o,e,t as d,o as i,_ as D,r as x,f as E,g as re,h as fe,w as q,n as I,i as M,j as oe,v as ae,k as z,l as ye,F as ne,m as le,p as P,q as A,s as we,x as $e}from"./index-DmYURjAb.js";import{u as K,a as ke,I as ie,W as xe}from"./WaitingLobby-D0T4XFb2.js";import{u as ue}from"./useWordLibrary-CzEVLchK.js";const Ce={class:"user-auth"},Re={key:0},Me=["disabled"],Se={key:1},Ve={class:"user-info-card border margin-bottom-small"},We={class:"row flex-middle margin-bottom-small"},Ae={class:"col-8"},Le={class:"row flex-middle"},Te={class:"col-auto"},Ee=["src","alt"],He={key:1,class:"user-avatar border user-avatar-placeholder"},Ue={class:"col"},ze={class:"text-hand user-name"},Ge={class:"text-small user-status"},je={class:"col-4 text-right"},qe=["disabled"],Ne={key:0,class:"user-stats-inline"},De={class:"stats-row"},Fe={class:"stat-item"},Oe={class:"stat-value"},Je={key:2,class:"alert alert-danger margin-top-small"},Be=N({__name:"UserAuth",setup(F){const r=Q();async function v(){const b=await r.signInWithGoogle();b&&!b.success&&console.error("Google ç™»å…¥å¤±æ•—:",b.error)}async function S(){const b=await r.signOut();b.success||console.error("ç™»å‡ºå¤±æ•—:",b.error)}function C(b){return b.toLocaleString("zh-TW")}return(b,_)=>(i(),l("div",Ce,[o(r).isAuthenticated?(i(),l("div",Se,[e("div",Ve,[e("div",We,[e("div",Ae,[e("div",Le,[e("div",Te,[o(r).profile?.avatar_url?(i(),l("img",{key:0,src:o(r).profile.avatar_url,alt:o(r).profile.display_name,class:"user-avatar border"},null,8,Ee)):(i(),l("div",He,d(o(r).profile?.display_name?.charAt(0)||"?"),1))]),e("div",Ue,[e("div",ze,d(o(r).profile?.display_name||"ç”¨æˆ¶"),1),e("div",Ge,d(o(r).isAnonymous?"åŒ¿åéŠç©":"å·²ç™»å…¥"),1)])])]),e("div",je,[e("button",{onClick:S,disabled:o(r).loading,class:"paper-btn btn-small"},d(o(r).loading?"è™•ç†ä¸­...":"ç™»å‡º"),9,qe)])]),o(r).isRegistered&&o(r).profile?(i(),l("div",Ne,[e("div",De,[e("div",Fe,[_[0]||(_[0]=e("span",{class:"stat-label"},"ç¸½ç©åˆ†",-1)),e("span",Oe,d(C(o(r).profile.total_score||0)),1)])]),_[1]||(_[1]=e("div",{class:"gamification-placeholder margin-top-small"},null,-1))])):h("",!0)])])):(i(),l("div",Re,[h("",!0),e("button",{onClick:v,disabled:o(r).loading,class:"paper-btn btn-primary btn-block"},d(o(r).loading?"è™•ç†ä¸­...":"Google ç™»å…¥"),9,Me)])),o(r).error?(i(),l("div",Je,d(o(r).error),1)):h("",!0)]))}}),de=D(Be,[["__scopeId","data-v-7ac95212"]]),Ie={class:"room-create"},Pe={class:"card"},Qe={class:"card-body"},Ke={class:"form-group game-mode-group"},Xe={class:"game-mode-options"},Ye={class:"form-group room-theme-group"},Ze=["placeholder"],et={key:0,class:"form-group single-round-group"},tt={class:"checkbox-label"},st={key:1,class:"form-group"},ot={key:0,class:"text-small text-secondary"},at={key:1,class:"word-library-dropdown"},nt={class:"dropdown-wrapper"},lt={class:"dropdown-text"},it={class:"dropdown-arrow"},dt={key:0,class:"dropdown-menu"},rt=["onClick"],ut={class:"dropdown-item-content"},ct={class:"dropdown-item-main"},mt={class:"dropdown-item-title"},vt={class:"dropdown-item-desc"},pt={class:"dropdown-item-count"},_t=["onClick","disabled"],gt={key:0,class:"collection-detail-panel"},ht={class:"detail-header"},bt={class:"detail-title-section"},ft={class:"detail-title"},yt={class:"detail-desc"},wt={class:"detail-count"},$t={class:"detail-entries"},kt={key:0,class:"text-small text-secondary text-center"},xt={key:1,class:"text-small text-secondary text-center"},Ct={key:2,class:"entries-list"},Rt={class:"entry-checkbox"},Mt=["checked","onChange"],St={class:"entry-text"},Vt={key:0,class:"entry-category"},Wt={class:"detail-actions"},At=["disabled"],Lt=["disabled"],Tt={key:1,class:"text-small info-hint margin-top-small"},Et={key:2,class:"form-group words-input-group"},Ht={class:"words-stats"},Ut={class:"text-small"},zt={key:0,class:"text-small",style:{color:"#e8590c"}},Gt={key:3,class:"storyboard-info"},jt={class:"margin-top-medium game-settings-section"},qt={class:"form-group"},Nt={key:4,class:"alert alert-danger margin-top-small"},Dt={class:"row flex-spaces submit-buttons-section"},Ft=["disabled"],Ot=N({__name:"RoomCreate",emits:["cancel","created"],setup(F,{emit:r}){const v=r,{createRoom:S,loading:C}=K(),{collections:b,entriesMap:_,loadingCollections:u,loadingEntries:H,loadCollections:V,loadEntries:y}=ue(),n=x({name:"",wordsText:"",settings:{draw_time:60,rounds:0,word_count_per_round:1,hints_count:2},gameMode:"classic",singleRoundMode:!1}),c=x(null),w=x(null),f=x(!1),p=x(null),$=x({}),W=x(new Set);function O(a){return a.split(/[ï¼Œ,\n]/).map(t=>t.trim()).filter(t=>t.length>0)}function g(){c.value=null}const m=E(()=>O(n.value.wordsText)),k=E(()=>{const a=new Set,t=[];for(const s of m.value)a.has(s)||(a.add(s),t.push(s));return t}),L=E(()=>k.value.length),G=E(()=>n.value.wordsText.length),X=E(()=>{const a=n.value.name.trim().length>0&&n.value.name.length<=50;return n.value.gameMode==="storyboard"?a:a&&L.value>=6&&G.value<=600&&k.value.every(t=>t.length>=1&&t.length<=32)});function Y(){const a=new Set(k.value);W.value=new Set([...W.value].filter(t=>a.has(t)))}function ce(a,t){return $.value[a]?.has(t)??!1}function me(a,t){const s=$.value[a]||new Set;s.has(t)?s.delete(t):s.add(t),$.value={...$.value,[a]:s}}function Z(a){return($.value[a]?.size||0)>0}function j(a){if($.value[a]){const t={...$.value};delete t[a],$.value=t}}function ee(a){const t=a.map(U=>U.trim()).filter(Boolean),s=k.value,R=new Set(s),T=[...s];let J=0,B=0;t.forEach(U=>{R.has(U)?B++:(R.add(U),T.push(U),J++)}),n.value.wordsText=T.join(`
`),W.value=new Set([...W.value,...t]),Y(),B>0?w.value=`å·²åŠ å…¥ ${J} å€‹è©æ¢ï¼Œè·³é ${B} å€‹é‡è¤‡è©æ¢`:w.value=`å·²åŠ å…¥ ${J} å€‹è©æ¢`}function ve(){f.value=!f.value,f.value}async function pe(a){const t=b.value.find(s=>s.id===a);t&&(p.value={id:t.id,title:t.title,description:t.description,entry_count:t.entry_count},f.value=!1,await y(a))}async function _e(a){f.value=!1,await te(a)}function ge(){const a=p.value?.id;a&&j(a),p.value=null}async function he(a){const t=_.value[a]||await y(a),s=$.value[a];if(!s||s.size===0)return;const R=t?.filter(T=>s.has(T.id)).map(T=>T.text)||[];ee(R),j(a),p.value=null}async function te(a){const s=(_.value[a]||await y(a)||[]).map(R=>R.text);ee(s),j(a),p.value=null}function se(a){!a.target.closest(".word-library-dropdown")&&f.value&&(f.value=!1)}re(()=>{V(),document.addEventListener("click",se)}),fe(()=>{document.removeEventListener("click",se)});async function be(){if(!X.value){c.value="è«‹æª¢æŸ¥è¡¨å–®è¼¸å…¥";return}c.value=null,Y();try{const a=n.value.gameMode==="storyboard"?[]:k.value.map(s=>({text:s,source:W.value.has(s)?"wordlist":"custom"})),t=await S({name:n.value.name.trim(),words:a,settings:n.value.settings,gameMode:n.value.gameMode,singleRoundMode:n.value.singleRoundMode});t.success&&t.room?v("created",t.room.code):(c.value=t.error||"å‰µå»ºæˆ¿é–“å¤±æ•—",console.error("å‰µå»ºæˆ¿é–“å¤±æ•—:",t.error))}catch(a){c.value=a instanceof Error?a.message:"å‰µå»ºæˆ¿é–“æ™‚ç™¼ç”ŸéŒ¯èª¤",console.error("å‰µå»ºæˆ¿é–“ç•°å¸¸:",a)}}return(a,t)=>(i(),l("div",Ie,[e("div",Pe,[e("div",Qe,[t[20]||(t[20]=e("h2",{class:"card-title text-hand-title"},"å‰µå»ºæˆ¿é–“",-1)),e("form",{onSubmit:q(be,["prevent"])},[e("div",Ke,[t[12]||(t[12]=e("label",null,"éŠæˆ²æ¨¡å¼",-1)),e("div",Xe,[e("label",{class:I(["game-mode-option",{active:n.value.gameMode==="classic"}])},[M(e("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=s=>n.value.gameMode=s),value:"classic",name:"gameMode"},null,512),[[ae,n.value.gameMode]]),t[10]||(t[10]=oe('<div class="mode-content" data-v-32d46a81><span class="mode-icon" data-v-32d46a81>ğŸ¨</span><div class="mode-text" data-v-32d46a81><span class="mode-name" data-v-32d46a81>å‚³çµ±æ¨¡å¼</span><span class="mode-desc" data-v-32d46a81>çŒœè©ç«¶æŠ€ï¼ŒçŒœå°å¾—åˆ†</span></div></div>',1))],2),e("label",{class:I(["game-mode-option",{active:n.value.gameMode==="storyboard"}])},[M(e("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=s=>n.value.gameMode=s),value:"storyboard",name:"gameMode"},null,512),[[ae,n.value.gameMode]]),t[11]||(t[11]=oe('<div class="mode-content" data-v-32d46a81><span class="mode-icon" data-v-32d46a81>ğŸ“–</span><div class="mode-text" data-v-32d46a81><span class="mode-name" data-v-32d46a81>åˆ†é¡æ¥é¾</span><span class="mode-desc" data-v-32d46a81>åˆä½œå‰µä½œæ•…äº‹æ¼«ç•«</span></div></div>',1))],2)])]),e("div",Ye,[e("label",null,d(n.value.gameMode==="storyboard"?"æ•…äº‹æ¨™é¡Œ":"è©å¥ä¸»é¡Œ"),1),M(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.name=s),type:"text",placeholder:n.value.gameMode==="storyboard"?"æ±ºå®šé›†é«”å‰µä½œæ•…äº‹çš„èµ°å‘ï¼Œå¦‚ã€Œæ—é»›ç‰çš„æ¸¯æ¼‚æ—¥è¨˜ã€":"ç‚ºç©å®¶æç¤ºçŒœè©ç¯„åœï¼Œå¦‚ã€Œé¦™æ¸¯å°åƒã€",maxlength:"50",required:"",class:"room-theme-input"},null,8,Ze),[[z,n.value.name]])]),n.value.gameMode==="storyboard"?(i(),l("div",et,[e("label",tt,[M(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=s=>n.value.singleRoundMode=s)},null,512),[[ye,n.value.singleRoundMode]]),t[13]||(t[13]=e("span",{class:"checkbox-text"},"å–®å ´æ¨¡å¼",-1)),t[14]||(t[14]=e("span",{class:"checkbox-hint"},"ï¼ˆå‹¾é¸å¾ŒéŠæˆ²åªé€²è¡Œä¸€å ´å³çµæŸï¼‰",-1))])])):h("",!0),n.value.gameMode==="classic"?(i(),l("div",st,[t[15]||(t[15]=e("label",{class:"library-label"},"ä¸»é¡Œè©å¥åº«",-1)),o(u)?(i(),l("div",ot,"è©å¥åº«è¼‰å…¥ä¸­...")):(i(),l("div",at,[e("div",nt,[e("div",{class:I(["dropdown-trigger",{"dropdown-open":f.value}]),onClick:ve},[e("span",lt,d(p.value?p.value.title:"é¸æ“‡ä¸»é¡Œæˆ–ä¸€éµåŠ å…¥..."),1),e("span",it,d(f.value?"â–²":"â–¼"),1)],2),f.value?(i(),l("div",dt,[(i(!0),l(ne,null,le(o(b),s=>(i(),l("div",{key:s.id,class:"dropdown-item",onClick:q(R=>pe(s.id),["stop"])},[e("div",ut,[e("div",ct,[e("div",mt,d(s.title),1),e("div",vt,d(s.description),1),e("div",pt,d(s.entry_count)+" æ¢",1)]),e("button",{type:"button",class:"paper-btn btn-primary btn-small dropdown-quick-add",onClick:q(R=>_e(s.id),["stop"]),disabled:s.entry_count===0}," ä¸€éµåŠ å…¥ ",8,_t)])],8,rt))),128))])):h("",!0)]),p.value&&!f.value?(i(),l("div",gt,[e("div",ht,[e("div",bt,[e("h4",ft,"ğŸ“š "+d(p.value.title),1),e("p",yt,d(p.value.description),1),e("span",wt,"å…± "+d(p.value.entry_count)+" æ¢",1)]),e("button",{type:"button",class:"paper-btn btn-small",onClick:ge}," é—œé–‰ ")]),e("div",$t,[o(H)[p.value.id]?(i(),l("div",kt," è©æ¢è¼‰å…¥ä¸­... ")):(o(_)[p.value.id]||[]).length===0?(i(),l("div",xt," è©²ä¸»é¡Œæš«ç„¡è©æ¢ ")):(i(),l("div",Ct,[(i(!0),l(ne,null,le(o(_)[p.value.id]||[],s=>(i(),l("div",{key:s.id,class:"entry-item"},[e("label",Rt,[e("input",{type:"checkbox",checked:ce(p.value.id,s.id),onChange:R=>me(p.value.id,s.id)},null,40,Mt),e("span",St,d(s.text),1),s.category?(i(),l("span",Vt,"("+d(s.category)+")",1)):h("",!0)])]))),128))]))]),e("div",Wt,[e("button",{type:"button",class:"paper-btn btn-primary btn-small",disabled:!Z(p.value.id),onClick:t[4]||(t[4]=s=>he(p.value.id))}," åŠ å…¥å·²å‹¾é¸ ",8,At),e("button",{type:"button",class:"paper-btn btn-secondary btn-small",onClick:t[5]||(t[5]=s=>te(p.value.id)),disabled:p.value.entry_count===0}," å…¨éƒ¨åŠ å…¥ ",8,Lt),Z(p.value.id)?(i(),l("button",{key:0,type:"button",class:"paper-btn btn-link btn-small",onClick:t[6]||(t[6]=s=>j(p.value.id))}," æ¸…é™¤ ")):h("",!0)])])):h("",!0),w.value?(i(),l("div",Tt,d(w.value),1)):h("",!0)]))])):h("",!0),n.value.gameMode==="classic"?(i(),l("div",Et,[t[16]||(t[16]=e("label",null,"è‡ªå®šç¾©è©èªï¼ˆè‡³å°‘ 6 å€‹ï¼Œæ”¯æŒä¸­è‹±æ–‡è©èªï¼‰",-1)),M(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=s=>n.value.wordsText=s),rows:"6",placeholder:`è¼¸å…¥è©èªï¼Œç”¨é€—è™Ÿï¼ˆï¼Œæˆ–,ï¼‰æˆ–æ›è¡Œåˆ†éš”
ä¾‹å¦‚ï¼šæ˜¥å¤©ï¼Œå‹èª¼ï¼Œå‹‡æ°£`,onInput:g,class:"words-textarea"},null,544),[[z,n.value.wordsText]]),e("div",Ht,[e("div",Ut," å·²è¼¸å…¥ "+d(L.value)+" å€‹è©èªï¼Œ"+d(G.value)+" / 600 å­—ç¬¦ ",1),L.value<6?(i(),l("div",zt," é‚„éœ€è¦ "+d(6-L.value)+" å€‹è©èª ",1)):h("",!0)])])):h("",!0),n.value.gameMode==="storyboard"?(i(),l("div",Gt,[...t[17]||(t[17]=[e("div",{class:"info-card"},[e("h4",null,"ğŸ“– åˆ†é¡æ¥é¾æ¨¡å¼èªªæ˜"),e("ul",null,[e("li",null,"ğŸ¨ åˆ†é¡å¸«æ ¹æ“šä¸Šä¸€é¡å‹å‡ºå¥å­ç¹ªç•«"),e("li",null,"âœï¸ ç·¨åŠ‡æ ¹æ“šç•«ä½œå‰µä½œä¸‹ä¸€å¥æ•…äº‹"),e("li",null,"ğŸ—³ï¸ æ‰€æœ‰ç©å®¶æŠ•ç¥¨é¸å‡ºæœ€ä½³å¥å­"),e("li",null,"ğŸ“š æœ€çµ‚ç”¢å‡ºä¸€å€‹åœ–æ–‡äº¤æ›¿çš„æ•…äº‹æ¿")]),e("p",{class:"info-note"},"âš ï¸ åˆ†é¡æ¨¡å¼éœ€è¦è‡³å°‘ 3 ä½ç©å®¶")],-1)])])):h("",!0),e("div",jt,[t[19]||(t[19]=e("h4",{class:"text-hand-title"},"éŠæˆ²è¨­ç½®",-1)),e("div",qt,[t[18]||(t[18]=e("label",null,"ç¹ªç•«æ™‚é–“ï¼ˆç§’ï¼‰",-1)),M(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>n.value.settings.draw_time=s),type:"number",min:"60",max:"180",required:""},null,512),[[z,n.value.settings.draw_time,void 0,{number:!0}]])])]),c.value?(i(),l("div",Nt,d(c.value),1)):h("",!0),e("div",Dt,[e("button",{type:"submit",disabled:o(C)||!X.value,class:"paper-btn btn-primary"},d(o(C)?"å‰µå»ºä¸­...":"å‰µå»ºæˆ¿é–“"),9,Ft),e("button",{type:"button",onClick:t[9]||(t[9]=s=>a.$emit("cancel")),class:"paper-btn btn-secondary"}," å–æ¶ˆ ")])],32)])])]))}}),Jt=D(Ot,[["__scopeId","data-v-32d46a81"]]),Bt={class:"room-join"},It={class:"card"},Pt={class:"card-body"},Qt={class:"form-group"},Kt={class:"form-group"},Xt={key:0,class:"alert alert-danger"},Yt={class:"row flex-spaces margin-top-medium"},Zt=["disabled"],es=N({__name:"RoomJoin",emits:["cancel","joined"],setup(F,{emit:r}){const v=r,{joinRoom:S,loading:C}=K(),b=Q(),_=x({code:"",nickname:b.profile?.display_name||""}),u=x(null);function H(n){const c=n.target;_.value.code=c.value.replace(/\D/g,"").slice(0,6),u.value=null}const V=E(()=>_.value.code.length===6&&_.value.nickname.trim().length>0&&_.value.nickname.length<=20);async function y(){if(!V.value){u.value="è«‹æª¢æŸ¥è¡¨å–®è¼¸å…¥";return}u.value=null;const n=await S(_.value.code,_.value.nickname.trim());n.success?v("joined"):u.value=n.error||"åŠ å…¥æˆ¿é–“å¤±æ•—"}return(n,c)=>(i(),l("div",Bt,[e("div",It,[e("div",Pt,[c[6]||(c[6]=e("h2",{class:"card-title text-hand-title"},"åŠ å…¥æˆ¿é–“",-1)),e("form",{onSubmit:q(y,["prevent"])},[e("div",Qt,[c[3]||(c[3]=e("label",null,"æˆ¿é–“ç¢¼",-1)),M(e("input",{"onUpdate:modelValue":c[0]||(c[0]=w=>_.value.code=w),type:"text",class:"text-center",style:{"font-size":"2rem","letter-spacing":"0.5rem"},placeholder:"000000",maxlength:"6",pattern:"[0-9]{6}",required:"",onInput:H},null,544),[[z,_.value.code]]),c[4]||(c[4]=e("div",{class:"text-small"}," è¼¸å…¥ 6 ä½æ•¸å­—æˆ¿é–“ç¢¼ ",-1))]),e("div",Kt,[c[5]||(c[5]=e("label",null,"æš±ç¨±",-1)),M(e("input",{"onUpdate:modelValue":c[1]||(c[1]=w=>_.value.nickname=w),type:"text",placeholder:"è¼¸å…¥æ‚¨çš„æš±ç¨±",maxlength:"20",required:""},null,512),[[z,_.value.nickname]])]),u.value?(i(),l("div",Xt,d(u.value),1)):h("",!0),e("div",Yt,[e("button",{type:"submit",disabled:o(C)||!V.value,class:"paper-btn btn-primary"},d(o(C)?"åŠ å…¥ä¸­...":"åŠ å…¥æˆ¿é–“"),9,Zt),e("button",{type:"button",onClick:c[2]||(c[2]=w=>n.$emit("cancel")),class:"paper-btn btn-secondary"}," å–æ¶ˆ ")])],32)])])]))}}),ts=D(es,[["__scopeId","data-v-35f98c69"]]),ss={class:"container margin-top-large"},os={class:"row flex-center"},as={class:"col-12 col-lg-10"},ns={class:"text-center margin-bottom-large"},ls={class:"text-hand-title",style:{"font-size":"2.25rem","margin-bottom":"1rem",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"}},is={key:0,class:"home-welcome-section"},ds={class:"welcome-card"},rs={class:"welcome-icon"},us={class:"welcome-auth"},cs={key:1,class:"margin-bottom-medium"},ms={key:2,class:"margin-bottom-medium"},vs={key:3},ps={key:0,class:"margin-bottom-medium"},_s={key:1,class:"margin-bottom-medium"},gs={key:2,class:"home-main-layout"},hs={class:"home-user-section"},bs={class:"user-info-card"},fs={class:"user-header"},ys=["src","alt"],ws={key:1,class:"user-avatar user-avatar-placeholder"},$s={class:"user-details"},ks={class:"user-name"},xs={class:"user-status"},Cs={key:0,class:"user-stats"},Rs={class:"stat-item"},Ms={class:"stat-value"},Ss={class:"user-actions"},Vs=["disabled"],Ws={class:"home-actions-section"},As={class:"actions-card"},Ls={class:"actions-buttons"},Ts={key:3,class:"home-main-layout"},Es={class:"home-auth-section"},Hs={class:"anonymous-upgrade-card"},Us=N({__name:"HomeView",setup(F){const r=$e(),{currentRoom:v,participants:S,leaveRoom:C,isHost:b}=K(),{subscribeRoom:_}=ke(),u=Q(),{isAdmin:H,refreshAdminStatus:V}=ue(),y=x(!1),n=x(!1);function c(g){y.value=!1,v.value&&r.push(`/room/${v.value.code}`)}function w(){n.value=!1,v.value&&r.push(`/room/${v.value.code}`)}function f(){console.log("[HomeView] æ”¶åˆ°éŠæˆ²é–‹å§‹äº‹ä»¶"),v.value&&r.push(`/room/${v.value.code}`)}async function p(){(await C()).success&&(y.value=!1,n.value=!1)}P(()=>v.value,g=>{g&&u.user&&_(g.code,g.id,u.user.id,{nickname:u.profile?.display_name||"ç©å®¶"})},{immediate:!0}),P(()=>v.value?.status,async(g,m)=>{if(console.log("[HomeView] æˆ¿é–“ç‹€æ…‹è®ŠåŒ–:",{oldStatus:m,newStatus:g,currentRoute:r.currentRoute.value.name,isHost:b.value}),v.value&&(g==="playing"||g==="finished")){const k=r.currentRoute.value;if(k.name!=="room"||k.params.code!==v.value.code){console.log("[HomeView] æº–å‚™è·³è½‰åˆ° RoomView:",v.value.code,"(isHost:",b.value,")");const L=`/room/${v.value.code}`;try{await r.push(L),console.log("[HomeView] è·¯ç”±è·³è½‰æˆåŠŸ")}catch(G){console.error("[HomeView] è·¯ç”±è·³è½‰éŒ¯èª¤:",G)}}else console.log("[HomeView] å·²åœ¨ RoomViewï¼Œç„¡éœ€è·³è½‰")}}),re(()=>{u.profile?.email&&V(!0)}),P(()=>u.profile?.email,g=>{g&&V(!0)});function $(){r.push("/word-library")}async function W(){const g=await u.signOut();g.success||console.error("ç™»å‡ºå¤±æ•—:",g.error)}function O(g){return g.toLocaleString("zh-TW")}return(g,m)=>(i(),l("div",ss,[e("div",os,[e("div",as,[e("div",ns,[e("h1",ls,[A(o(ie),{size:32,weight:"duotone",style:{color:"var(--color-primary)"}}),m[4]||(m[4]=we(" ä½ ç•«æˆ‘çŒœ ",-1))])]),o(u).isAuthenticated?h("",!0):(i(),l("div",is,[e("div",ds,[e("div",rs,[A(o(ie),{size:48,weight:"duotone"})]),m[5]||(m[5]=e("p",{class:"welcome-text"},"èˆ‡æœ‹å‹ä¸€èµ·ç•«ç•«çŒœè©ï¼Œè€ƒé©—é»˜å¥‘ï¼",-1)),e("div",us,[A(de)]),m[6]||(m[6]=e("p",{class:"welcome-hint"},"ä½¿ç”¨ Google å¸³è™Ÿç™»å…¥å³å¯é–‹å§‹éŠæˆ²",-1))])])),o(v)&&o(v).status==="waiting"?(i(),l("div",cs,[A(xe,{room:o(v),participants:o(S),onStartGame:f,onLeaveRoom:p},null,8,["room","participants"])])):o(v)&&(o(v).status==="playing"||o(v).status==="finished")?(i(),l("div",ms,[...m[7]||(m[7]=[e("div",{class:"text-center"},[e("p",{class:"text-hand"},"æ­£åœ¨è·³è½‰åˆ°éŠæˆ²æˆ¿é–“...")],-1)])])):(i(),l("div",vs,[y.value?(i(),l("div",ps,[A(Jt,{onCreated:c,onCancel:m[0]||(m[0]=()=>{console.log("å–æ¶ˆå‰µå»ºæˆ¿é–“"),y.value=!1})})])):n.value?(i(),l("div",_s,[A(ts,{onJoined:w,onCancel:m[1]||(m[1]=k=>n.value=!1)})])):o(u).isRegistered?(i(),l("div",gs,[e("div",hs,[e("div",bs,[e("div",fs,[o(u).profile?.avatar_url?(i(),l("img",{key:0,src:o(u).profile.avatar_url,alt:o(u).profile.display_name,class:"user-avatar"},null,8,ys)):(i(),l("div",ws,d(o(u).profile?.display_name?.charAt(0)||"?"),1)),e("div",$s,[e("div",ks,d(o(u).profile?.display_name||"ç”¨æˆ¶"),1),e("div",xs,d(o(u).isAnonymous?"åŒ¿åéŠç©":"å·²ç™»å…¥"),1)])]),o(u).isRegistered&&o(u).profile?(i(),l("div",Cs,[e("div",Rs,[m[8]||(m[8]=e("span",{class:"stat-label"},"ç¸½ç©åˆ†",-1)),e("span",Ms,d(O(o(u).profile.total_score||0)),1)])])):h("",!0),e("div",Ss,[e("button",{onClick:W,disabled:o(u).loading,class:"paper-btn btn-small btn-block"},d(o(u).loading?"è™•ç†ä¸­...":"ç™»å‡º"),9,Vs)])])]),e("div",Ws,[e("div",As,[e("div",Ls,[e("button",{onClick:m[2]||(m[2]=k=>y.value=!0),class:"paper-btn btn-primary btn-block margin-bottom-small"}," å‰µå»ºæˆ¿é–“ "),e("button",{onClick:m[3]||(m[3]=k=>n.value=!0),class:"paper-btn btn-secondary btn-block margin-bottom-small"}," åŠ å…¥æˆ¿é–“ "),o(H)?(i(),l("button",{key:0,class:"paper-btn btn-warning btn-block",onClick:$}," è©å¥åº«ç®¡ç† ")):h("",!0)])])])])):o(u).isAuthenticated&&!o(u).isRegistered?(i(),l("div",Ts,[e("div",Es,[e("div",Hs,[m[9]||(m[9]=e("p",{class:"text-hand"},"æ‚¨ç›®å‰æ˜¯åŒ¿åç”¨æˆ¶",-1)),m[10]||(m[10]=e("p",{class:"text-small text-secondary"},"ä½¿ç”¨ Google ç™»å…¥ä»¥ä¿å­˜éŠæˆ²è¨˜éŒ„",-1)),A(de)])])])):h("",!0)]))])])]))}}),qs=D(Us,[["__scopeId","data-v-25d6219d"]]);export{qs as default};
