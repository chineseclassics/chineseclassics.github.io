# Scoring System - Change Deltas

## ADDED Requirements

### Requirement: 猜中得分計算
系統 SHALL 根據猜中順序計算分數。

#### Scenario: 猜中順序分數
- 第一個猜中：100% 基礎分數
- 第二個猜中：80% 基礎分數
- 第三個猜中：60% 基礎分數
- 第四個猜中：40% 基礎分數
- 第五個及以後：20% 基礎分數（最低）

#### Scenario: 基礎分數計算
- 基礎分數 = 100 分（可配置）
- 實際得分 = 基礎分數 × 順序係數
- 分數四捨五入到整數

#### Scenario: 分數記錄
- 猜中時，立即計算分數
- 分數保存到 `guesses` 表的 `score_earned` 字段
- 分數累加到玩家的總分數

### Requirement: 繪畫得分計算
系統 SHALL 根據猜中玩家數量計算畫家得分。

#### Scenario: 繪畫得分計算
- 基礎分數 = 50 分（可配置）
- 每有一個玩家猜中，額外加 10 分
- 繪畫得分 = 基礎分數 + (猜中玩家數量 × 10)
- 如果沒有人猜中，繪畫得分 = 0

#### Scenario: 繪畫得分記錄
- 輪次結束時，計算畫家得分
- 分數保存到 `game_rounds` 表（可選）
- 分數累加到畫家的總分數

### Requirement: 獲勝獎勵
系統 SHALL 為獲勝玩家提供額外獎勵。

#### Scenario: 獲勝判定
- 遊戲結束時，分數最高的玩家獲勝
- 如果分數相同，猜中次數多的玩家獲勝
- 如果仍然相同，繪畫次數多的玩家獲勝

#### Scenario: 獲勝獎勵
- 獲勝玩家額外獲得 100 分（可配置）
- 獲勝獎勵在最終排名時顯示
- 獲勝獎勵不影響遊戲過程中的分數

### Requirement: 分數顯示
系統 SHALL 實時顯示玩家分數。

#### Scenario: 實時分數更新
- 玩家猜中後，立即更新分數
- 分數顯示在玩家信息區域
- 分數更新有輕微的動畫效果（優雅）

#### Scenario: 分數排行榜
- 顯示所有玩家的分數排名
- 排行榜按分數從高到低排序
- 排行榜實時更新
- 排行榜低調設計（不搶奪畫作焦點）

#### Scenario: 最終排名
- 遊戲結束時，顯示最終排名
- 排名顯示：名次、玩家暱稱、總分數
- 標記獲勝玩家（特殊標識）
- 最終排名界面可以分享或再玩一次

### Requirement: 分數數據庫操作
系統 SHALL 保存分數記錄到數據庫。

#### Scenario: 分數保存
- 每輪結束時，更新玩家的總分數
- 分數保存到 `room_participants` 表的 `score` 字段
- 分數累加（不覆蓋）

#### Scenario: 分數查詢
- 查詢房間內所有玩家的分數
- 查詢玩家在當前房間的總分數
- 查詢玩家在每輪的得分

