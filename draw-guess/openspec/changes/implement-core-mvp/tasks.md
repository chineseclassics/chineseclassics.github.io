# Implementation Tasks: implement-core-mvp

## Phase 1: 項目基礎設置

- [ ] 創建項目文件結構
  - [ ] 創建 `index.html`（主入口）
  - [ ] 創建 `room.html`（遊戲房間頁面）
  - [ ] 創建 `js/` 目錄結構（core/, features/, ui/）
  - [ ] 創建 `css/` 目錄
  - [ ] 創建 `assets/` 目錄
  - [ ] 創建 `supabase/` 目錄結構

- [ ] 配置 Supabase
  - [ ] 創建 Supabase 項目
  - [ ] 配置 Google OAuth
  - [ ] 獲取 Project URL 和 Anon Key
  - [ ] 創建 `js/config.js` 配置文件

- [ ] 設置基礎 HTML 和樣式
  - [ ] 創建 `index.html` 基礎結構
  - [ ] 引入 Tailwind CSS 和 Font Awesome
  - [ ] 引入太虛幻境應用切換器組件
  - [ ] 創建基礎 CSS 文件（極簡風格、低調配色）

## Phase 2: 數據庫架構

- [ ] 設計數據庫架構
  - [ ] 設計 `users` 表（UUID 主鍵）
  - [ ] 設計 `user_identities` 表（多重身份）
  - [ ] 設計 `game_rooms` 表
  - [ ] 設計 `room_participants` 表
  - [ ] 設計 `game_rounds` 表
  - [ ] 設計 `guesses` 表

- [ ] 實施數據庫遷移
  - [ ] 創建遷移文件 `001_initial_schema.sql`
  - [ ] 在 Supabase Dashboard 執行遷移
  - [ ] 配置 RLS 策略
  - [ ] 測試數據庫連接

## Phase 3: 用戶系統

- [ ] 實現 Supabase 客戶端
  - [ ] 創建 `js/supabase-client.js`
  - [ ] 初始化 Supabase 客戶端
  - [ ] 實現認證狀態監聽

- [ ] 實現匿名遊玩模式
  - [ ] 創建匿名會話
  - [ ] 保存匿名用戶信息（暱稱）
  - [ ] 實現匿名用戶標識

- [ ] 實現 Google OAuth 登入
  - [ ] 創建 `js/auth/` 目錄
  - [ ] 實現 Google 登入流程
  - [ ] 實現登出功能
  - [ ] 實現用戶資料管理

- [ ] 實現用戶資料 UI
  - [ ] 登入/登出按鈕
  - [ ] 用戶信息顯示
  - [ ] 登入狀態管理

## Phase 4: 房間系統

- [ ] 實現房間管理核心邏輯
  - [ ] 創建 `js/core/room-manager.js`
  - [ ] 實現房間創建功能（生成 6 位房間碼）
  - [ ] 實現房間加入功能（通過房間碼）
  - [ ] 實現房間離開功能
  - [ ] 實現房間狀態管理

- [ ] 實現房間數據庫操作
  - [ ] 創建房間（插入 `game_rooms` 表）
  - [ ] 加入房間（插入 `room_participants` 表）
  - [ ] 查詢房間信息
  - [ ] 更新房間狀態

- [ ] 實現房間 UI
  - [ ] 房間列表界面（`index.html`）
  - [ ] 創建房間界面（表單、設置）
  - [ ] 加入房間界面（房間碼輸入）
  - [ ] 等待大廳界面（玩家列表、開始按鈕）

## Phase 5: 繪畫系統

- [ ] 實現 Canvas 繪圖基礎
  - [ ] 創建 `js/features/drawing-canvas.js`
  - [ ] 初始化 Canvas 元素
  - [ ] 實現鼠標繪畫（mousedown, mousemove, mouseup）
  - [ ] 實現觸摸繪畫（touchstart, touchmove, touchend）
  - [ ] 實現畫筆繪製邏輯

- [ ] 實現繪畫工具
  - [ ] 畫筆工具（顏色選擇、粗細調整）
  - [ ] 橡皮擦工具
  - [ ] 清空畫布功能
  - [ ] 工具欄 UI

- [ ] 實現繪畫數據序列化
  - [ ] 繪畫筆觸數據結構設計
  - [ ] 序列化繪畫數據（JSON）
  - [ ] 反序列化繪畫數據（重繪）
  - [ ] 數據壓縮優化

- [ ] 實現繪畫實時同步
  - [ ] 使用 Supabase Realtime broadcast
  - [ ] 節流處理（減少傳輸頻率）
  - [ ] 接收其他玩家的繪畫數據
  - [ ] 實時重繪畫作

## Phase 6: 猜詞系統

- [ ] 實現猜詞核心邏輯
  - [ ] 創建 `js/features/guessing-system.js`
  - [ ] 實現詞語輸入（支持中文）
  - [ ] 實現匹配判斷（精確匹配）
  - [ ] 實現猜中處理

- [ ] 實現提示系統
  - [ ] 提示數據結構（詞語、提示列表）
  - [ ] 提示顯示邏輯（逐步顯示）
  - [ ] 提示 UI

- [ ] 實現猜詞數據庫操作
  - [ ] 保存猜詞記錄（插入 `guesses` 表）
  - [ ] 查詢猜中玩家列表
  - [ ] 更新遊戲輪次狀態

- [ ] 實現猜詞 UI
  - [ ] 猜詞輸入框
  - [ ] 已猜中玩家列表
  - [ ] 提示顯示區域

## Phase 7: 計分系統

- [ ] 實現計分核心邏輯
  - [ ] 創建 `js/features/scoring-system.js`
  - [ ] 實現猜中得分計算（根據順序：100%, 80%, 60%...）
  - [ ] 實現繪畫得分計算（根據猜中玩家數量）
  - [ ] 實現獲勝獎勵計算

- [ ] 實現分數顯示
  - [ ] 實時分數更新
  - [ ] 分數排行榜 UI
  - [ ] 最終排名顯示

## Phase 8: 實時同步

- [ ] 實現實時同步核心
  - [ ] 創建 `js/core/realtime-sync.js`
  - [ ] 實現 Supabase Realtime Channels 連接
  - [ ] 實現房間狀態同步（postgres_changes）
  - [ ] 實現繪畫數據同步（broadcast）
  - [ ] 實現猜詞結果同步（postgres_changes）

- [ ] 實現連接管理
  - [ ] 連接狀態監聽
  - [ ] 連接重試機制
  - [ ] 錯誤處理和降級方案

## Phase 9: 遊戲流程

- [ ] 實現遊戲狀態管理
  - [ ] 創建 `js/core/game-state.js`
  - [ ] 實現遊戲狀態機（waiting → playing → finished）
  - [ ] 實現輪次管理（當前輪次、當前畫家）
  - [ ] 實現詞語選擇（畫家選擇詞語）

- [ ] 實現遊戲流程控制
  - [ ] 開始遊戲邏輯
  - [ ] 輪次切換邏輯
  - [ ] 結束遊戲邏輯
  - [ ] 倒計時功能

## Phase 10: 核心 UI

- [ ] 實現房間列表 UI
  - [ ] 房間卡片設計（極簡風格）
  - [ ] 創建房間按鈕
  - [ ] 加入房間按鈕

- [ ] 實現遊戲界面 UI
  - [ ] 畫布區域（占據主要空間）
  - [ ] 工具欄（低調設計）
  - [ ] 猜詞區域（輸入框、提示）
  - [ ] 玩家信息區域（排行榜、當前畫家）
  - [ ] 倒計時顯示

- [ ] 實現等待大廳 UI
  - [ ] 玩家列表
  - [ ] 房間設置顯示
  - [ ] 開始遊戲按鈕（僅房主可見）

- [ ] 應用極簡設計風格
  - [ ] 低調配色（灰色系、米色）
  - [ ] 細線條邊框
  - [ ] 極少裝飾元素
  - [ ] 突出畫作和文字

## Phase 11: 測試和優化

- [ ] 功能測試
  - [ ] 測試房間創建和加入
  - [ ] 測試繪畫功能（桌面端）
  - [ ] 測試猜詞功能
  - [ ] 測試實時同步（多設備）
  - [ ] 測試計分系統

- [ ] 性能優化
  - [ ] 繪畫數據壓縮優化
  - [ ] 實時同步節流優化
  - [ ] 頁面加載優化

- [ ] 錯誤處理
  - [ ] 網絡錯誤處理
  - [ ] 連接失敗處理
  - [ ] 用戶友好的錯誤提示

## Phase 12: 文檔和部署

- [ ] 更新文檔
  - [ ] 更新 README.md
  - [ ] 創建部署指南
  - [ ] 創建使用說明

- [ ] 部署準備
  - [ ] 檢查所有功能
  - [ ] 測試生產環境
  - [ ] 準備部署說明

