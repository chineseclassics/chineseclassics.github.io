# æ ¼å¼è§„èŒƒç³»ç»Ÿæ¶æ„æ–‡æ¡£

> **æ—¶æ–‡å®é‰´** - ä¸¤å±‚æ ¼å¼è§„èŒƒæ¶æ„è®¾è®¡

**ç‰ˆæœ¬**ï¼š1.0  
**åˆ›å»ºæ—¥æœŸ**ï¼š2025-10-19  
**çŠ¶æ€**ï¼šå·²å®ç°ï¼ˆé˜¶æ®µ 2ï¼‰

---

## ğŸ¯ æ¶æ„æ¦‚è¿°

### ä¸¤å±‚ç³»ç»Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ä¸€å±‚ï¼šç³»ç»Ÿå†…ç½®æ ¼å¼                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  å­˜å‚¨ä½ç½®ï¼šassets/data/format-specs/    â”‚
â”‚  ç®¡ç†æ–¹å¼ï¼šGit ç‰ˆæœ¬æ§åˆ¶                  â”‚
â”‚  åŠ è½½æ–¹å¼ï¼šæœ¬åœ°æ–‡ä»¶ / CDN                â”‚
â”‚  é€‚ç”¨åœºæ™¯ï¼šé€šç”¨è®ºæ–‡æ ¼å¼                  â”‚
â”‚                                         â”‚
â”‚  - çº¢æ¥¼æ¢¦è®ºæ–‡æ ¼å¼ âœ… å·²å®ç°              â”‚
â”‚  - IB EE è®ºæ–‡æ ¼å¼ ğŸ“ å¾…åˆ›å»º              â”‚
â”‚  - è®®è®ºæ–‡æ ¼å¼ ğŸ“ å¾…åˆ›å»º                  â”‚
â”‚  - è¯´æ˜æ–‡æ ¼å¼ ğŸ“ å¾…åˆ›å»º                  â”‚
â”‚  - è®°å™æ–‡æ ¼å¼ ğŸ“ å¾…åˆ›å»º                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬äºŒå±‚ï¼šè€å¸ˆè‡ªå®šä¹‰æ ¼å¼                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  å­˜å‚¨ä½ç½®ï¼šSupabase æ•°æ®åº“               â”‚
â”‚  ç®¡ç†æ–¹å¼ï¼šWeb UI + API                  â”‚
â”‚  åŠ è½½æ–¹å¼ï¼šæ•°æ®åº“æŸ¥è¯¢                    â”‚
â”‚  é€‚ç”¨åœºæ™¯ï¼šä¸ªæ€§åŒ–æ•™å­¦éœ€æ±‚                â”‚
â”‚                                         â”‚
â”‚  é€‰é¡¹ Aï¼šåŸºäºç³»ç»Ÿæ ¼å¼ä¿®æ”¹ ğŸ“ é˜¶æ®µ 3       â”‚
â”‚  é€‰é¡¹ Bï¼šå®Œå…¨è‡ªå®šä¹‰ ğŸ“ é˜¶æ®µ 3            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ JSON Schema è®¾è®¡

### å®Œæ•´çš„æ ¼å¼è§„èŒƒç»“æ„

```json
{
  "metadata": {
    "id": "honglou-essay",           // å”¯ä¸€æ ‡è¯†ç¬¦
    "name": "çº¢æ¥¼æ¢¦è®ºæ–‡æ ¼å¼è§„èŒƒ",     // æ˜¾ç¤ºåç§°
    "version": "1.0",                 // ç‰ˆæœ¬å·
    "type": "system",                 // system æˆ– custom
    "category": "æ–‡å­¦åˆ†æ",           // åˆ†ç±»
    "target_audience": "åå¹´çº§å­¦ç”Ÿ",  // ç›®æ ‡ç”¨æˆ·
    "essay_type": "å­¦æœ¯è®ºæ–‡ï¼ˆæ–‡å­¦åˆ†æï¼‰",
    "word_count": "1500-2500å­—",
    "description": "..."
  },
  
  "paragraph_types": {
    "introduction": {
      "name": "å¼•è¨€æ®µ",
      "purpose": "å¸å¼•è¯»è€…ã€ç¡®ç«‹ä¸»é¢˜ã€æ¦‚è¿°è®ºç‚¹",
      
      // âœ¨ æ ¸å¿ƒï¼šåˆ†æç»´åº¦ï¼ˆé©±åŠ¨ AI åé¦ˆï¼‰
      "analysis_dimensions": [
        {
          "id": "structure_completeness",   // ç»´åº¦ ID
          "name": "ç»“æ„å®Œæ•´æ€§",              // æ˜¾ç¤ºåç§°
          "weight": 0.4,                    // æƒé‡ï¼ˆ0-1ï¼‰
          "description": "æ£€æŸ¥æ˜¯å¦åŒ…å«æ‰€æœ‰å¿…éœ€å…ƒç´ ",
          "checks": [                       // æ£€æŸ¥é¡¹åˆ—è¡¨
            "æ˜¯å¦åŒ…å«èƒŒæ™¯å¼•å…¥ï¼ˆHookï¼‰ï¼Ÿ",
            "æ˜¯å¦å®šä¹‰äº†å…³é”®æ¦‚å¿µï¼Ÿ",
            "æ˜¯å¦æŒ‡å‡ºç ”ç©¶ç¼ºå£ï¼Ÿ"
          ]
        },
        {
          "id": "thesis_clarity",
          "name": "è®ºæ–‡ä¸»å¼ æ¸…æ™°åº¦",
          "weight": 0.4,
          "checks": [...]
        },
        {
          "id": "roadmap",
          "name": "ç»“æ„é¢„å‘Š",
          "weight": 0.2,
          "checks": [...]
        }
      ],
      
      // å¿…éœ€å…ƒç´ ï¼ˆç»“æ„æ£€æŸ¥ï¼‰
      "required_elements": [
        {
          "id": "hook",
          "name": "èƒŒæ™¯å¼•å…¥ (Hook)",
          "required": true,
          "position": "å¼€å¤´ 1-2 å¥",
          "description": "ä»è¾ƒå¹¿æ³›çš„èƒŒæ™¯åˆ‡å…¥...",
          "keywords": ["ã€Šçº¢æ¥¼æ¢¦ã€‹", "è‰ºæœ¯æˆå°±"],
          "markers": [],
          "check_points": [...]
        }
      ],
      
      // å¸¸è§é”™è¯¯
      "common_errors": [...]
    },
    
    "body_paragraph": {
      "analysis_dimensions": [
        {
          "id": "topic_sentence",
          "name": "ä¸»é¢˜å¥",
          "weight": 0.2
        },
        {
          "id": "textual_evidence",
          "name": "æ–‡æœ¬è¯æ®",
          "weight": 0.3
        },
        {
          "id": "close_reading",
          "name": "æ–‡æœ¬ç»†è¯»",
          "weight": 0.5
        }
      ]
    },
    
    "conclusion": {
      "analysis_dimensions": [
        {
          "id": "restate_thesis",
          "name": "é‡ç”³ä¸»å¼ ",
          "weight": 0.3
        },
        {
          "id": "summarize_points",
          "name": "æ€»ç»“åˆ†è®ºç‚¹",
          "weight": 0.3
        },
        {
          "id": "broader_implications",
          "name": "å¼•ç”³æ€è€ƒ",
          "weight": 0.4
        }
      ]
    }
  }
}
```

---

## ğŸ”„ å·¥ä½œæµç¨‹

### å­¦ç”Ÿè·å– AI åé¦ˆçš„å®Œæ•´æµç¨‹

```
1. å­¦ç”Ÿç‚¹å‡»"AI åé¦ˆ"æŒ‰é’®
   â†“
2. å‰ç«¯ï¼šåŠ è½½æ ¼å¼è§„èŒƒ
   - è°ƒç”¨ loadHonglouFormatSpec()
   - ä» assets/data/honglou-essay-format.json åŠ è½½
   - ç¼“å­˜åˆ°å†…å­˜
   â†“
3. å‰ç«¯ï¼šè°ƒç”¨ Edge Function
   - ä¼ é€’å‚æ•°ï¼š
     * paragraph_id: "intro"
     * paragraph_content: "<p>...</p>"
     * paragraph_type: "introduction"
     * format_spec: { å®Œæ•´çš„ JSON }
   â†“
4. Edge Functionï¼šå¤„ç†è¯·æ±‚
   
   4.1 è¯†åˆ«æ®µè½ç±»å‹
       paragraphRules = identifyParagraphRules("introduction", formatSpec)
       â†’ å¾—åˆ° introduction çš„å®Œæ•´å®šä¹‰
   
   4.2 ç»“æ„æ£€æŸ¥
       structuralFeedback = performStructuralCheck(content, type, paragraphRules)
       â†’ æ£€æŸ¥ required_elements
       â†’ è®¡ç®—å®Œæ•´åº¦
       â†’ è¿”å›ï¼š{completeness: 40%, missing_elements: [...]}
   
   4.3 æ„å»º AI æç¤ºè¯ï¼ˆâœ… åŸºäº JSONï¼‰
       prompt = buildAnalysisPrompt(content, type, paragraphRules, structural)
       â†’ ä» paragraphRules.analysis_dimensions è¯»å–ç»´åº¦
       â†’ ä¸ºæ¯ä¸ªç»´åº¦æ„å»ºæ£€æŸ¥é¡¹
       â†’ ç”ŸæˆåŠ¨æ€çš„ JSON æ ¼å¼è¦æ±‚
   
   4.4 è°ƒç”¨ DeepSeek API
       â†’ ä¼ é€’æç¤ºè¯
       â†’ AI æŒ‰ç…§ JSON å®šä¹‰çš„ç»´åº¦åˆ†æ
       â†’ è¿”å›ï¼š{
           structure_completeness: {score: 6, issues: [...]},
           thesis_clarity: {score: 4, issues: [...]},
           roadmap: {score: 0, issues: [...]}
         }
   
   4.5 å¥å­çº§é—®é¢˜å®šä½
       â†’ åŠ¨æ€å¤„ç†æ‰€æœ‰ç»´åº¦çš„ issues
       â†’ åˆå¹¶æˆç»Ÿä¸€çš„é—®é¢˜åˆ—è¡¨
   
   4.6 ç”Ÿæˆæ”¹è¿›å»ºè®®
       â†’ æ ¹æ®ç»´åº¦ ID åŒ¹é…å»ºè®®æ¨¡æ¿
       â†’ è¿”å›å…·ä½“çš„æ”¹è¿›æ–¹å‘
   
   4.7 è¯„åˆ†é¢„ä¼°
       â†’ åŸºäºæ‰€æœ‰ç»´åº¦çš„å¹³å‡åˆ†
       â†’ è®¡ç®— IB æ ‡å‡† A/B/C/D
   â†“
5. å‰ç«¯ï¼šæ¸²æŸ“åé¦ˆ
   - æ˜¾ç¤ºç»“æ„å®Œæ•´åº¦è¿›åº¦æ¡
   - æ˜¾ç¤ºå¥å­çº§é—®é¢˜åˆ—è¡¨
   - æ˜¾ç¤ºæ”¹è¿›å»ºè®®
   - ï¼ˆå¯é€‰ï¼‰æ˜¾ç¤ºè¯¦ç»†åˆ†æ
```

---

## ğŸ“Š ä¸åŒæ®µè½ç±»å‹çš„åˆ†æç»´åº¦

### å¼•è¨€æ®µï¼ˆIntroductionï¼‰

| ç»´åº¦ ID | åç§° | æƒé‡ | æ£€æŸ¥å†…å®¹ |
|---------|------|------|----------|
| `structure_completeness` | ç»“æ„å®Œæ•´æ€§ | 40% | Hookã€å®šä¹‰ã€ç ”ç©¶ç¼ºå£ |
| `thesis_clarity` | è®ºæ–‡ä¸»å¼ æ¸…æ™°åº¦ | 40% | æ ¸å¿ƒé—®é¢˜ã€è®ºæ–‡ä¸»å¼  |
| `roadmap` | ç»“æ„é¢„å‘Š | 20% | åˆ†è®ºç‚¹é¢„å‘Šã€åºæ•°è¯ |

**ä¸æ£€æŸ¥**ï¼šæ–‡æœ¬è¯æ®ã€æ–‡æœ¬ç»†è¯»ï¼ˆé‚£æ˜¯æ­£æ–‡æ®µçš„è¦æ±‚ï¼‰

### æ­£æ–‡æ®µï¼ˆBody Paragraphï¼‰

| ç»´åº¦ ID | åç§° | æƒé‡ | æ£€æŸ¥å†…å®¹ |
|---------|------|------|----------|
| `topic_sentence` | ä¸»é¢˜å¥ | 20% | ä½ç½®ã€æ¸…æ™°åº¦ã€è¿æ¥è¯ |
| `textual_evidence` | æ–‡æœ¬è¯æ® | 30% | å¼•ç”¨åŸæ–‡ã€å‡†ç¡®æ€§ã€å……åˆ†æ€§ |
| `close_reading` | æ–‡æœ¬ç»†è¯» | 50% | å­—è¯å¥åˆ†æã€æ·±åº¦ã€é¿å…ç©ºæ³› |

**ä¸æ£€æŸ¥**ï¼šç»“æ„é¢„å‘Šã€ç ”ç©¶ç¼ºå£ï¼ˆé‚£æ˜¯å¼•è¨€æ®µçš„è¦æ±‚ï¼‰

### ç»“è®ºæ®µï¼ˆConclusionï¼‰

| ç»´åº¦ ID | åç§° | æƒé‡ | æ£€æŸ¥å†…å®¹ |
|---------|------|------|----------|
| `restate_thesis` | é‡ç”³ä¸»å¼  | 30% | é‡ç”³ã€ä¸åŒæªè¾ |
| `summarize_points` | æ€»ç»“åˆ†è®ºç‚¹ | 30% | å›é¡¾ã€ç®€æ´ |
| `broader_implications` | å¼•ç”³æ€è€ƒ | 40% | So Whatã€æ ¼å±€æå‡ |

**ä¸æ£€æŸ¥**ï¼šæ–‡æœ¬è¯æ®ã€ä¸»é¢˜å¥ï¼ˆé‚£æ˜¯å…¶ä»–æ®µè½çš„è¦æ±‚ï¼‰

---

## âœ… å…³é”®æ”¹è¿›

### æ”¹è¿› 1ï¼šå®Œå…¨åŸºäº JSON âœ…

**ä¹‹å‰**ï¼ˆé˜¶æ®µ 2 åˆç‰ˆï¼‰ï¼š
```typescript
// âŒ ç¡¬ç¼–ç çš„åˆ†æç»´åº¦
if (paragraphType === 'introduction') {
  return {
    description: `1. structure_completeness...`  // å†™æ­»çš„
  }
}
```

**ç°åœ¨**ï¼š
```typescript
// âœ… ä» JSON è¯»å–åˆ†æç»´åº¦
const analysisDimensions = rules.analysis_dimensions || []

const dimensionsDesc = analysisDimensions
  .map(dim => `${dim.id}ï¼ˆ${dim.name}ï¼‰
    ${dim.checks.map(c => `- ${c}`).join('\n')}
  `)
```

### æ”¹è¿› 2ï¼šåŠ¨æ€æç¤ºè¯ç”Ÿæˆ âœ…

AI æç¤ºè¯ç°åœ¨åŒ…å«ï¼š
- âœ… ç»´åº¦æ•°é‡ï¼ˆä» JSON è¯»å–ï¼‰
- âœ… æ¯ä¸ªç»´åº¦çš„æ£€æŸ¥é¡¹ï¼ˆä» JSON è¯»å–ï¼‰
- âœ… æƒé‡ä¿¡æ¯ï¼ˆä» JSON è¯»å–ï¼‰
- âœ… è¿”å›çš„ JSON æ ¼å¼ï¼ˆåŠ¨æ€ç”Ÿæˆï¼‰

### æ”¹è¿› 3ï¼šç»´åº¦åç§°çµæ´» âœ…

**æ”¯æŒä»»ä½•ç»´åº¦åç§°**ï¼š
- `structure_completeness`ï¼ˆå¼•è¨€ï¼‰
- `topic_sentence`ï¼ˆæ­£æ–‡ï¼‰
- `restate_thesis`ï¼ˆç»“è®ºï¼‰
- å°†æ¥è€å¸ˆè‡ªå®šä¹‰çš„ä»»ä½•ç»´åº¦

---

## ğŸš€ éƒ¨ç½²å’Œæµ‹è¯•

### æ­¥éª¤ 1ï¼šé‡æ–°éƒ¨ç½² Edge Function

```bash
supabase functions deploy ai-feedback-agent
```

æˆ–åœ¨ Dashboard ä¸­ç²˜è´´æ›´æ–°åçš„ä»£ç ã€‚

### æ­¥éª¤ 2ï¼šæµ‹è¯•å¼•è¨€æ®µåé¦ˆ

è¾“å…¥å†…å®¹ï¼š
```
ã€Šç´…æ¨“å¤¢ã€‹æ˜¯ä¸­åœ‹å¤å…¸å°èªªçš„å·”å³°ä¹‹ä½œã€‚æ—é»›ç‰æ˜¯æ›¸ä¸­çš„é‡è¦äººç‰©ã€‚
```

**é¢„æœŸåé¦ˆ**ï¼ˆç°åœ¨åº”è¯¥ç²¾å‡†äº†ï¼‰ï¼š

âœ… **ç»“æ„å®Œæ•´æ€§** (structure_completeness)ï¼š
- ç¼ºå°‘ï¼šå…³é”®è¯å®šä¹‰
- ç¼ºå°‘ï¼šç ”ç©¶ç¼ºå£
- ç¼ºå°‘ï¼šæ ¸å¿ƒé—®é¢˜ä¸è®ºæ–‡ä¸»å¼ 

âœ… **è®ºæ–‡ä¸»å¼ æ¸…æ™°åº¦** (thesis_clarity)ï¼š
- æœªæ˜ç¡®æå‡ºæ ¸å¿ƒé—®é¢˜
- æœªç”¨ä¸€å¥è¯é™ˆè¿°è®ºæ–‡ä¸»å¼ 

âœ… **ç»“æ„é¢„å‘Š** (roadmap)ï¼š
- æœªé¢„å‘Šæ­£æ–‡ç»“æ„

âŒ **ä¸åº”è¯¥å‡ºç°**ï¼š
- ~~æ–‡æœ¬è¯æ®~~
- ~~æ–‡æœ¬ç»†è¯»~~
- ~~å¼•ç”¨åŸæ–‡~~

---

## ğŸ“‚ ç›¸å…³æ–‡ä»¶æ¸…å•

### å·²æ›´æ–°çš„æ–‡ä»¶

1. **æ ¼å¼è§„èŒƒ JSON**ï¼š
   - `assets/data/honglou-essay-format.json` âœ…
   - æ·»åŠ äº† `analysis_dimensions` åˆ°ä¸‰ç§æ®µè½ç±»å‹

2. **Edge Function**ï¼š
   - `supabase/functions/ai-feedback-agent/index.ts` âœ…
   - å®Œå…¨åŸºäº JSON çš„ `analysis_dimensions`
   - åŠ¨æ€ç”Ÿæˆ AI æç¤ºè¯
   - åŠ¨æ€å¤„ç†åé¦ˆç»“æœ

3. **å‰ç«¯åŠ è½½å™¨**ï¼š
   - `js/data/format-spec-loader.js` âœ…
   - åŠ è½½å¹¶ç¼“å­˜æ ¼å¼è§„èŒƒ

4. **OpenSpec æ–‡æ¡£**ï¼š
   - `openspec/changes/shiwen-baojian-mvp/proposal.md` âœ…
   - `openspec/specs/format-specification-system/spec.md` âœ…
   - `openspec/specs/format-specification-system/design.md` âœ…

---

## ğŸ“ è®¾è®¡åŸåˆ™

### 1. å®Œæ•´ç‹¬ç«‹ âœ…

æ¯ä¸ªç³»ç»Ÿæ ¼å¼éƒ½æ˜¯å®Œæ•´çš„ JSONï¼Œä¸ä¾èµ–ç»§æ‰¿ï¼š
- çº¢æ¥¼æ¢¦è®ºæ–‡æ ¼å¼ = å®Œæ•´ç‹¬ç«‹
- IB EE è®ºæ–‡æ ¼å¼ = å®Œæ•´ç‹¬ç«‹
- è®®è®ºæ–‡æ ¼å¼ = å®Œæ•´ç‹¬ç«‹

**åŸå› **ï¼š
- ç®€å•æ˜“æ‡‚
- æ˜“äºè°ƒè¯•
- ä¸åŒæ ¼å¼å·®å¼‚å¤§ï¼Œç»§æ‰¿å¤ç”¨ä»·å€¼æœ‰é™

### 2. AI é©±åŠ¨ âœ…

`analysis_dimensions` ç›´æ¥é©±åŠ¨ AI åˆ†æï¼š
- ç»´åº¦ ID â†’ AI åˆ†æçš„æ–¹é¢
- æ£€æŸ¥é¡¹ â†’ AI åˆ†æçš„å…·ä½“é—®é¢˜
- æƒé‡ â†’ AI è¯„åˆ†çš„æƒé‡

### 3. çµæ´»æ‰©å±• âœ…

**æ·»åŠ æ–°çš„ç³»ç»Ÿæ ¼å¼**ï¼š
1. åˆ›å»ºæ–°çš„ JSON æ–‡ä»¶
2. å®šä¹‰ `analysis_dimensions`
3. æ— éœ€ä¿®æ”¹ä»£ç 

**è€å¸ˆè‡ªå®šä¹‰**ï¼ˆé˜¶æ®µ 3ï¼‰ï¼š
1. åŸºäºç³»ç»Ÿæ ¼å¼
2. æ·»åŠ /ä¿®æ”¹/åˆ é™¤ç»´åº¦æˆ–æ£€æŸ¥é¡¹
3. ä¿å­˜åˆ°æ•°æ®åº“

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### åˆ†æç»´åº¦æƒé‡

æ¯ä¸ªæ®µè½ç±»å‹çš„æ‰€æœ‰ `analysis_dimensions` çš„ `weight` ä¹‹å’Œåº”è¯¥ä¸º 1.0ï¼š

**å¼•è¨€æ®µ**ï¼š
- structure_completeness: 0.4
- thesis_clarity: 0.4
- roadmap: 0.2
- **æ€»å’Œ**: 1.0 âœ…

**æ­£æ–‡æ®µ**ï¼š
- topic_sentence: 0.2
- textual_evidence: 0.3
- close_reading: 0.5
- **æ€»å’Œ**: 1.0 âœ…

### AI è¿”å›æ ¼å¼

AI æ ¹æ® JSON ä¸­å®šä¹‰çš„ç»´åº¦è¿”å›ï¼š

```json
{
  "structure_completeness": {
    "score": 6,
    "issues": ["ç¼ºå°‘å…³é”®è¯å®šä¹‰", "ç¼ºå°‘ç ”ç©¶ç¼ºå£"],
    "sentence_numbers": [1, 2]
  },
  "thesis_clarity": {
    "score": 2,
    "issues": ["æœªæ˜ç¡®æå‡ºæ ¸å¿ƒé—®é¢˜"],
    "sentence_numbers": [1]
  },
  "roadmap": {
    "score": 0,
    "issues": ["æœªé¢„å‘Šæ­£æ–‡ç»“æ„"],
    "sentence_numbers": []
  }
}
```

### åŠ¨æ€å¤„ç†é€»è¾‘

Edge Function ä½¿ç”¨ `Object.entries()` åŠ¨æ€å¤„ç†ï¼š
- âœ… æ”¯æŒä»»æ„æ•°é‡çš„ç»´åº¦
- âœ… æ”¯æŒä»»æ„ç»´åº¦åç§°
- âœ… è‡ªåŠ¨èšåˆæ‰€æœ‰é—®é¢˜
- âœ… è‡ªåŠ¨è®¡ç®—å¹³å‡åˆ†

---

## ğŸ¯ é˜¶æ®µ 3 çš„æ‰©å±•è®¡åˆ’

### æ•°æ®åº“è¡¨ï¼šformat_specifications

```sql
CREATE TABLE format_specifications (
    id UUID PRIMARY KEY,
    name TEXT NOT NULL,
    created_by UUID REFERENCES users(id),
    type TEXT DEFAULT 'custom',
    
    -- ä¸¤ç§è‡ªå®šä¹‰æ–¹å¼
    based_on TEXT,              -- åŸºäºå“ªä¸ªç³»ç»Ÿæ ¼å¼ï¼ˆå¯ä¸º NULLï¼‰
    modifications JSONB,         -- ä¿®æ”¹å†…å®¹ï¼ˆbased_on ä¸ä¸º NULLï¼‰
    spec_json JSONB,            -- å®Œæ•´è§„èŒƒï¼ˆbased_on ä¸º NULLï¼‰
    
    is_public BOOLEAN DEFAULT false,
    created_at TIMESTAMPTZ DEFAULT now()
);
```

### è€å¸ˆè‡ªå®šä¹‰ç¤ºä¾‹

**åŸºäºç³»ç»Ÿæ ¼å¼ä¿®æ”¹**ï¼š
```json
{
  "based_on": "honglou-essay",
  "modifications": {
    "paragraph_types": {
      "introduction": {
        "analysis_dimensions_modify": [
          {
            "id": "thesis_clarity",
            "weight": 0.6,  // æé«˜æƒé‡
            "checks": [
              "æ ¸å¿ƒé—®é¢˜æ˜¯å¦æ˜ç¡®ï¼Ÿ",
              "è®ºæ–‡ä¸»å¼ æ˜¯å¦ â‰¤ 30 å­—ï¼Ÿ"  // æ–°å¢æ£€æŸ¥
            ]
          }
        ],
        "required_elements_add": [
          {
            "id": "historical_context",
            "name": "å†å²èƒŒæ™¯",
            "required": true,
            "description": "å¿…é¡»åŒ…å«æ¸…ä»£ç¤¾ä¼šèƒŒæ™¯"
          }
        ]
      }
    }
  }
}
```

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- **æ ¼å¼è§„èŒƒç¤ºä¾‹**ï¼š`assets/data/honglou-essay-format.json`
- **OpenSpec éœ€æ±‚**ï¼š`openspec/specs/format-specification-system/spec.md`
- **è®¾è®¡æ–‡æ¡£**ï¼š`openspec/specs/format-specification-system/design.md`
- **åŸå§‹éœ€æ±‚**ï¼š`docs/è«–æ–‡æ ¼å¼å¯¶å…¸ - å‰¯æœ¬.md`

---

**ç»´æŠ¤è€…**ï¼šæ—¶æ–‡å®é‰´å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**ï¼š2025-10-19

