<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>萬物逍遙 - 莊子宇宙物化遊戲</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#5D5CDE',
            dark: {
              bg: '#181818',
              text: '#E5E5E5'
            }
          },
          animation: {
            'float': 'float 3s ease-in-out infinite',
            'transform': 'transform 1s ease-in-out',
            'fade': 'fade 0.5s ease-in-out',
            'sway': 'sway 6s ease-in-out infinite',
            'wave': 'wave 8s linear infinite',
            'soar': 'soar 15s linear infinite',
            'rotate': 'rotate 15s linear infinite',
            'scale': 'scale 5s ease-in-out infinite',
            'perspective-shift': 'perspective-shift 10s ease-in-out infinite',
            'pulse-glow': 'pulse-glow 2s ease-in-out infinite',
            'time-lapse': 'time-lapse 15s linear infinite',
            'grow-shrink': 'grow-shrink 10s ease-in-out infinite'
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            },
            transform: {
              '0%': { transform: 'scale(1) rotate(0deg)' },
              '50%': { transform: 'scale(1.2) rotate(180deg)' },
              '100%': { transform: 'scale(1) rotate(360deg)' }
            },
            fade: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' }
            },
            sway: {
              '0%, 100%': { transform: 'rotate(-3deg)' },
              '50%': { transform: 'rotate(3deg)' }
            },
            wave: {
              '0%': { transform: 'translateX(0) translateY(0)' },
              '25%': { transform: 'translateX(-10px) translateY(5px)' },
              '50%': { transform: 'translateX(0) translateY(0)' },
              '75%': { transform: 'translateX(10px) translateY(-5px)' },
              '100%': { transform: 'translateX(0) translateY(0)' }
            },
            soar: {
              '0%': { transform: 'translateX(-100vw) translateY(20vh)' },
              '50%': { transform: 'translateX(50vw) translateY(-10vh)' },
              '100%': { transform: 'translateX(100vw) translateY(5vh)' }
            },
            rotate: {
              '0%': { transform: 'rotate(0deg)' },
              '100%': { transform: 'rotate(360deg)' }
            },
            scale: {
              '0%, 100%': { transform: 'scale(1)' },
              '50%': { transform: 'scale(1.5)' }
            },
            'perspective-shift': {
              '0%': { transform: 'perspective(1000px) rotateY(0deg)' },
              '50%': { transform: 'perspective(1000px) rotateY(15deg)' },
              '100%': { transform: 'perspective(1000px) rotateY(0deg)' }
            },
            'pulse-glow': {
              '0%, 100%': { opacity: 0.6, boxShadow: '0 0 5px rgba(93, 92, 222, 0.4)' },
              '50%': { opacity: 1, boxShadow: '0 0 20px rgba(93, 92, 222, 0.8)' }
            },
            'time-lapse': {
              '0%': { filter: 'brightness(0.8) hue-rotate(0deg)' },
              '25%': { filter: 'brightness(1.2) hue-rotate(90deg)' },
              '50%': { filter: 'brightness(0.9) hue-rotate(180deg)' },
              '75%': { filter: 'brightness(1.1) hue-rotate(270deg)' },
              '100%': { filter: 'brightness(0.8) hue-rotate(360deg)' }
            },
            'grow-shrink': {
              '0%': { transform: 'scale(0.1)' },
              '50%': { transform: 'scale(1)' },
              '100%': { transform: 'scale(0.1)' }
            }
          }
        }
      }
    }
  </script>
  <style>
    /* 基本樣式 */
    body {
      font-family: 'Noto Sans TC', sans-serif;
      transition: background-color 0.3s ease;
    }
    
    .dark body {
      background-color: #181818;
      color: #E5E5E5;
    }
    
    /* 故事文本樣式 */
    .story-text {
      line-height: 1.8;
    }
    
    /* 物化動畫 */
    .transform-effect {
      transition: transform 0.5s ease, opacity 0.5s ease;
    }
    
    /* 七竅顯示 */
    .hole {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid currentColor;
      transition: background-color 0.3s ease;
    }
    
    .hole.filled {
      background-color: #5D5CDE;
    }
    
    /* 詞義匹配和斷句練習樣式 */
    .matching-item {
      transition: background-color 0.3s ease;
    }
    
    .matching-item.correct {
      background-color: rgba(34, 197, 94, 0.2);
    }
    
    .matching-item.wrong {
      background-color: rgba(239, 68, 68, 0.2);
    }
    
    /* 生物形態選擇器 */
    .form-selector {
      transition: transform 0.2s ease, opacity 0.2s ease;
    }
    
    .form-selector:hover {
      transform: scale(1.1);
    }
    
    .form-selector.active {
      transform: scale(1.2);
      box-shadow: 0 0 8px #5D5CDE;
    }
    
    /* 場景轉換 */
    .scene {
      transition: opacity 0.5s ease;
    }
    
    /* 自定義滾動條 */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
    }
    
    ::-webkit-scrollbar-thumb {
      background: #5D5CDE;
      border-radius: 4px;
    }
    
    /* 提示框動畫 */
    @keyframes tipFloat {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-5px);
      }
    }
    
    .tip-animation {
      animation: tipFloat 2s ease-in-out infinite;
    }
    
    /* 水波動畫 */
    @keyframes waves {
      0% {
        background-position: 0 0;
      }
      100% {
        background-position: 100px 0;
      }
    }
    
    /* 海洋動畫 */
    @keyframes oceanWave {
      0% {
        background-position: 0 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }
    
    /* 云层动画 */
    @keyframes cloudDrift {
      0% {
        background-position: 0 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }
    
    /* 吞吐動畫 */
    @keyframes breathe {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    }
    
    /* 飛翔動畫 */
    @keyframes fly {
      0% {
        transform: translateY(0) rotate(0deg);
      }
      25% {
        transform: translateY(-20px) rotate(-5deg);
      }
      50% {
        transform: translateY(0) rotate(0deg);
      }
      75% {
        transform: translateY(20px) rotate(5deg);
      }
      100% {
        transform: translateY(0) rotate(0deg);
      }
    }
    
    /* 日夜交替动画 */
    @keyframes dayNightCycle {
      0%, 100% { 
        background: linear-gradient(180deg, #0EA5E9 0%, #7DD3FC 100%);
      }
      50% { 
        background: linear-gradient(180deg, #1E3A8A 0%, #312E81 100%);
      }
    }
    
    /* 生長動畫 */
    @keyframes growth {
      0% { transform: scale(0.3); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    /* 時間流逝特效 */
    .time-scene {
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, #818CF8 0%, #4F46E5 100%);
    }
    
    .time-scene::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.3) 0%, rgba(255, 255, 255, 0) 50%),
        radial-gradient(circle at 70% 60%, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0) 40%);
      animation: time-lapse 30s linear infinite;
    }
    
    /* 朝菌樣式 */
    .morning-mushroom {
      animation: grow-shrink 24s linear 1;
    }
    
    /* 大椿樣式 */
    .big-chun-tree {
      position: relative;
    }
    
    .big-chun-tree::after {
      content: '';
      position: absolute;
      top: -5px;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 40px;
      background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%);
      border-radius: 50%;
      animation: pulse 3s infinite;
    }
    
    /* 時間輪盤 */
    .time-wheel {
      position: relative;
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background: conic-gradient(
        #8B5CF6 0%, 
        #6366F1 25%, 
        #3B82F6 50%, 
        #10B981 75%,
        #8B5CF6 100%
      );
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
      transform-origin: center;
      animation: rotate 20s linear infinite;
    }
    
    .time-wheel::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(5px);
    }
    
    /* 鼻子發光效果 */
    .nose-glow {
      position: relative;
    }
    
    .nose-glow::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle, rgba(93, 92, 222, 0.6) 0%, rgba(93, 92, 222, 0) 70%);
      border-radius: 50%;
      z-index: -1;
      animation: glow 3s infinite;
    }
    
    /* 北冥海面 */
    .north-sea {
      background: linear-gradient(180deg, #1E40AF 0%, #1E3A8A 100%);
      position: relative;
      overflow: hidden;
    }
    
    .north-sea::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 10px;
      background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDAgQyAyNSAyMCwgNzUgLTIwLCAxMDAgMCBMIDEwMCAxMCBMIDAgMTAgWiIgZmlsbD0icmdiYSgyMjIsIDIzOSwgMjQ4LCAwLjMpIi8+PC9zdmc+');
      background-repeat: repeat-x;
      animation: oceanWave 15s linear infinite;
    }
    
    /* 鯤魚動畫 */
    .kun-fish {
      animation: wave 8s ease-in-out infinite;
    }
    
    /* 鵬鳥動畫 */
    .peng-bird {
      animation: fly 12s ease-in-out infinite;
    }
    
    /* 天空場景 */
    .sky-scene {
      background: linear-gradient(180deg, #0EA5E9 0%, #7DD3FC 100%);
      position: relative;
      overflow: hidden;
    }
    
    .sky-scene::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjUwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDIwIEMgNTAgMTAsIDEwMCAyMCwgMTUwIDEwLCAyMDAgMjAgTCAyMDAgNTAgTCAwIDUwIFoiIGZpbGw9InJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKSIvPjwvc3ZnPg==');
      background-repeat: repeat-x;
      background-size: 200px 50px;
      animation: cloudDrift 60s linear infinite;
      opacity: 0.5;
    }
    
    /* 高空场景 */
    .high-sky {
      background: linear-gradient(180deg, #0C4A6E 0%, #0EA5E9 100%);
      position: relative;
    }
    
    /* 鳳鵷鶵動畫 */
    .yuanchu-bird {
      animation: fly 12s ease-in-out infinite;
    }
    
    /* 鴟鳥動畫 */
    .chi-bird {
      animation: sway 4s ease-in-out infinite;
    }
    
    /* 山林場景 */
    .forest-scene {
      background: linear-gradient(180deg, #2F855A 0%, #276749 100%);
      position: relative;
      overflow: hidden;
    }
    
    .forest-scene::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDgwIEMgMTAgNTAsIDIwIDgwLCAzMCA1MCBDIDQwIDMwLCA1MCA4MCwgNjAgNDAgQyA3MCA2MCwgODAgODAsIDkwIDYwIEwgMTAwIDgwIFoiIGZpbGw9InJnYmEoMCwgMCwgMCwgMC4xKSIvPjwvc3ZnPg==');
      background-repeat: repeat-x;
      background-size: 100px 80px;
      animation: sway 60s linear infinite;
      opacity: 0.2;
    }
    
    /* 梧桐效果 */
    .wutong-tree {
      position: relative;
    }
    
    .wutong-tree::after {
      content: '';
      position: absolute;
      top: -5px;
      left: 50%;
      transform: translateX(-50%);
      width: 30px;
      height: 30px;
      background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 70%);
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 0.3; transform: translateX(-50%) scale(0.8); }
      50% { opacity: 0.6; transform: translateX(-50%) scale(1.2); }
      100% { opacity: 0.3; transform: translateX(-50%) scale(0.8); }
    }
    
    /* 聆聽動畫 */
    @keyframes listening {
      0%, 100% { transform: scale(1); opacity: 0.7; }
      50% { transform: scale(1.1); opacity: 1; }
    }
    
    .listening-effect {
      animation: listening 2s ease-in-out infinite;
    }
    
    /* 左耳特效 */
    .ear-glow {
      position: relative;
    }
    
    .ear-glow::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle, rgba(93, 92, 222, 0.6) 0%, rgba(93, 92, 222, 0) 70%);
      border-radius: 50%;
      z-index: -1;
      animation: glow 3s infinite;
    }
    
    @keyframes glow {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.3); }
    }
    
    /* 互動式斷句系統样式 */
    .interactive-text {
      text-align: center;
      line-height: 2.8;
      position: relative;
      padding: 1.5em 0.5em;
    }
    
    .char {
      font-size: 1.5rem;
      font-weight: 500;
      display: inline-block;
      position: relative;
      padding: 0 2px;
      transition: all 0.2s ease;
    }
    
    .punct-space {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 36px;
      cursor: pointer;
      position: relative;
      vertical-align: middle;
    }
    
    /* 懸停提示區域 */
    .punct-space::before {
      content: '';
      position: absolute;
      top: 20%;
      left: 0;
      width: 100%;
      height: 60%;
      background-color: rgba(93, 92, 222, 0.15);
      border-radius: 4px;
      opacity: 0;
      transition: opacity 0.3s ease, transform 0.2s ease;
      transform: scaleY(0.6);
    }
    
    .punct-space:hover::before {
      opacity: 1;
      transform: scaleY(1);
    }
    
    /* 斷句點 - 上移到35%位置 */
    .punct-space.marked::after {
      content: '•';
      position: absolute;
      top: 35%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #5D5CDE;
      font-size: 26px;
      font-weight: bold;
      line-height: 0;
      text-shadow: 0 0 3px rgba(93, 92, 222, 0.3);
    }
    
    /* 動畫 */
    @keyframes dotPulse {
      0% { transform: translate(-50%, -50%) scale(1.8); opacity: 0.4; }
      50% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.9; }
    }
    
    @keyframes dotFadeOut {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
    }
    
    @keyframes dotHint {
      0% { opacity: 0.2; transform: translate(-50%, -50%) scale(0.5); }
      50% { opacity: 0.5; transform: translate(-50%, -50%) scale(0.8); }
      100% { opacity: 0.2; transform: translate(-50%, -50%) scale(0.5); }
    }
    
    /* 懸停提示 */
    .punct-space:hover:not(.marked)::after {
      content: '•';
      position: absolute;
      top: 35%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.5);
      color: #5D5CDE;
      font-size: 20px;
      line-height: 0;
      opacity: 0.4;
      animation: dotHint 1.5s infinite ease-in-out;
    }
    
    /* 正確和錯誤狀態 */
    .punct-space.correct::after {
      color: #22c55e; /* 綠色 */
      text-shadow: 0 0 5px rgba(34, 197, 94, 0.4);
    }
    
    .punct-space.incorrect::after {
      color: #ef4444; /* 紅色 */
      text-shadow: 0 0 5px rgba(239, 68, 68, 0.4);
    }
    
    /* 字符高亮 */
    .char.active {
      color: #5D5CDE;
      transform: scale(1.1);
    }
    
    /* 蝸牛世界樣式 */
    .snail-world {
      position: relative;
      background: linear-gradient(180deg, #6366F1 0%, #3730A3 100%);
      overflow: hidden;
      border-radius: 0.5rem;
    }
    
    .snail-world::after {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIxIiBmaWxsPSJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMzUpIi8+PC9zdmc+');
      background-size: 100px 100px;
      opacity: 0.2;
    }
    
    /* 蝸牛角國家 */
    .snail-horn {
      position: relative;
      transform-origin: bottom center;
      transition: transform 1s ease-in-out;
    }
    
    .left-horn {
      transform: rotate(-30deg);
    }
    
    .right-horn {
      transform: rotate(30deg);
    }
    
    /* 視角縮放動畫 */
    .zoom-container {
      transition: transform 1.5s ease-out;
    }
    
    .zoom-in {
      transform: scale(2);
    }
    
    .zoom-out {
      transform: scale(0.5);
    }
    
    /* 視角系統 */
    .perspective-container {
      position: relative;
      min-height: 400px;
      overflow: hidden;
      background: linear-gradient(180deg, #0F172A 0%, #1E3A8A 100%);
      border-radius: 0.5rem;
    }
    
    .perspective-container::after {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIxIiBmaWxsPSJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMzUpIi8+PC9zdmc+');
      background-size: 100px 100px;
      opacity: 0.2;
      pointer-events: none;
    }
    
    .perspective-level {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 1rem;
    }
    
    .perspective-level.active {
      opacity: 1;
    }
    
    /* 星星背景動畫 */
    @keyframes twinkle {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 0.3; }
    }
    
    .star {
      position: absolute;
      background-color: white;
      border-radius: 50%;
      animation: twinkle 3s infinite ease-in-out;
    }
    
    /* 滾動效果 */
    @keyframes scroll {
      from { transform: translateY(0); }
      to { transform: translateY(-20px); }
    }
    
    .scroll-hint {
      animation: scroll 1.5s infinite alternate ease-in-out;
    }
    
    /* 尺度滑桿樣式 */
    .scale-slider {
      -webkit-appearance: none;
      width: 100%;
      height: 10px;
      border-radius: 5px;  
      background: #d3d3d3;
      outline: none;
    }
    
    .scale-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 25px;
      height: 25px;
      border-radius: 50%; 
      background: #5D5CDE;
      cursor: pointer;
    }
    
    .scale-slider::-moz-range-thumb {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: #5D5CDE;
      cursor: pointer;
    }
    
    /* 渾沌特效 */
    .chaos-orb {
      position: relative;
      width: 150px;
      height: 150px;
      border-radius: 50%;
      background: radial-gradient(circle, #8B5CF6 0%, #6366F1 50%, #3B82F6 100%);
      box-shadow: 
        0 0 20px rgba(139, 92, 246, 0.5),
        0 0 40px rgba(99, 102, 241, 0.3),
        0 0 60px rgba(59, 130, 246, 0.2);
      animation: pulse-glow 3s infinite ease-in-out;
    }
    
    .chaos-orb::before {
      content: '';
      position: absolute;
      top: 10px;
      left: 10px;
      right: 10px;
      bottom: 10px;
      border-radius: 50%;
      background: 
        radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0) 20%),
        radial-gradient(circle at 70% 70%, rgba(255, 255, 255, 0.5) 0%, rgba(255, 255, 255, 0) 30%);
      filter: blur(2px);
      animation: rotate 10s linear infinite;
    }
    
    /* 七竅完成特效 */
    .completed-seals {
      position: relative;
    }
    
    .completed-seals .seal {
      position: absolute;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(93, 92, 222, 0.3);
      animation: pulse-glow 2s infinite ease-in-out;
    }
    
    .completed-seals .seal:nth-child(1) {
      top: -20px;
      left: 55px;
    }
    
    .completed-seals .seal:nth-child(2) {
      top: -20px;
      right: 55px;
    }
    
    .completed-seals .seal:nth-child(3) {
      top: 40px;
      left: -15px;
    }
    
    .completed-seals .seal:nth-child(4) {
      top: 40px;
      right: -15px;
    }
    
    .completed-seals .seal:nth-child(5) {
      top: 90px;
      left: 10px;
    }
    
    .completed-seals .seal:nth-child(6) {
      top: 90px;
      right: 10px;
    }
    
    .completed-seals .seal:nth-child(7) {
      bottom: 0;
      left: 55px;
    }
    
    /* 物化動畫效果 */
    .wuhua-effect {
      position: relative;
      overflow: hidden;
    }
    
    .wuhua-effect::before {
      content: '';
      position: absolute;
      top: -10%;
      left: -10%;
      width: 120%;
      height: 120%;
      background: 
        radial-gradient(circle, rgba(93, 92, 222, 0.2) 0%, rgba(93, 92, 222, 0) 70%),
        radial-gradient(circle at 70% 30%, rgba(139, 92, 246, 0.2) 0%, rgba(139, 92, 246, 0) 70%);
      animation: rotate 15s linear infinite;
    }
    
    /* 終章渾沌復生效果 */
    .chaos-rebirth {
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, #312E81 0%, #4F46E5 100%);
    }
    
    .chaos-rebirth::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 50%),
        radial-gradient(circle at 70% 70%, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 50%);
      animation: pulse-glow 5s infinite ease-in-out;
    }

    /* 通用按钮优化 */
    button {
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }

    button:not(:disabled):hover {
      transform: translateY(-1px);
    }

    button:not(:disabled):active {
      transform: translateY(0) scale(0.98);
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* 按钮点击效果 */
    button:not(:disabled)::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    button:not(:disabled):active::after {
      width: 300px;
      height: 300px;
    }

    /* 加载状态提示 */
    .loading {
      pointer-events: none;
      opacity: 0.7;
    }

    .loading::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid transparent;
      border-top: 2px solid currentColor;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="bg-white dark:bg-dark-bg text-gray-800 dark:text-dark-text">
    <!-- 加载指示器 -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div class="bg-white dark:bg-gray-800 rounded-lg p-6 text-center">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"></div>
        <p class="text-gray-700 dark:text-gray-300">載入中...</p>
      </div>
    </div>

    <!-- 主遊戲容器 -->
    <div id="game-container" class="max-w-4xl mx-auto px-4 py-6 min-h-screen flex flex-col">
      
      <!-- 遊戲標題 -->
      <header class="text-center mb-6">
        <h1 class="text-3xl md:text-4xl font-bold text-primary mb-2">萬物逍遙</h1>
        <p class="text-lg text-gray-600 dark:text-gray-300">莊子宇宙物化遊戲</p>
      </header>
      
      <!-- 七竅進度顯示 -->
      <div class="flex justify-center mb-6">
        <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-3 shadow-md">
          <div class="text-center mb-2 text-sm text-gray-600 dark:text-gray-300">渾沌七竅</div>
          <div class="flex space-x-3 justify-center">
            <div class="hole" title="左目之竅" data-hole="1"></div>
            <div class="hole" title="右目之竅" data-hole="2"></div>
            <div class="hole" title="左耳之竅" data-hole="3"></div>
            <div class="hole" title="右耳之竅" data-hole="4"></div>
            <div class="hole" title="左鼻之竅" data-hole="5"></div>
            <div class="hole" title="右鼻之竅" data-hole="6"></div>
            <div class="hole" title="口之竅" data-hole="7"></div>
          </div>
        </div>
      </div>
      
      <!-- 章節導航 -->
      <div class="mb-6">
        <!-- 移动端章节选择器 -->
        <div class="md:hidden">
          <label for="chapter-select" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">選擇章節：</label>
          <select id="chapter-select" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-primary">
            <option value="intro">序章: 莊周夢蝶</option>
            <option value="ch1" disabled>一章: 子非魚</option>
            <option value="ch2" disabled>二章: 北冥有魚</option>
            <option value="ch3" disabled>三章: 鴟得腐鼠</option>
            <option value="ch4" disabled>四章: 蝸角之爭</option>
            <option value="ch5" disabled>五章: 朝菌與大椿</option>
            <option value="epilogue" disabled>終章: 渾沌復生</option>
          </select>
        </div>
        
        <!-- 桌面端章节按钮 -->
        <div class="hidden md:block overflow-x-auto">
          <div class="flex space-x-2 md:space-x-4 min-w-max">
            <button class="chapter-btn px-3 py-2 rounded-lg bg-primary text-white text-sm md:text-base hover:bg-opacity-90 active:scale-95 transition-all duration-200" data-chapter="intro">
              序章: 莊周夢蝶
            </button>
            <button class="chapter-btn px-3 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm md:text-base hover:bg-gray-300 dark:hover:bg-gray-600 active:scale-95 transition-all duration-200" data-chapter="ch1" disabled>
              一章: 子非魚
            </button>
            <button class="chapter-btn px-3 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm md:text-base hover:bg-gray-300 dark:hover:bg-gray-600 active:scale-95 transition-all duration-200" data-chapter="ch2" disabled>
              二章: 北冥有魚
            </button>
            <button class="chapter-btn px-3 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm md:text-base hover:bg-gray-300 dark:hover:bg-gray-600 active:scale-95 transition-all duration-200" data-chapter="ch3" disabled>
              三章: 鴟得腐鼠
            </button>
            <button class="chapter-btn px-3 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm md:text-base hover:bg-gray-300 dark:hover:bg-gray-600 active:scale-95 transition-all duration-200" data-chapter="ch4" disabled>
              四章: 蝸角之爭
            </button>
            <button class="chapter-btn px-3 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm md:text-base hover:bg-gray-300 dark:hover:bg-gray-600 active:scale-95 transition-all duration-200" data-chapter="ch5" disabled>
              五章: 朝菌與大椿
            </button>
            <button class="chapter-btn px-3 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm md:text-base hover:bg-gray-300 dark:hover:bg-gray-600 active:scale-95 transition-all duration-200" data-chapter="epilogue" disabled>
              終章: 渾沌復生
            </button>
          </div>
        </div>
      </div>
      
      <!-- 主遊戲區域 -->
      <main class="flex-grow">
        
        <!-- 場景顯示區 -->
        <div id="scene-container" class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4 md:p-6 shadow-md mb-6 min-h-[300px] relative">
          <!-- 序章場景 -->
          <div id="scene-intro" class="scene animate-fade">
            <div class="flex flex-col md:flex-row items-center md:items-start mb-4">
              <div class="text-6xl mb-4 md:mb-0 md:mr-6 animate-float">🦋</div>
              <div>
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">序章：莊周夢蝶</h2>
                <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                  <p class="mb-2">「昔者莊周夢為胡蝶，栩栩然胡蝶也，自喻適志與！不知周也。俄然覺，則蘧蘧然周也。」</p>
                  <p class="mb-2">你是莊周，剛從一場奇特的夢境中醒來。在夢中，你是一隻自由飛舞的胡蝶，忘記了自己本為人的身份。</p>
                  <p>然而，這次的夢境與往常不同。當你醒來時，一個模糊的意識仍縈繞在你心頭 - 是渾沌的呼喚。</p>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-4">
                  <p class="text-gray-700 dark:text-gray-300 text-sm italic">「渾沌」告訴你：「南海之帝儵與北海之帝忽，為了『報我之德』，在我身上鑿了七個竅，讓我如同常人一般。但這『善意的破壞』使我失去了本真，也讓萬物失去了相互轉化的能力。」</p>
                  <p class="mt-2 text-gray-700 dark:text-gray-300 text-sm italic">「幫助我找回七竅的封印，修復我的完整，萬物才能重獲物化之道，達到逍遙的境界。」</p>
                </div>
                <div class="text-center">
                  <button id="start-journey" class="bg-primary hover:bg-opacity-90 active:scale-95 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl">踏上尋找渾沌之旅</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 物化選擇場景 (初始隱藏) -->
          <div id="scene-transformation" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">選擇你的物化形態</h2>
            <p class="mb-4 text-gray-700 dark:text-gray-300">渾沌賦予你初步的物化能力，現在你可以在人形和胡蝶之間轉換。選擇一個形態來探索世界。</p>
            
            <div class="flex justify-center space-x-8 mb-6">
              <div class="form-selector cursor-pointer text-center active" data-form="human">
                <div class="text-5xl mb-2">🧍</div>
                <p class="text-sm font-medium">人形</p>
              </div>
              <div class="form-selector cursor-pointer text-center" data-form="butterfly">
                <div class="text-5xl mb-2">🦋</div>
                <p class="text-sm font-medium">胡蝶</p>
              </div>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
              <p id="form-description" class="text-gray-700 dark:text-gray-300">
                <span class="font-medium">人形:</span> 你的原始形態。雖然沒有特殊能力，但可以與其他人交流，使用工具，理解人類社會。
              </p>
            </div>
            
            <div class="mt-6 text-center">
              <button id="confirm-transformation" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">確認變化</button>
            </div>
          </div>
          
          <!-- 斷句練習場景 (初始隱藏) -->
          <div id="scene-sentence" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">斷句練習：莊周夢蝶</h2>
            <p class="mb-2 text-gray-700 dark:text-gray-300">透過正確斷句來鞏固對原文的理解。請點擊字與字之間的位置添加或移除斷句標記。</p>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">提示：這段有5處需要斷句。目前已添加 <span id="segment-count" class="font-medium text-primary">0</span>/5 處斷句。</p>
            
            <div class="mb-6 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm">
              <div id="interactive-sentence" class="text-2xl text-center leading-loose tracking-wider">
                <!-- 此处由JavaScript动态生成互动句子 -->
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">操作說明：</span> 點擊字與字之間的空白處添加或移除斷句點「•」。正確的斷句將幫助您理解莊子文本的結構和含義。
              </p>
            </div>
            
            <div class="flex justify-between mb-4">
              <button id="check-sentence" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">檢查斷句</button>
              <div>
                <button id="show-hint" class="bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition mr-2">顯示提示</button>
                <button id="show-correct-answer" data-chapter="intro" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-medium transition">顯示正確答案</button>
              </div>
            </div>
            
            <div id="sentence-result" class="p-4 rounded-lg hidden"></div>
            
            <div id="sentence-hint" class="mt-4 p-4 bg-yellow-50 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-lg hidden">
              <p class="text-sm">提示：思考句子的自然停頓和語意單位。「昔者莊周夢為胡蝶」是第一個完整的句子。</p>
            </div>
            
            <div id="correct-answer-intro" class="mt-4 p-4 bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hidden">
              <p class="text-sm font-medium">正確答案：</p>
              <p class="text-sm mt-2"></p>
            </div>
          </div>
          
          <!-- 探索場景 (初始隱藏) -->
          <div id="scene-exploration" class="scene hidden">
            <div id="exploration-content">
              <!-- 由JavaScript動態生成內容 -->
              <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">探索夢境與現實</h2>
              <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
                <p class="text-gray-700 dark:text-gray-300 mb-3">你開始思考夢中是胡蝶，醒來是莊周的奇妙體驗。這種物我不分、自他不辨的感受，正是渾沌所說的「物化之道」。</p>
                <p class="text-gray-700 dark:text-gray-300 mb-3">你發現自己能在意念中重現那種轉變的感覺——人與蝶之間的界限模糊了，彷彿兩者本就是同一存在的不同形態。</p>
                <p class="text-gray-700 dark:text-gray-300">随著你沉浸在這種意識中，周圍的空氣微微震動，一道微弱的光芒在你面前形成——那是「左目之竅」的封印，正等待著你的發現。</p>
              </div>
            </div>
            
            <div class="mt-6 flex justify-between">
              <button id="explore-back" class="bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition">返回</button>
              <button id="explore-continue" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">繼續探索</button>
            </div>
          </div>
          
          <!-- 找到封印場景 (初始隱藏) -->
          <div id="scene-seal-found" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-transform mb-2">✨</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">發現封印！</h2>
            </div>
            
            <div id="seal-description" class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6 text-center">
              <p class="text-gray-700 dark:text-gray-300">
                你找到了「左目之竅」的封印！這是恢復渾沌完整性的第一步。
              </p>
              <div class="text-5xl my-4">👁️</div>
              <p class="text-gray-700 dark:text-gray-300">
                「左目之竅」象徵著視界與觀點的相對性，正如「子非魚」之辯所示。
              </p>
            </div>
            
            <div class="text-center">
              <button id="collect-seal" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">收集封印</button>
            </div>
          </div>
          
          <!-- 解鎖新物化場景 (初始隱藏) -->
          <div id="scene-new-form" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-float mb-2">🐟</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">解鎖新的物化形態！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300 text-center">
                收集「左目之竅」的封印後，你獲得了新的物化能力：可以變化為儵魚，遊弋於水中，感知水流的情緒。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3 text-center italic">
                「莊子與惠子遊於濠梁之上。莊子曰：儵魚出遊從容，是魚樂也。」
              </p>
            </div>
            
            <div class="text-center">
              <button id="try-new-form" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">嘗試新形態</button>
            </div>
          </div>
          
          <!-- 章節完成場景 (初始隱藏) -->
          <div id="scene-chapter-complete" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-5xl mb-2">🎉</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">序章完成！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300">
                你已成功完成序章「莊周夢蝶」的探索！現在你擁有了基本的物化能力，可以在人形與胡蝶之間自由轉換。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>解鎖成就：</strong>
              </p>
              <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 ml-4">
                <li>「夢蝶初醒」- 體驗人與胡蝶的雙重視角</li>
                <li>「斷句大師」- 正確斷句莊周夢蝶原文</li>
              </ul>
            </div>
            
            <div class="text-center">
              <button id="next-chapter" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往下一章：子非魚</button>
            </div>
          </div>
          
          <!-- 子非魚章節 (初始隱藏) -->
          <div id="scene-ch1-intro" class="scene hidden">
            <div class="flex flex-col md:flex-row items-center md:items-start mb-4">
              <div class="text-6xl mb-4 md:mb-0 md:mr-6 animate-float">🐟</div>
              <div>
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">第一章：子非魚</h2>
                <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                  <p class="mb-2">「莊子與惠子遊於濠梁之上。莊子曰：儵魚出遊從容，是魚樂也。」</p>
                  <p class="mb-2">你與朋友惠子在濠水之上的橋上散步。看著水中游動的白魚，你不禁感嘆它們悠閒自在，一定很快樂。</p>
                  <p>惠子卻對你的言論提出質疑：「子非魚，安知魚之樂？」你不是魚，怎麼知道魚是否快樂呢？</p>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-4">
                  <p class="text-gray-700 dark:text-gray-300 text-sm italic">渾沌的聲音在你心中響起：「左目之竅的封印隱藏在濠水之中，只有理解視角的相對性，才能找到它。你需要成為魚，感受水中的世界。」</p>
                </div>
                <div class="text-center">
                  <button id="ch1-start" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">開始探索濠水</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 斷句練習場景 (第一章) -->
          <div id="scene-sentence-ch1" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">斷句練習：子非魚</h2>
            <p class="mb-2 text-gray-700 dark:text-gray-300">開始探索前，透過正確斷句來理解「子非魚」的對話。請點擊字與字之間的位置添加或移除斷句標記。</p>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">提示：這段有多處需要斷句。目前已添加 <span id="segment-count-ch1" class="font-medium text-primary">0</span> 處斷句。</p>
            
            <div class="mb-6 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm">
              <div id="interactive-sentence-ch1" class="text-xl text-center leading-loose tracking-wider">
                <!-- 此处由JavaScript动态生成互动句子 -->
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">操作說明：</span> 點擊字與字之間的空白處添加或移除斷句點「•」。正確的斷句將幫助您理解莊子文本的結構和含義。
              </p>
            </div>
            
            <div class="flex justify-between mb-4">
              <button id="check-sentence-ch1" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">檢查斷句</button>
              <div>
                <button id="show-hint-ch1" class="bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition mr-2">顯示提示</button>
                <button id="show-correct-answer-ch1" data-chapter="ch1" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-medium transition">顯示正確答案</button>
              </div>
            </div>
            
            <div id="sentence-result-ch1" class="p-4 rounded-lg hidden"></div>
            
            <div id="sentence-hint-ch1" class="mt-4 p-4 bg-yellow-50 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-lg hidden">
              <p class="text-sm">提示：思考對話中的自然停頓和語意單位。「莊子與惠子」是第一個完整的主語。</p>
            </div>
            
            <div id="correct-answer-ch1" class="mt-4 p-4 bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hidden">
              <p class="text-sm font-medium">正確答案：</p>
              <p class="text-sm mt-2"></p>
            </div>
          </div>
          
          <!-- 濠水橋上場景 (初始隱藏) -->
          <div id="scene-bridge" class="scene hidden">
            <div class="mb-4">
              <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">濠梁之上</h2>
              <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                <p>你與惠子站在濠水的橋上，俯視著流動的清澈水面。陽光在水面上跳躍，白色的儵魚時隱時現。</p>
              </div>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">🧔</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">惠子：</p>
                  <p class="text-gray-700 dark:text-gray-300">子非魚，安知魚之樂？</p>
                  <p class="text-gray-500 dark:text-gray-400 text-sm italic mt-1">（你不是魚，怎麼知道魚是快樂的呢？）</p>
                </div>
              </div>
              
              <div id="dialogue-options" class="mt-4">
                <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">選擇回應：</p>
                <button class="dialogue-option w-full text-left p-3 mb-2 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition" data-response="original">
                  子非我，安知我不知魚之樂？
                  <span class="text-xs block text-gray-500 dark:text-gray-400 mt-1">（你不是我，怎麼知道我不知道魚的快樂？）</span>
                </button>
                <button class="dialogue-option w-full text-left p-3 mb-2 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition" data-response="modern">
                  我觀察到魚的行為表現出快樂的跡象，從而做出合理推測。
                  <span class="text-xs block text-gray-500 dark:text-gray-400 mt-1">（現代解釋方式）</span>
                </button>
                <button class="dialogue-option w-full text-left p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition" data-response="transform">
                  讓我變成魚，親自體驗看看。
                  <span class="text-xs block text-gray-500 dark:text-gray-400 mt-1">（嘗試物化）</span>
                </button>
              </div>
            </div>
          </div>
          
          <!-- 對話回應場景 (初始隱藏) -->
          <div id="scene-dialogue-response" class="scene hidden">
            <div class="mb-4">
              <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">與惠子的對話</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <div id="response-content">
                <!-- 由JavaScript動態填充 -->
              </div>
            </div>
            
            <div class="flex justify-between mt-4">
              <button id="back-to-bridge" class="bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition">返回</button>
              <button id="try-transformation" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">嘗試變成魚</button>
            </div>
          </div>
          
          <!-- 魚的視角場景 (初始隱藏) -->
          <div id="scene-fish-view" class="scene hidden">
            <div class="mb-4 text-center">
              <div class="text-6xl mb-3 animate-float inline-block">🐟</div>
              <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">儵魚的視角</h2>
            </div>
            
            <div class="rounded-lg overflow-hidden mb-4 relative" style="background: linear-gradient(180deg, #BDE3FF 0%, #70C1FF 100%);">
              <div class="absolute inset-0 opacity-20" style="background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjIwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik0wIDAgQyAyMCA4LCA4MCAxMiwgMTAwIDAgTCAxMDAgMjAgTCAwIDIwIFoiIGZpbGw9IiM0OEEzRkYiLz48L3N2Zz4='); background-repeat: repeat-x; animation: waves 10s linear infinite;"></div>
              <div class="p-4 relative">
                <p class="text-blue-800 mb-3">你感受到水流輕柔地從鰭邊滑過，陽光透過水面形成斑駁的光影。你的視野變得更廣，能感知周圍水流的微妙變化。</p>
                <p class="text-blue-800 mb-3">你感受到無比的自由和輕盈，在水中悠然自得地穿梭。沒有思慮的重擔，只有當下的感受。這種感覺......確實是快樂的。</p>
                <p class="text-blue-800">忽然，你注意到水底深處有一道微弱的光芒，像是在呼喚著你。</p>
              </div>
            </div>
            
            <div class="text-center">
              <button id="explore-underwater" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">探索水底光芒</button>
            </div>
          </div>
          
          <!-- 水底探索場景 (初始隱藏) -->
          <div id="scene-underwater" class="scene hidden">
            <div class="mb-4">
              <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">濠水深處</h2>
            </div>
            
            <div class="rounded-lg overflow-hidden mb-4 relative" style="background: linear-gradient(180deg, #70C1FF 0%, #2980B9 100%);">
              <div class="p-4 relative">
                <p class="text-blue-100 mb-3">你潛入水底，周圍變得更加寂靜。這裡的世界與水面上大不相同，有著獨特的寧靜與美麗。</p>
                <p class="text-blue-100 mb-3">隨著深入，你遇見了一個容貌威嚴的身影，散發著柔和的光芒 - 是河伯，這條河流的守護神。</p>
                <div class="flex items-start mb-3 bg-blue-800 bg-opacity-40 p-3 rounded-lg">
                  <div class="text-4xl mr-3">🧜‍♂️</div>
                  <div>
                    <p class="font-medium text-blue-50">河伯：</p>
                    <p class="text-blue-100">你能來到這裡，說明你已經開始理解魚的視角和感受。對不同生物而言，真實的體驗各不相同，但都同樣真實。正如你現在體驗到的魚之樂。</p>
                  </div>
                </div>
                <p class="text-blue-100">河伯指向一個發光的物體，那是「左目之竅」的封印，靜靜地鑲嵌在河床的石頭中。</p>
              </div>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="talk-river-god" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">與河伯交談</button>
              <button id="collect-eye-seal" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">取得左目封印</button>
            </div>
          </div>
          
          <!-- 河伯對話場景 (初始隱藏) -->
          <div id="scene-river-god-talk" class="scene hidden">
            <div class="mb-4">
              <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">河伯的智慧</h2>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg mb-4">
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">🧜‍♂️</div>
                <div>
                  <p class="font-medium text-blue-800 dark:text-blue-100">河伯：</p>
                  <p class="text-blue-700 dark:text-blue-200 mb-2">我曾經也像你一樣，認為自己的江河就是整個世界。直到有一天，我遇見了海神若，才明白自己的渺小。</p>
                  <p class="text-blue-700 dark:text-blue-200 mb-2">「野語有之，曰『聞道百，以為莫己若』者，我之謂也。」</p>
                  <p class="text-blue-700 dark:text-blue-200">視角決定了我們所見的世界。理解這一點，你就能看到左目之竅的真實。</p>
                </div>
              </div>
              
              <div class="mt-4 p-3 bg-blue-100 dark:bg-blue-800 rounded-lg">
                <p class="text-sm text-blue-700 dark:text-blue-200">
                  <span class="font-medium">理解：</span>
                  「子非魚，安知魚之樂」和河伯的故事，都在表達一個共同的主題——認知的局限性和視角的相對性。惠子質疑你無法知道魚的感受，而河伯則認識到自己對世界的理解有限。這都是莊子「物化」哲學的體現。
                </p>
              </div>
            </div>
            
            <div class="text-center">
              <button id="back-to-underwater" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">返回水底</button>
            </div>
          </div>
          
          <!-- 第一章完成場景 (初始隱藏) -->
          <div id="scene-ch1-complete" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-5xl mb-2">🎉</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">第一章完成！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300">
                你已成功完成第一章「子非魚」的探索！通過物化為儵魚，你親身體驗了魚的視角，理解了認知的相對性。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>解鎖成就：</strong>
              </p>
              <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 ml-4">
                <li>「魚樂之辯」- 與惠子辯論認知的相對性</li>
                <li>「水中遊」- 體驗儵魚的視角</li>
                <li>「左目之竅」- 收集第一枚渾沌封印</li>
              </ul>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>下一步：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300">
                渾沌的聲音告訴你：「北冥有魚，其名為鯤。鯤之大，不知其幾千里也。」尋找這條巨大的鯤魚，它可能知道下一個封印的所在。
              </p>
            </div>
            
            <div class="text-center">
              <button id="to-chapter-two" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往第二章：北冥有魚</button>
            </div>
          </div>
          <!-- 第二章：北冥有魚 (初始隱藏) -->
        <div id="scene-ch2-intro" class="scene hidden">
            <div class="flex flex-col md:flex-row items-center md:items-start mb-4">
              <div class="text-6xl mb-4 md:mb-0 md:mr-6 animate-float">🐋</div>
              <div>
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">第二章：北冥有魚</h2>
                <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                  <p class="mb-2">「北冥有魚，其名為鯤。鯤之大，不知其幾千里也。化而為鳥，其名為鵬。鵬之背，不知其幾千里也；怒而飛，其翼若垂天之雲。」</p>
                  <p class="mb-2">尋找「右目之竅」的封印，你來到了傳說中的北冥——一片遼闊的大海。據說這裡有一條巨大的魚，名叫鯤。</p>
                  <p>更奇妙的是，這條魚能夠化為一種名為鵬的巨鳥，飛翔於九萬里之上。鯤鵬物化之力，或許能幫助你理解更廣闊的視野。</p>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-4">
                  <p class="text-gray-700 dark:text-gray-300 text-sm italic">渾沌的聲音再次響起：「右目之竅象徵著洞察力，見微知著，超越表象看本質。尋找鯤鵬，體驗其俯瞰世界的視角，你將找到這個封印。」</p>
                </div>
                <div class="text-center">
                  <button id="ch2-start" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">探索北冥</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 斷句練習場景 (第二章) -->
          <div id="scene-sentence-ch2" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">斷句練習：北冥有魚</h2>
            <p class="mb-2 text-gray-700 dark:text-gray-300">開始探索前，透過正確斷句來理解鯤鵬的故事。請點擊字與字之間的位置添加或移除斷句標記。</p>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">提示：這段有多處需要斷句。目前已添加 <span id="segment-count-ch2" class="font-medium text-primary">0</span> 處斷句。</p>
            
            <div class="mb-6 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm">
              <div id="interactive-sentence-ch2" class="text-xl text-center leading-loose tracking-wider">
                <!-- 此处由JavaScript动态生成互动句子 -->
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">操作說明：</span> 點擊字與字之間的空白處添加或移除斷句點「•」。正確的斷句將幫助您理解莊子文本的結構和含義。
              </p>
            </div>
            
            <div class="flex justify-between mb-4">
              <button id="check-sentence-ch2" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">檢查斷句</button>
              <div>
                <button id="show-hint-ch2" class="bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition mr-2">顯示提示</button>
                <button id="show-correct-answer-ch2" data-chapter="ch2" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-medium transition">顯示正確答案</button>
              </div>
            </div>
            
            <div id="sentence-result-ch2" class="p-4 rounded-lg hidden"></div>
            
            <div id="sentence-hint-ch2" class="mt-4 p-4 bg-yellow-50 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-lg hidden">
              <p class="text-sm">提示：思考描述中的自然停頓和語意單位。「北冥有魚」是第一個完整的句子。</p>
            </div>
            
            <div id="correct-answer-ch2" class="mt-4 p-4 bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hidden">
              <p class="text-sm font-medium">正確答案：</p>
              <p class="text-sm mt-2"></p>
            </div>
          </div>
          
          <!-- 北冥海面場景 (初始隱藏) -->
          <div id="scene-north-sea" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">北冥之海</h2>
            <div class="north-sea rounded-lg p-6 mb-4">
              <p class="text-white mb-4">你站在北冥海岸，望著這片深邃遼闊的海洋。白色的浪花拍打著岸邊，海風呼嘯而過。這片水域比濠水廣闊千萬倍，令人生畏又心生嚮往。</p>
              <p class="text-white">傳說中的鯤魚就生活在這片海域，但如此浩瀚的海洋，如何才能找到牠呢？</p>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <h3 class="font-medium text-gray-800 dark:text-gray-100 mb-3">探索選項：</h3>
              <div class="space-y-2">
                <button id="ask-fisherman" class="w-full text-left p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition">
                  詢問當地漁民關於鯤魚的傳說
                </button>
                <button id="transform-fish" class="w-full text-left p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition">
                  變化為儵魚，嘗試在海中尋找線索
                </button>
                <button id="meditate-sea" class="w-full text-left p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition">
                  在岸邊冥想，尋求渾沌的指引
                </button>
              </div>
            </div>
          </div>
          
          <!-- 漁民場景 (初始隱藏) -->
          <div id="scene-fisherman" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">海邊漁村</h2>
            <div class="flex items-start space-x-4 mb-4">
              <div class="text-4xl">👨‍🦳</div>
              <div>
                <p class="text-gray-700 dark:text-gray-300 mb-3">
                  你找到了一位年邁的漁民，他正在修補漁網。當你詢問鯤魚的事，老人的眼睛突然亮起來。
                </p>
                <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                  <p class="text-gray-600 dark:text-gray-400 italic mb-2">「鯤魚啊...那可不是普通的魚。」老人放下手中的活計，望向遠方的海平面。</p>
                  <p class="text-gray-600 dark:text-gray-400 italic mb-2">「我年輕時曾見過一次。那天海面異常平靜，突然間，海面浮現出一個巨大的暗影，比我們整個漁村還大。那就是鯤，北冥的主宰。」</p>
                  <p class="text-gray-600 dark:text-gray-400 italic">「傳說鯤會在每年秋分的時候，浮上海面吸收日月精華，然後化為鵬鳥飛向南冥。如果你想見到牠，就在明天秋分這天，到東方礁石群等待吧。」</p>
                </div>
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">獲得信息：</span> 明天是秋分，可以在東方礁石群等待鯤魚出現。
              </p>
            </div>
            
            <div class="flex justify-between mt-4">
              <button id="back-to-sea" class="bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition">返回海岸</button>
              <button id="go-to-reef" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往礁石群</button>
            </div>
          </div>
          
          <!-- 北冥魚形態場景 (初始隱藏) -->
          <div id="scene-sea-fish" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">化為儵魚</h2>
            <div class="north-sea rounded-lg p-6 mb-4">
              <p class="text-white mb-4">你變化為儵魚，潛入北冥深處。這裡的水比濠水寒冷、深邃得多，你的小小身軀在這片浩瀚中顯得格外渺小。</p>
              <p class="text-white mb-4">忽然，你感受到一股強大的水流變化，周圍的魚群都朝著同一個方向游去，彷彿在逃離什麼。</p>
              <p class="text-white">順著水流的反向，你察覺到一個巨大的存在正在緩慢移動——那個龐然大物的體積，簡直無法想象。</p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="follow-fish" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">隨魚群逃離</button>
              <button id="approach-kun" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">靠近巨大生物</button>
            </div>
          </div>
          
          <!-- 冥想場景 (初始隱藏) -->
          <div id="scene-meditation" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">海岸冥想</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">你在海岸邊盤坐，閉上雙眼，聆聽海浪聲，感受海風拂面。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">隨著呼吸逐漸平穩，你的意識開始擴散，與大海融為一體。</p>
              <p class="text-gray-700 dark:text-gray-300">忽然，你的心中浮現出一幅景象：東方海域的礁石群，一股巨大的水柱從海面噴出，而後一個龐大的身影躍出水面，在陽光下閃閃發光。</p>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-purple-800 dark:text-purple-200">
                <span class="font-medium">神秘啟示：</span> 東方礁石群似乎是見到鯤魚的關鍵地點。明天日出時分，可能會有奇妙的事情發生。
              </p>
            </div>
            
            <div class="flex justify-between mt-4">
              <button id="back-to-sea-2" class="bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition">返回海岸</button>
              <button id="go-to-reef-2" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往礁石群</button>
            </div>
          </div>
          
          <!-- 礁石群場景 (初始隱藏) -->
          <div id="scene-reef" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">東方礁石群</h2>
            <div class="north-sea rounded-lg p-6 mb-4">
              <p class="text-white mb-4">清晨，你來到東方礁石群，等待著神秘的鯤魚現身。天邊已露出魚肚白，海面平靜如鏡。</p>
              <p class="text-white mb-4">隨著第一縷陽光照射在海面上，你注意到遠處的水面開始泛起漣漪，漣漪越來越大，彷彿有什麼龐然大物正在接近水面。</p>
              <p class="text-white">突然，一個巨大的黑影從海中浮現！那是一條魚，但其體型之大令人難以置信。牠的身體就像一座移動的島嶼，掀起的巨浪拍打著礁石。</p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="observe-kun" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">觀察鯤魚</button>
              <button id="attempt-contact" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">嘗試接觸</button>
            </div>
          </div>
          
          <!-- 觀察鯤魚場景 (初始隱藏) -->
          <div id="scene-observe-kun" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">觀察巨鯤</h2>
            <div class="flex flex-col items-center mb-4">
              <div class="text-7xl kun-fish mb-3">🐋</div>
              <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg w-full">
                <p class="text-gray-700 dark:text-gray-300 mb-3">鯤魚的身軀龐大得超乎想象，如同一座移動的島嶼。牠的皮膚有著深藍色的光澤，佈滿了看似古老的紋路，像是記載著時間的流逝。</p>
                <p class="text-gray-700 dark:text-gray-300 mb-3">牠緩慢地在海面上浮游，呼吸時噴出的水柱高達數十丈。周圍的空氣因為牠的存在而變得沉重又充滿能量。</p>
                <p class="text-gray-700 dark:text-gray-300">但最神奇的是，你感覺到鯤魚的身體正在發生微妙的變化，輪廓逐漸變得不再確定，彷彿準備轉化為另一種形態。</p>
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">頓悟：</span> 鯤魚的存在形態是流動的，不受固定形體束縛。牠即將開始物化為鵬鳥的過程。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="wait-transformation" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">等待鯤的變化</button>
            </div>
          </div>
          
          <!-- 接觸鯤魚場景 (初始隱藏) -->
          <div id="scene-contact-kun" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">接觸巨鯤</h2>
            <div class="north-sea rounded-lg p-6 mb-4">
              <p class="text-white mb-4">你深吸一口氣，變化為儵魚形態，迅速潛入水中，向著鯤魚游去。</p>
              <p class="text-white mb-4">在鯤的龐大身軀面前，你渺小得如同一粒塵埃。當你靠近時，你感受到一種古老而強大的能量，牠渾身散發著一種超越時空的氣息。</p>
              <p class="text-white">突然，你感覺到一種意識接觸了你的思維。那不是語言，而是一種直接的意識交流——鯤在與你溝通！</p>
            </div>
            
            <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg mb-4">
              <p class="italic text-indigo-700 dark:text-indigo-200">「渾沌的使者，我等待著你的到來。」</p>
              <p class="italic text-indigo-700 dark:text-indigo-200 mt-2">「我與鵬乃一體兩面，陰陽相生。我潛于海底，鵬翱翔於天際，但我們本為一體。」</p>
              <p class="italic text-indigo-700 dark:text-indigo-200 mt-2">「你尋找的右目之竅蘊含著洞察之力，能夠看透層層表象，直達本質。要獲得它，你必須在我化為鵬鳥時，隨我一同飛向九萬里高空，在俯瞰大地之時，你將看清世界的真實。」</p>
            </div>
            
            <div class="flex justify-center">
              <button id="agree-follow" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">答應隨鯤飛翔</button>
            </div>
          </div>
          
          <!-- 等待變化場景 (初始隱藏) -->
          <div id="scene-kun-changing" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">鯤之化鵬</h2>
            <div class="flex flex-col items-center mb-4">
              <div class="text-7xl transform-effect mb-3" id="kun-peng-animation">🐋</div>
              <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg w-full">
                <p class="text-gray-700 dark:text-gray-300 mb-3">鯤魚緩緩浮出水面，牠的身體開始發出耀眼的光芒。隨著光芒越來越強，牠的形態開始轉變——魚鰭延展成翅膀，魚尾分裂為羽翼，龐大的身軀重構為鳥的形態。</p>
                <p class="text-gray-700 dark:text-gray-300 mb-3">光芒散去，一隻巨大無比的鳥出現在眼前——這就是傳說中的鵬鳥！牠的羽翼展開，遮天蔽日，如同浮動的雲層一般。</p>
                <p class="text-gray-700 dark:text-gray-300">鵬鳥發出一聲長鳴，震動天地，牠看向你，彷彿在邀請你一同飛向高空。</p>
              </div>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="transform-butterfly" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">化為胡蝶</button>
              <button id="call-kun" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">呼喚鵬鳥</button>
            </div>
          </div>
          
          <!-- 變形失敗場景 (初始隱藏) -->
          <div id="scene-transform-fail" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">力有未逮</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">你變化為胡蝶，試圖追隨鵬鳥飛向高空，但你很快發現胡蝶的形態太過脆弱，無法承受高空的狂風和稀薄的空氣。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">你的翅膀被強烈的氣流撕扯，不得不飛回地面。鵬鳥已經飛向遠方，你看著牠消失在雲層之中。</p>
              <p class="text-gray-700 dark:text-gray-300">看來，你需要找到更適合的方式來跟隨鵬鳥。</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 不同的形態有著不同的局限性。要追隨鵬鳥飛到九萬里高空，你需要一種更強大的形態。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="return-to-reef" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">返回礁石思考</button>
            </div>
          </div>
          
          <!-- 呼喚鵬鳥場景 (初始隱藏) -->
          <div id="scene-call-peng" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">與鵬對話</h2>
            <div class="sky-scene rounded-lg p-6 mb-4">
              <p class="text-white mb-4">你向鵬鳥呼喚，表達了想要隨牠一同飛翔的願望。巨大的鵬鳥降低高度，靠近你所在的礁石。</p>
              <p class="text-white mb-4">牠的眼睛如同深邃的湖泊，注視著你。你再次感受到那種直接的意識交流。</p>
            </div>
            
            <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg mb-4">
              <p class="italic text-indigo-700 dark:text-indigo-200">「渾沌的使者，你的形態無法承受高空的環境。」</p>
              <p class="italic text-indigo-700 dark:text-indigo-200 mt-2">「但我可以助你一臂之力。渾沌賦予你的物化之能還有更深的潛力——你不僅可以變化為已知的形態，還能向更高的境界提升。」</p>
              <p class="italic text-indigo-700 dark:text-indigo-200 mt-2">「集中你的意識，感受我的形態，嘗試超越自己的局限。若你能做到，就可以獲得新的形態——鯤鵬形態。」</p>
            </div>
            
            <div class="flex justify-center">
              <button id="try-kunpeng-form" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">嘗試鯤鵬形態</button>
            </div>
          </div>
          
          <!-- 鯤鵬形態挑戰場景 (初始隱藏) -->
          <div id="scene-kunpeng-challenge" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">形態挑戰</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">你閉上眼睛，集中意識，感受鯤與鵬的形態特質。你需要理解鯤鵬的本質，才能超越自己的局限。</p>
              <p class="text-gray-700 dark:text-gray-300">鵬鳥傳來一道信息：「回答我的問題，展示你對鯤鵬之道的理解。」</p>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-4">
              <p class="font-medium text-purple-800 dark:text-purple-200 mb-2">問題：莊子說「鵬之徙於南冥也，水擊三千里，摶扶搖而上者九萬里」，鵬鳥為何能飛得如此之高？</p>
              <div class="space-y-2 mt-3">
                <button class="debate-option w-full text-left p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition" data-answer="wrong1">
                  因為牠有著神話般的超凡力量
                </button>
                <button class="debate-option w-full text-left p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition" data-answer="correct">
                  因為牠懂得借助「扶搖」上升氣流，而非僅靠自身力量
                </button>
                <button class="debate-option w-full text-left p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition" data-answer="wrong2">
                  因為牠的翅膀比一般鳥類更加強大
                </button>
              </div>
            </div>
          </div>
          
          <!-- 九萬里高空場景 (初始隱藏) -->
          <div id="scene-high-sky" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">九萬里高空</h2>
            <div class="high-sky rounded-lg p-6 mb-4">
              <div class="flex justify-center">
                <div class="text-7xl peng-bird mb-4">🦅</div>
              </div>
              <p class="text-white mb-4">你成功變化為鯤鵬形態，跟隨著巨大的鵬鳥一同飛上高空。你的身體變得巨大而輕盈，翅膀可以輕易地掌握風的流向。</p>
              <p class="text-white mb-4">隨著高度不斷上升，大地在你眼中漸漸縮小。你俯視著下方的海洋、大陸、山脈和河流，整個世界的輪廓盡收眼底。</p>
              <p class="text-white">當達到九萬里的高度時，一切顯得如此渺小又如此完整。你理解了鯤鵬的視角——萬物雖各有形態，但從這個高度看，都是天地間的一部分，沒有絕對的界限。</p>
            </div>
            
            <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg mb-4">
              <p class="italic text-indigo-700 dark:text-indigo-200">「看到了嗎？」鵬鳥的聲音在你的意識中響起，「從這個高度，你能看到整體，而非局部；能看到本質，而非表象。」</p>
              <p class="italic text-indigo-700 dark:text-indigo-200 mt-2">「這就是右目之竅的洞察之力——看穿萬物的表象，直達宇宙的本源。」</p>
            </div>
            
            <div class="flex justify-center">
              <button id="understand-vision" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">領悟洞察之力</button>
            </div>
          </div>
          
          <!-- 獲得右目封印場景 (初始隱藏) -->
          <div id="scene-right-eye-seal" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-transform mb-2">✨</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">發現封印！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6 text-center">
              <p class="text-gray-700 dark:text-gray-300">
                在九萬里高空之上，一道光芒在雲層中閃耀——那是「右目之竅」的封印！
              </p>
              <div class="text-5xl my-4">👁️</div>
              <p class="text-gray-700 dark:text-gray-300">
                「右目之竅」象徵著洞察力，能夠超越表象看到本質。正如鯤鵬從九萬里高空俯瞰大地，看到的是整體而非局部。
              </p>
            </div>
            
            <div class="text-center">
              <button id="collect-right-eye" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">收集封印</button>
            </div>
          </div>
          
          <!-- 解鎖鯤鵬形態場景 (初始隱藏) -->
          <div id="scene-unlock-kunpeng" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-float mb-2">🦅</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">解鎖新的物化形態！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300 text-center">
                收集「右目之竅」的封印後，你獲得了新的物化能力：可以變化為鯤鵬，在海中自由游弋，又能在天空翱翔。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3 text-center italic">
                「北冥有魚，其名為鯤。鯤之大，不知其幾千里也。化而為鳥，其名為鵬。鵬之背，不知其幾千里也；怒而飛，其翼若垂天之雲。」
              </p>
            </div>
            
            <div class="text-center">
              <button id="return-with-kunpeng" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">以鯤鵬形態返回</button>
            </div>
          </div>
          
          <!-- 第二章完成場景 (初始隱藏) -->
          <div id="scene-ch2-complete" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-5xl mb-2">🎉</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">第二章完成！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300">
                你已成功完成第二章「北冥有魚」的探索！通過變化為鯤鵬，你體驗了從九萬里高空俯瞰大地的視角，理解了超越表象看清本質的洞察之力。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>解鎖成就：</strong>
              </p>
              <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 ml-4">
                <li>「鯤鵬之變」- 體驗鯤鵬的雙重形態</li>
                <li>「九萬里」- 從極高處俯瞰世界</li>
                <li>「右目之竅」- 收集第二枚渾沌封印</li>
              </ul>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>下一步：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300">
                渾沌的聲音告訴你：「鵷鶵笑之，此小大之辯也。」接下來，你需要尋找鵷鶵與鴟的故事，探索視角的相對性，收集「左耳之竅」的封印。
              </p>
            </div>
            
            <div class="text-center">
              <button id="to-chapter-three" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往第三章：鴟得腐鼠</button>
            </div>
          </div>
          
          <!-- 第三章：鴟得腐鼠 (初始隱藏) -->
          <div id="scene-ch3-intro" class="scene hidden">
            <div class="flex flex-col md:flex-row items-center md:items-start mb-4">
              <div class="text-6xl mb-4 md:mb-0 md:mr-6 animate-float">🦅</div>
              <div>
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">第三章：鴟得腐鼠</h2>
                <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                  <p class="mb-2">「惠子相梁，莊子往見之。或謂惠子曰：『莊子來，欲代子相。』於是惠子恐，搜於國中三日三夜。」</p>
                  <p class="mb-2">收集了左目和右目的封印后，你來到了惠子所在的魏國都城大梁。在這裡，權力之爭激烈，惠子擔任宰相一職，而許多人卻害怕失去權位。</p>
                  <p>渾沌告訴你，「左耳之竅」象徵著聆聽的能力——不僅聽到表面的言語，更能理解不同生物的內心與價值觀。在這個城市中，你需要傾聽不同立場的聲音，理解莊子的寓言。</p>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-4">
                  <p class="text-gray-700 dark:text-gray-300 text-sm italic">在這個章節中，鵷鶵和鴟的對比象徵著不同的生活態度：鵷鶵象徵高潔超脫的理想，而鴟（貓頭鷹）得腐鼠則象徵著沉迷於世俗權力的狹隘。你需要通過對比這兩種生物的視角，找到聆聽與理解的平衡。</p>
                </div>
                <div class="text-center">
                  <button id="ch3-start" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">進入梁國</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 斷句練習場景 (第三章) -->
          <div id="scene-sentence-ch3" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">斷句練習：鴟得腐鼠</h2>
            <p class="mb-2 text-gray-700 dark:text-gray-300">開始探索前，透過正確斷句來理解這個寓言故事。請點擊字與字之間的位置添加或移除斷句標記。</p>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">提示：這段有多處需要斷句。目前已添加 <span id="segment-count-ch3" class="font-medium text-primary">0</span> 處斷句。</p>
            
            <div class="mb-6 bg-white dark:bg-gray-700 p-6 rounded-lg shadow-sm">
              <div id="interactive-sentence-ch3" class="text-xl text-center leading-loose tracking-wider">
                <!-- 此处由JavaScript动态生成互动句子 -->
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">操作說明：</span> 點擊字與字之間的空白處添加或移除斷句點「•」。正確的斷句將幫助您理解莊子文本的結構和含義。
              </p>
            </div>
            
            <div class="flex justify-between mb-4">
              <button id="check-sentence-ch3" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">檢查斷句</button>
              <div>
                <button id="show-hint-ch3" class="bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition mr-2">顯示提示</button>
                <button id="show-correct-answer-ch3" data-chapter="ch3" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-medium transition">顯示正確答案</button>
              </div>
            </div>
            
            <div id="sentence-result-ch3" class="p-4 rounded-lg hidden"></div>
            
            <div id="sentence-hint-ch3" class="mt-4 p-4 bg-yellow-50 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-lg hidden">
              <p class="text-sm">提示：思考句子的自然停頓和語意單位。「惠子相梁」是第一個完整的句子片段。注意「南方有鳥」開始的描述段落。</p>
            </div>
            
            <div id="correct-answer-ch3" class="mt-4 p-4 bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hidden">
              <p class="text-sm font-medium">正確答案：</p>
              <p class="text-sm mt-2"></p>
            </div>
          </div>
          
          <!-- 梁國城門場景 -->
          <div id="scene-liang-gate" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">梁國城門</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">你來到了魏國都城大梁的城門前。守衛們警惕地看著進出的行人，城市的氣氛似乎緊張而壓抑。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">你聽到旁邊的行人在低聲交談：「聽說惠子大人下令在全城搜捕莊子，已經持續了三天三夜。」</p>
              <p class="text-gray-700 dark:text-gray-300">「為什麼？莊子不是他的朋友嗎？」</p>
              <p class="text-gray-700 dark:text-gray-300">「有人告訴惠子說莊子是來取代他做宰相的。惠子最近很緊張，生怕失去地位。」</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">思考：</span> 惠子為何如此害怕失去權位？莊子又會如何回應這種恐懼？
              </p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="transform-human" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">人形入城</button>
              <button id="transform-peng" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">鯤鵬高飛俯瞰</button>
            </div>
          </div>
          <!-- 人形入城場景 -->
        <div id="scene-human-city" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">大梁城中</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">你以人形進入大梁城，在街道上漫步。城中氣氛緊張，到處都能看到搜尋的士兵。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">經過一座華麗的府邸時，你聽到一位老者對年輕人說：「權位如浮雲，得之我幸，失之我命。看看惠大人，日日憂心忡忡，這又是何苦呢？」</p>
              <p class="text-gray-700 dark:text-gray-300">你繼續前行，發現道路分叉，一條通往宮殿區，一條通往城外的山林。</p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="go-to-palace" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">前往宮殿</button>
              <button id="go-to-forest" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">前往山林</button>
            </div>
          </div>
          
          <!-- 鯤鵬俯瞰場景 -->
          <div id="scene-peng-view" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">鯤鵬俯瞰梁國</h2>
            <div class="high-sky rounded-lg p-6 mb-4">
              <div class="flex justify-center">
                <div class="text-7xl peng-bird mb-4">🦅</div>
              </div>
              <p class="text-white mb-4">你變化為鯤鵬形態，翱翔於梁國上空。從這個高度，城市的布局清晰可見——宮殿區富麗堂皇，市井區人來人往，城外則是連綿的山林。</p>
              <p class="text-white mb-4">在宮殿區，你看到了搜捕的士兵四處奔走。惠子的府邸燈火通明，顯然他正憂心忡忡。</p>
              <p class="text-white">但你也注意到城外的山林中似乎有一處特別的地方，那裡有一棵高大的梧桐樹，樹下有一股清泉。這景象與渾沌描述的鵷鶵棲息之地極為相似。</p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="land-palace" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">降落宮殿區</button>
              <button id="land-forest" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">前往梧桐樹</button>
            </div>
          </div>
          
          <!-- 宮殿區場景 -->
          <div id="scene-palace" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">魏國宮殿</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">你來到宮殿區，發現整個區域戒備森嚴。守衛們檢查每一個出入的人。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">你偷聽到兩個官員的談話：</p>
              <div class="p-3 bg-gray-200 dark:bg-gray-600 rounded-lg">
                <p class="text-gray-700 dark:text-gray-300 mb-2">「惠大人今日召見了國內所有的賢士，詢問他們如何識別莊子。」</p>
                <p class="text-gray-700 dark:text-gray-300 mb-2">「那些人怎麼說？」</p>
                <p class="text-gray-700 dark:text-gray-300">「大多數人說莊子言談超脫，不在意世俗權位。但惠大人聽後更加擔憂，說這可能是莊子的偽裝。」</p>
              </div>
              <p class="text-gray-700 dark:text-gray-300 mt-3">你感覺到在這裡很難找到左耳之竅的線索，而且隨時可能被認出。</p>
            </div>
            
            <div class="flex justify-center">
              <button id="leave-to-forest" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">離開前往山林</button>
            </div>
          </div>
          
          <!-- 梧桐樹場景 -->
          <div id="scene-wutong" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">梧桐樹下</h2>
            <div class="forest-scene rounded-lg p-6 mb-4">
              <div class="flex flex-col items-center mb-3">
                <div class="text-6xl wutong-tree mb-2">🌳</div>
                <div class="text-white text-center">梧桐樹旁有一股清泉，泉水清澈甘甜，周圍環境寧靜優美。</div>
              </div>
              <p class="text-white mb-3">你來到傳說中鵷鶵棲息的梧桐樹下。這裡遠離城市的喧囂，只有淙淙的泉水聲和微風拂過樹葉的沙沙聲。</p>
              <p class="text-white">忽然，你聽到一陣優美的鳥鳴，一隻華麗如鳳凰般的鵷鶵飛來，停在梧桐樹的枝頭。牠的羽毛在陽光下閃爍著七彩光芒。</p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="observe-yuanchu" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">觀察鵷鶵</button>
              <button id="transform-yuanchu" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">嘗試化為鵷鶵</button>
            </div>
          </div>
          
          <!-- 觀察鵷鶵場景 -->
          <div id="scene-observe-bird" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">鵷鶵的優雅</h2>
            <div class="forest-scene rounded-lg p-6 mb-4">
              <div class="flex justify-center">
                <div class="text-7xl yuanchu-bird mb-4">🦢</div>
              </div>
              <p class="text-white mb-3">你靜靜地觀察著鵷鶵。牠時而飲泉水，時而啄食樹上的白色果實（練實），全然不顧世俗的紛爭。</p>
              <p class="text-white mb-3">忽然，一隻貓頭鷹（鴟）飛來，停在附近的樹枝上。貓頭鷹腳下抓著一隻腐鼠，得意洋洋地啃食著。</p>
              <p class="text-white">鵷鶵看了貓頭鷹一眼，發出一聲「嚇！」的驚嘆，然後繼續自己悠然的生活。你意識到這正是莊子寓言中的場景。</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 鵷鶵代表崇高的理想與自由，只棲息於梧桐樹，只飲用甘泉，只食用潔白的果實。而鴟（貓頭鷹）則滿足於腐鼠，猶如惠子執著於世俗權位。莊子藉此寓言告訴惠子，他不會覬覦惠子的宰相之位，就像鵷鶵不會在意貓頭鷹的腐鼠一樣。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="listen-carefully" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">專心聆聽兩鳥對話</button>
            </div>
          </div>
          
          <!-- 化為鵷鶵場景 -->
          <div id="scene-become-yuanchu" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">化為鵷鶵</h2>
            <div class="forest-scene rounded-lg p-6 mb-4">
              <div class="flex justify-center">
                <div class="text-7xl yuanchu-bird mb-4">🦢</div>
              </div>
              <p class="text-white mb-3">你嘗試感受鵷鶵的本質，讓自己的形態開始轉變。羽毛覆蓋全身，視野變得更加銳利，你成功變化為鵷鶵！</p>
              <p class="text-white mb-3">這種轉變讓你感受到前所未有的優雅與超脫。食物、住所、飲水都有最高的標準，只選擇最純淨的。</p>
              <p class="text-white">忽然，一隻貓頭鷹飛來，腳下抓著腐鼠。你本能地發出一聲「嚇！」的驚嘆，對這種低俗的食物感到不可思議。</p>
            </div>
            
            <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg mb-4">
              <p class="italic text-indigo-700 dark:text-indigo-200">「你為何對我的食物如此驚訝？」貓頭鷹問道。</p>
              <p class="italic text-indigo-700 dark:text-indigo-200 mt-2">「那腐爛的老鼠，怎能與我的潔白果實相比？」你以鵷鶵的身份回應。</p>
              <p class="italic text-indigo-700 dark:text-indigo-200 mt-2">「我滿足於現狀，而你卻永遠在追求更高、更純。我們各有所好，何必互相嘲笑？」貓頭鷹反問。</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 從鵷鶵的視角，你體會到了追求高潔的心態，但也理解到這可能導致對他人選擇的不理解。每種生物都有自己的生活方式和價值觀，傾聽和理解不同的聲音是獲得智慧的途徑。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="converse-chi" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">與鴟對話</button>
            </div>
          </div>
          
          <!-- 聆聽場景 -->
          <div id="scene-listening" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">傾聽的力量</h2>
            <div class="forest-scene rounded-lg p-6 mb-4">
              <div class="flex justify-center space-x-8">
                <div class="text-6xl yuanchu-bird">🦢</div>
                <div class="text-6xl chi-bird">🦉</div>
              </div>
              <div class="text-center mt-3 mb-4">
                <div class="inline-block text-4xl listening-effect ear-glow">👂</div>
              </div>
              <p class="text-white mb-3">你靜下心來，專注地聆聽兩鳥之間微妙的對話。隨著你聆聽的深入，你開始理解每個生物獨特的視角和價值觀。</p>
              <p class="text-white">鵷鶵追求高潔，鴟滿足現狀。兩者都有其存在的意義和價值，沒有絕對的對錯。這種包容與理解的能力，正是「左耳之竅」的精髓。</p>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-4">
              <p class="text-purple-800 dark:text-purple-200 mb-3">隨著你的傾聽，一股奇妙的能量在你的左耳處聚集，那是「左耳之竅」的封印正在顯現！</p>
              <p class="text-purple-800 dark:text-purple-200">封印散發著溫和的光芒，象徵著傾聽與理解的力量。當你能真正聆聽不同生物的聲音，理解不同的價值觀時，你也能獲得更廣闊的智慧。</p>
            </div>
            
            <div class="flex justify-center">
              <button id="collect-ear-seal" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">收集左耳封印</button>
            </div>
          </div>
          
          <!-- 與鴟對話場景 -->
          <div id="scene-talk-chi" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">與鴟對話</h2>
            <div class="forest-scene rounded-lg p-6 mb-4">
              <div class="flex justify-center space-x-8">
                <div class="text-6xl yuanchu-bird">🦢</div>
                <div class="text-6xl chi-bird">🦉</div>
              </div>
              
              <div class="mt-4 bg-white bg-opacity-20 p-3 rounded-lg">
                <p class="text-white italic mb-2">「你為何如此執著於那腐爛的老鼠？」你以鵷鶵的形態問道。</p>
                <p class="text-white italic mb-2">「對我來說，這是美味的食物，給我帶來滿足。」貓頭鷹回答，「我不需要梧桐樹的高度，也不需要甘泉的純淨。我只需要足夠的食物和安全的棲息地。」</p>
                <p class="text-white italic">「你為何嘲笑我？」貓頭鷹繼續道，「你飛向南海，又能得到什麼呢？」</p>
              </div>
              
              <p class="text-white mt-3">在與鴟的交談中，你開始理解不同生物的視角。鴟不是愚昧，而是有著不同的追求；鵷鶵不是高傲，而是有著不同的標準。在你傾聽的過程中，左耳附近漸漸聚集一股奇妙的能量。</p>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-4">
              <p class="text-purple-800 dark:text-purple-200 mb-3">當你完全理解兩種生物的視角後，「左耳之竅」的封印顯現了！封印散發著溫和的光芒，象徵著傾聽與理解的力量。</p>
              <p class="text-purple-800 dark:text-purple-200">這個寓言揭示了莊子不會覬覦惠子的宰相之位，就像鵷鶵不會在意鴟的腐鼠一樣。同時也表明每個生物都有自己的選擇，這些選擇各有價值，不應互相貶低。</p>
            </div>
            
            <div class="flex justify-center">
              <button id="collect-ear-seal-2" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">收集左耳封印</button>
            </div>
          </div>
          
          <!-- 獲得左耳封印場景 -->
          <div id="scene-ear-seal" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-transform mb-2">✨</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">發現封印！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6 text-center">
              <p class="text-gray-700 dark:text-gray-300">
                你收集了「左耳之竅」的封印！這是通往智慧的又一步。
              </p>
              <div class="text-5xl my-4 ear-glow">👂</div>
              <p class="text-gray-700 dark:text-gray-300">
                「左耳之竅」象徵著聆聽的能力——不僅聽到表面的言語，更能理解不同生物的內心與價值觀。正如莊子通過鵷鶵與鴟的寓言，讓惠子明白每個人都有不同的追求。
              </p>
            </div>
            
            <div class="text-center">
              <button id="complete-ch3" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">完成章節</button>
            </div>
          </div>
          
          <!-- 莊子與惠子相見場景 -->
          <div id="scene-zhuang-hui-meet" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">莊子與惠子相見</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">收集了「左耳之竅」的封印後，你決定前往梁國，尋找惠子。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">到達惠子的府邸，你看到他依然憂心忡忡，擔心著自己的地位被取代。</p>
              <div class="p-3 bg-gray-200 dark:bg-gray-600 rounded-lg mb-3">
                <p class="text-gray-700 dark:text-gray-300 italic">「惠子，你為何如此擔憂？」你問道。</p>
                <p class="text-gray-700 dark:text-gray-300 italic">「莊子，我聽說你要來取代我做宰相。」惠子緊張地回答。</p>
                <p class="text-gray-700 dark:text-gray-300 italic">「南方有鳥，其名為鵷鶵，子知之乎？夫鵷鶵，發於南海而飛於北海，非梧桐不止，非練實不食，非醴泉不飲。於是鴟得腐鼠，鵷鶵過之，仰而視之曰：『嚇！』今子欲以子之梁國而嚇我邪？」你微笑著說道。</p>
              </div>
              <p class="text-gray-700 dark:text-gray-300">惠子聽完後陷入沉思，漸漸放下了警惕。他明白了你無意爭奪他的職位，就像鵷鶵不會在意鴟的腐鼠一樣。</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 莊子通過鵷鶵與鴟的寓言表達了他對世俗權位的超脫態度。在這個寓言中，鵷鶵象徵崇高理想與自由，而鴟則象徵執著於世俗。莊子告訴惠子，他不會覬覦惠子的宰相之位，因為他追求的是精神上的自由，而非權力與地位。
              </p>
            </div>
            
            <div class="text-center">
              <button id="ch3-summary" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">章節總結</button>
            </div>
          </div>
          
          <!-- 第三章完成場景 -->
          <div id="scene-ch3-complete" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-5xl mb-2">🎉</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">第三章完成！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300">
                你已成功完成第三章「鴟得腐鼠」的探索！通過傾聽不同生物的聲音，理解不同的價值觀，你獲得了「左耳之竅」的封印。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>本章主題：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300 ml-4">
                聆聽與理解不同立場，超越表面的言語，感受不同生物的內心與價值觀。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>解鎖成就：</strong>
              </p>
              <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 ml-4">
                <li>「不同視角」- 理解鵷鶵與鴟的不同價值觀</li>
                <li>「傾聽之力」- 學會聆聽不同生物的聲音</li>
                <li>「左耳之竅」- 收集第三枚渾沌封印</li>
              </ul>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>下一步：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300">
                渾沌的聲音告訴你：「蝸角之爭，國之大也，惝然若有亡也。」接下來，你需要探索蝸牛左右角上國家的爭端，理解大小相對的概念，收集「右耳之竅」的封印。
              </p>
            </div>
            
            <div class="text-center">
              <button id="to-chapter-four" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往第四章：蝸角之爭</button>
            </div>
          </div>
          
          <!-- 第四章：蝸角之爭 (初始隱藏) -->
          <div id="scene-ch4-intro" class="scene hidden">
            <div class="flex flex-col md:flex-row items-center md:items-start mb-4">
              <div class="text-6xl mb-4 md:mb-0 md:mr-6 animate-float">🐌</div>
              <div>
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">第四章：蝸角之爭</h2>
                <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                  <p class="mb-2">「有所謂蝸者，君知之乎？有國於蝸之左角者曰觸氏，有國於蝸之右角者曰蠻氏，時相與爭地而戰，伏尸數萬，逐北旬有五日而後反。」</p>
                  <p class="mb-2">收集了左目、右目和左耳的封印後，你的感知能力已經大幅提升。這次，渾沌指引你去尋找「右耳之竅」的封印，象徵著分辨是非的能力和超越爭論的智慧。</p>
                  <p>在探索過程中，你遇見了一位名叫「戴晉人」的奇人，他向你講述了蝸牛左右角上兩個微小國家的爭戰。這個看似荒誕的故事，將帶你理解大小相對的概念。</p>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-4">
                  <p class="text-gray-700 dark:text-gray-300 text-sm italic">戴晉人說道：「王與蠻氏，有辯乎？」這個問題讓君王陷入了深思。在無限的宇宙空間中，相對大小、是非對錯常常失去了絕對的意義，這就是「右耳之竅」所象徵的智慧。</p>
                </div>
                <div class="text-center">
                  <button id="ch4-start" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">開始探索</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 斷句練習場景 (第四章) -->
          <div id="scene-sentence-ch4" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">斷句練習：蝸角之爭</h2>
            <p class="mb-2 text-gray-700 dark:text-gray-300">在深入探索前，透過正確斷句來理解蝸角之爭的寓言。請點擊字與字之間的位置添加或移除斷句標記。</p>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">提示：這段文字有多處需要斷句。目前已添加 <span id="segment-count-ch4" class="font-medium text-primary">0</span> 處斷句。</p>
            
            <div class="mb-6 bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm overflow-x-auto">
              <div id="interactive-sentence-ch4" class="text-lg text-center leading-loose tracking-wide">
                <!-- 由JavaScript動態生成互動句子 -->
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">操作說明：</span> 點擊字與字之間的空白處添加或移除斷句點「•」。正確的斷句將幫助您理解莊子文本的結構和含義。
              </p>
            </div>
            
            <div class="flex justify-between mb-4">
              <button id="check-sentence-ch4" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">檢查斷句</button>
              <div>
                <button id="show-hint-ch4" class="bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition mr-2">顯示提示</button>
                <button id="show-correct-answer-ch4" data-chapter="ch4" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-medium transition">顯示正確答案</button>
              </div>
            </div>
            
            <div id="sentence-result-ch4" class="p-4 rounded-lg hidden"></div>
            
            <div id="sentence-hint-ch4" class="mt-4 p-4 bg-yellow-50 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-lg hidden">
              <p class="text-sm">提示：思考句子的自然停頓和語意單位。注意「有所謂蝸者，君知之乎」是一個完整的問句。</p>
            </div>
            
            <div id="correct-answer-ch4" class="mt-4 p-4 bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hidden">
              <p class="text-sm font-medium">正確答案：</p>
              <p class="text-sm mt-2"></p>
            </div>
          </div>
          
          <!-- 戴晉人對話場景 -->
          <div id="scene-dai-talk" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">戴晉人的寓言</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">👨‍🦳</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">戴晉人：</p>
                  <p class="text-gray-700 dark:text-gray-300">「有所謂蝸者，君知之乎？」</p>
                </div>
              </div>
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">🧍</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">你：</p>
                  <p class="text-gray-700 dark:text-gray-300">「然。」（是的，我知道。）</p>
                </div>
              </div>
              <div class="flex items-start">
                <div class="text-4xl mr-3">👨‍🦳</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">戴晉人：</p>
                  <p class="text-gray-700 dark:text-gray-300">「有國於蝸之左角者曰觸氏，有國於蝸之右角者曰蠻氏，時相與爭地而戰，伏尸數萬，逐北旬有五日而後反。」</p>
                </div>
              </div>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                聽到這個故事，你心中充滿疑惑。蝸牛角上真的能有國家嗎？它們的戰爭對我們來說有多大意義？這些問題引發了你對大小相對性的思考。
              </p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="question-story" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">質疑故事</button>
              <button id="explore-snail" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">探索蝸牛世界</button>
            </div>
          </div>
          
          <!-- 質疑故事場景 -->
          <div id="scene-question" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">質疑與證實</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">🧍</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">你：</p>
                  <p class="text-gray-700 dark:text-gray-300">「噫！其虛言與？」（這不是虛構的話吧？）</p>
                </div>
              </div>
              <div class="flex items-start">
                <div class="text-4xl mr-3">👨‍🦳</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">戴晉人：</p>
                  <p class="text-gray-700 dark:text-gray-300 mb-3">「臣請為君實之。君以意在四方上下有窮乎？」</p>
                  <p class="text-gray-700 dark:text-gray-300 mb-3">（請讓我為您證實。您認為宇宙在四面八方上下有盡頭嗎？）</p>
                  <p class="text-gray-700 dark:text-gray-300">戴晉人接著引導你思考：在無限的宇宙中，我們所處的世界也許只是某個更大存在的一小部分，就如同蝸牛角上的國家對我們來說無比渺小一樣。</p>
                </div>
              </div>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-purple-800 dark:text-purple-200">
                <span class="font-medium">思考：</span> 如果宇宙無限大，那麼任何事物的大小都是相對的。對蝸牛角上的居民來說，他們的戰爭是重大事件；但對我們來說，卻幾乎看不見。同樣，我們的世界在更大的尺度下也可能如此渺小。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="continue-exploration" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">繼續探索</button>
            </div>
          </div>
          
          <!-- 蝸牛世界場景 -->
          <div id="scene-snail-world" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">蝸牛的世界</h2>
            <div class="snail-world p-6 mb-4">
              <div class="flex justify-center mb-4">
                <div class="text-7xl animate-float">🐌</div>
              </div>
              <div class="flex justify-center mb-6">
                <div class="w-full max-w-md bg-white bg-opacity-20 p-3 rounded-lg text-center">
                  <p class="text-white mb-2">調整視角尺度</p>
                  <input type="range" min="1" max="100" value="50" class="scale-slider mb-2" id="scale-slider">
                  <div class="flex justify-between text-xs text-white">
                    <span>微觀</span>
                    <span>正常</span>
                    <span>宏觀</span>
                  </div>
                </div>
              </div>
              
              <div id="zoom-container" class="zoom-container">
                <div class="flex justify-center space-x-12 mb-4">
                  <div class="snail-horn left-horn text-center">
                    <div class="text-3xl mb-1">🏯</div>
                    <p class="text-white text-sm">觸氏國</p>
                  </div>
                  <div class="snail-horn right-horn text-center">
                    <div class="text-3xl mb-1">🏯</div>
                    <p class="text-white text-sm">蠻氏國</p>
                  </div>
                </div>
                
                <div id="battle-scene" class="hidden text-center">
                  <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                    <p class="text-white mb-2">觸氏國與蠻氏國交界處</p>
                    <div class="flex justify-center space-x-2 mb-2">
                      <div class="text-lg">⚔️</div>
                      <div class="text-lg">🪖</div>
                      <div class="text-lg">⚔️</div>
                    </div>
                    <p class="text-white text-sm">兩國軍隊正在激烈交戰，伏尸數萬...</p>
                  </div>
                </div>
                
                <div id="world-perspective" class="text-center mt-4">
                  <p class="text-white">從目前的視角看，蝸牛角上的國家<span id="perspective-text">有一定的規模</span>。</p>
                </div>
              </div>
            </div>
            
            <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg mb-4">
              <p class="text-indigo-700 dark:text-indigo-200">
                當你調整視角尺度時，你意識到大小是相對的。從微觀視角，蝸牛角上的戰爭是場浩劫；從宏觀視角，它幾乎不可見。同樣，人類的爭端在宇宙尺度下也是如此渺小。
              </p>
              <p class="text-indigo-700 dark:text-indigo-200 mt-2">
                莊子通過這個寓言告訴我們：當我們能夠從不同尺度和視角看問題時，許多爭論便失去了意義。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="reflect-relativity" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">思考相對性</button>
            </div>
          </div>
          
          <!-- 相對性思考場景 -->
          <div id="scene-relativity" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">王與蠻氏</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <div class="flex items-start mb-4">
                <div class="text-4xl mr-3">👨‍🦳</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">戴晉人：</p>
                  <p class="text-gray-700 dark:text-gray-300">「知遊心於無窮，而反在通達之國，若存若亡乎？」</p>
                  <p class="text-gray-500 dark:text-gray-400 text-sm italic mt-1">（當心靈遊歷於無窮的境界後，再回到有限的國度，會不會感到這些事物似有似無？）</p>
                </div>
              </div>
              <div class="flex items-start mb-4">
                <div class="text-4xl mr-3">🧍</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">你：</p>
                  <p class="text-gray-700 dark:text-gray-300">「然。」（是的。）</p>
                </div>
              </div>
              <div class="flex items-start">
                <div class="text-4xl mr-3">👨‍🦳</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">戴晉人：</p>
                  <p class="text-gray-700 dark:text-gray-300">「通達之中有魏，於魏中有梁，於梁中有王。王與蠻氏，有辯乎？」</p>
                  <p class="text-gray-500 dark:text-gray-400 text-sm italic mt-1">（在這個大國中有魏國，在魏國中有梁城，在梁城中有國王。國王與蠻氏之間，有什麼區別嗎？）</p>
                </div>
              </div>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-purple-800 dark:text-purple-200">
                <span class="font-medium">思索：</span> 這個問題直指爭論的相對性。在無限大的宇宙中，國王與蝸牛角上的蠻氏之間，真的有本質區別嗎？兩者都不過是無限宇宙中的一個點而已。
              </p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="answer-no-difference" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">回答「無辯」</button>
              <button id="answer-has-difference" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition">回答「有辯」</button>
            </div>
          </div>
          
          <!-- 無辯回答場景 -->
          <div id="scene-no-difference" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">超越爭論</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <div class="flex items-start mb-4">
                <div class="text-4xl mr-3">🧍</div>
                <div>
                  <p class="font-medium text-gray-800 dark:text-gray-200">你：</p>
                  <p class="text-gray-700 dark:text-gray-300">「無辯。」（沒有區別。）</p>
                </div>
              </div>
              <p class="text-gray-700 dark:text-gray-300 mb-3">說完這句話，你感到一股清明之感油然而生。在宏觀視角下，所有的爭論都顯得如此渺小，一切差異都趨於相對。</p>
              <p class="text-gray-700 dark:text-gray-300">戴晉人微笑著離開，而你心中的渾沌聲音開始清晰起來。右耳旁出現了一種微妙的能量波動，似乎是「右耳之竅」的封印在呼應你的領悟。</p>
            </div>
            
            <div class="flex justify-center">
              <button id="find-right-ear" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">尋找右耳封印</button>
            </div>
          </div>
          
          <!-- 視角轉換場景 -->
          <div id="scene-perspective" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">視角轉換</h2>
            <div class="perspective-container p-6 mb-4">
              <!-- 宏觀層級 1: 宇宙 -->
              <div class="perspective-level" id="level-1">
                <div class="text-5xl mb-4">🌌</div>
                <h2 class="text-white text-2xl mb-2">宇宙視角</h2>
                <p class="text-white text-opacity-80">在浩瀚無垠的宇宙中，無數星雲與星系點綴著黑暗的太空</p>
                <div class="text-white mt-4 text-opacity-60 scroll-hint">↓ 往內觀察 ↓</div>
              </div>
              
              <!-- 宏觀層級 2: 星系 -->
              <div class="perspective-level" id="level-2">
                <div class="text-5xl mb-4">🌠</div>
                <h2 class="text-white text-2xl mb-2">星系視角</h2>
                <p class="text-white text-opacity-80">在這顆蔚藍色的行星上，有著無數的生命形態</p>
                <div class="text-white mt-4 text-opacity-60 scroll-hint">↓ 往內觀察 ↓</div>
              </div>
              
              <!-- 宏觀層級 3: 地球 -->
              <div class="perspective-level" id="level-3">
                <div class="text-5xl mb-4">🌏</div>
                <h2 class="text-white text-2xl mb-2">地球視角</h2>
                <p class="text-white text-opacity-80">山河湖海，萬物生靈，無數王國與國家興衰更替</p>
                <div class="text-white mt-4 text-opacity-60 scroll-hint">↓ 往內觀察 ↓</div>
              </div>
              
              <!-- 宏觀層級 4: 國度 -->
              <div class="perspective-level" id="level-4">
                <div class="text-5xl mb-4">🏞️</div>
                <h2 class="text-white text-2xl mb-2">通達之國</h2>
                <p class="text-white text-opacity-80">各國交通相連，在其中有魏國</p>
                <div class="text-white mt-4 text-opacity-60 scroll-hint">↓ 往內觀察 ↓</div>
              </div>
              
              <!-- 中間層級 5: 蝸牛 -->
              <div class="perspective-level active" id="level-5">
                <div class="flex space-x-12 mb-4">
                  <div class="text-center transform rotate-[-30deg]">
                    <div class="text-3xl mb-1">🏯</div>
                    <p class="text-white text-sm">觸氏國</p>
                  </div>
                  <div class="text-4xl">🐌</div>
                  <div class="text-center transform rotate-[30deg]">
                    <div class="text-3xl mb-1">🏯</div>
                    <p class="text-white text-sm">蠻氏國</p>
                  </div>
                </div>
                <h2 class="text-white text-2xl mb-2">蝸牛視角</h2>
                <p class="text-white text-opacity-80">蝸牛的左右角上各有一個國家，為了領土不斷爭戰</p>
                <div class="flex mt-4 justify-center">
                  <div class="bg-indigo-900 bg-opacity-40 p-2 rounded-lg">
                    <p class="text-white text-sm">兩國交界處戰火紛飛，伏尸數萬</p>
                  </div>
                </div>
              </div>
              
              <!-- 微觀層級 6: 魏國 -->
              <div class="perspective-level" id="level-6">
                <div class="text-5xl mb-4">🏙️</div>
                <h2 class="text-white text-2xl mb-2">魏國視角</h2>
                <p class="text-white text-opacity-80">魏國千里沃土，百姓安居</p>
                <p class="text-white text-opacity-80">在這國中有首都大梁</p>
                <div class="text-white mt-4 text-opacity-60 scroll-hint">↓ 往內觀察 ↓</div>
              </div>
              
              <!-- 微觀層級 7: 梁城 -->
              <div class="perspective-level" id="level-7">
                <div class="text-5xl mb-4">🏛️</div>
                <h2 class="text-white text-2xl mb-2">梁城視角</h2>
                <p class="text-white text-opacity-80">繁華的城市中，宮殿高聳，市集熱鬧</p>
                <p class="text-white text-opacity-80">在城中有王宮</p>
                <div class="text-white mt-4 text-opacity-60 scroll-hint">↓ 往內觀察 ↓</div>
              </div>
              
              <!-- 微觀層級 8: 宮殿 -->
              <div class="perspective-level" id="level-8">
                <div class="text-5xl mb-4">👑</div>
                <h2 class="text-white text-2xl mb-2">王宮視角</h2>
                <p class="text-white text-opacity-80">豪華的宮殿中，魏王日理萬機</p>
                <p class="text-white text-opacity-80">與他相比，蝸牛角上的國家似乎微不足道</p>
                <div class="text-white mt-4 text-opacity-60 scroll-hint">↓ 往內觀察 ↓</div>
              </div>
              
              <!-- 微觀層級 9: 魏王 -->
              <div class="perspective-level" id="level-9">
                <div class="text-5xl mb-4">👨‍👑</div>
                <h2 class="text-white text-2xl mb-2">魏王視角</h2>
                <p class="text-white text-opacity-80">魏王的思緒中，國家大事至關重要</p>
                <p class="text-white text-opacity-80">但在宇宙尺度下，這些事又有何分別？</p>
                
                <div class="mt-4 bg-white bg-opacity-20 p-3 rounded-lg">
                  <p class="text-white italic">"王與蠻氏，有辯乎？"</p>
                </div>
              </div>
              
              <div class="flex justify-center mt-4">
                <div class="w-full max-w-md bg-white bg-opacity-20 p-3 rounded-lg text-center">
                  <p class="text-white mb-2">調整視角尺度</p>
                  <input type="range" min="1" max="100" value="50" class="scale-slider mb-2" id="scale-slider-advanced">
                  <div class="flex justify-between text-xs text-white">
                    <span>宏觀視角</span>
                    <span>蝸牛世界</span>
                    <span>微觀視角</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 「右耳之竅」象徵著超越爭論的智慧——理解大小、是非的相對性，從而不執著於表面的對立。當我們能夠從多角度審視問題，許多爭論便可以和解或超越。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="perceive-seal" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">感知封印</button>
            </div>
          </div>
          
          <!-- 惝然若亡場景 -->
          <div id="scene-contemplation" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">惝然若亡</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">隨著戴晉人離開，你陷入了深思。就像原文中描述的「客出，而君惝然若有亡也」，你感到一種奇妙的空靈感，彷彿對世界的固有認知被撼動了。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">在這種「若存若亡」的狀態中，你開始理解爭論的相對性。所有的是非對錯、大小強弱，都取決於觀察的視角和尺度。</p>
              <p class="text-gray-700 dark:text-gray-300">忽然，你的右耳感受到一股特殊的能量，像是在回應你的頓悟。這是「右耳之竅」的封印，象徵著超越爭論、理解相對性的智慧。</p>
            </div>
            
            <div class="text-center">
              <div class="inline-block text-5xl animate-pulse ear-glow mb-4">👂</div>
            </div>
            
            <div class="flex justify-center">
              <button id="receive-seal" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">接收封印</button>
            </div>
          </div>
          
          <!-- 獲得右耳封印場景 -->
          <div id="scene-right-ear-seal" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-transform mb-2">✨</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">發現封印！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6 text-center">
              <p class="text-gray-700 dark:text-gray-300">
                你收集了「右耳之竅」的封印！這是通往渾沌智慧的第四步。
              </p>
              <div class="text-5xl my-4 ear-glow">👂</div>
              <p class="text-gray-700 dark:text-gray-300">
                「右耳之竅」象徵著分辨是非的能力，以及超越爭論的智慧。它讓你能夠理解大小、是非的相對性，看清爭端的本質，從而達到更高的思想境界。
              </p>
            </div>
            
            <div class="text-center">
              <button id="complete-ch4" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">完成章節</button>
            </div>
          </div>
          
          <!-- 第四章完成場景 -->
          <div id="scene-ch4-complete" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-5xl mb-2">🎉</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">第四章完成！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300">
                你已成功完成第四章「蝸角之爭」的探索！通過理解大小相對性的概念，你獲得了超越爭論的智慧，收集了「右耳之竅」的封印。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>本章主題：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300 ml-4">
                相對性、大小之辯、視角轉換、超越爭論的智慧
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>解鎖成就：</strong>
              </p>
              <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 ml-4">
                <li>「尺度轉換」- 體驗從微觀到宏觀的視角變化</li>
                <li>「若存若亡」- 理解事物存在的相對性</li>
                <li>「右耳之竅」- 收集第四枚渾沌封印</li>
              </ul>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>下一步：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300">
                渾沌的聲音告訴你：「朝菌不知晦朔，蟪蛄不知春秋。」接下來，你將探索時間的相對性，理解不同生命對時間的感知差異，尋找「左鼻之竅」的封印。
              </p>
            </div>
            
            <div class="text-center">
              <button id="to-chapter-five" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往第五章：朝菌與大椿</button>
            </div>
          </div>
          
          <!-- 第五章：朝菌與大椿 (初始隱藏) -->
          <div id="scene-ch5-intro" class="scene hidden">
            <div class="flex flex-col md:flex-row items-center md:items-start mb-4">
              <div class="text-6xl mb-4 md:mb-0 md:mr-6 animate-float">🍄</div>
              <div>
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">第五章：朝菌與大椿</h2>
                <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                  <p class="mb-2">「朝菌不知晦朔，蟪蛄不知春秋，此小年也。楚之南有冥靈者，以五百歲為春，五百歲為秋；上古有大椿者，以八千歲為春，八千歲為秋。」</p>
                  <p class="mb-2">收集了左目、右目和兩耳的封印後，你的感知能力已經極為敏銳。這次，渾沌指引你探索「左鼻之竅」的封印，象徵著對時間流逝的感知與超越。</p>
                  <p>在這個章節中，你將體驗不同生物對時間的感知差異：從朝生暮死的朝菌，到活千年的冥靈，再到萬壽的大椿樹。這些時間的相對性將啟發你對生命本質的思考。</p>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-4">
                  <p class="text-gray-700 dark:text-gray-300 text-sm italic">渾沌的聲音告訴你：「時間之內與時間之外，皆為一體。左鼻之竅能嗅聞時間的氣息，使你超越壽命的界限，體驗不同生物對時間的感知。」</p>
                </div>
                <div class="text-center">
                  <button id="ch5-start" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">開始探索</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 斷句練習場景 (第五章) -->
          <div id="scene-sentence-ch5" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">斷句練習：朝菌與大椿</h2>
            <p class="mb-2 text-gray-700 dark:text-gray-300">開始探索前，透過正確斷句來理解時間相對性的概念。請點擊字與字之間的位置添加或移除斷句標記。</p>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">提示：這段有多處需要斷句。目前已添加 <span id="segment-count-ch5" class="font-medium text-primary">0</span> 處斷句。</p>
            
            <div class="mb-6 bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm">
              <div id="interactive-sentence-ch5" class="text-lg text-center leading-loose tracking-wide">
                <!-- 由JavaScript動態生成互動句子 -->
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">操作說明：</span> 點擊字與字之間的空白處添加或移除斷句點「•」。正確的斷句將幫助您理解莊子文本的結構和含義。
              </p>
            </div>
            
            <div class="flex justify-between mb-4">
              <button id="check-sentence-ch5" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">檢查斷句</button>
              <div>
                <button id="show-hint-ch5" class="bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition mr-2">顯示提示</button>
                <button id="show-correct-answer-ch5" data-chapter="ch5" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-medium transition">顯示正確答案</button>
              </div>
            </div>
            
            <div id="sentence-result-ch5" class="p-4 rounded-lg hidden"></div>
            
            <div id="sentence-hint-ch5" class="mt-4 p-4 bg-yellow-50 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-lg hidden">
              <p class="text-sm">提示：思考句子的自然停頓和語意單位。「朝菌不知晦朔」是第一個完整的句子片段。</p>
            </div>
            
            <div id="correct-answer-ch5" class="mt-4 p-4 bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hidden">
              <p class="text-sm font-medium">正確答案：</p>
              <p class="text-sm mt-2"></p>
            </div>
          </div>
          
          <!-- 時間森林場景 -->
          <div id="scene-time-forest" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">時間的森林</h2>
            <div class="time-scene rounded-lg p-6 mb-4">
              <p class="text-white mb-4">你來到一片奇特的森林。這裡的時間似乎流動得很不一樣——有些地方光影變換極快，日夜更替如同眨眼；有些地方則幾乎靜止，宛如永恆的定格。</p>
              <p class="text-white mb-4">在森林中央，你看到三個不同的生命體：一片小小的蘑菇（朝菌）、一隻蟬（蟪蛄）和一棵高大古老的樹（大椿）。它們共同存在於這片空間，卻似乎生活在不同的時間流速中。</p>
              <p class="text-white">渾沌的聲音響起：「要找到左鼻之竅的封印，你需要親身體驗不同生命的時間感知。」</p>
            </div>
            
            <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg mb-4">
              <p class="text-indigo-700 dark:text-indigo-200">
                在這片森林中，你可以選擇體驗三種不同生命形態的時間感知。每種體驗都將揭示時間相對性的不同側面，幫助你更接近左鼻之竅的封印。
              </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <button id="experience-mushroom" class="p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition text-center">
                <div class="text-3xl mb-1">🍄</div>
                <p class="font-medium">體驗朝菌</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">朝生暮死的朝菌，它的一生只有一天</p>
              </button>
              <button id="experience-cicada" class="p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition text-center">
                <div class="text-3xl mb-1">🦗</div>
                <p class="font-medium">體驗蟪蛄</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">夏生秋死的蟬，它的一生歷經一個季節</p>
              </button>
              <button id="experience-tree" class="p-3 bg-white dark:bg-gray-600 hover:bg-gray-50 dark:hover:bg-gray-500 rounded-lg text-gray-700 dark:text-gray-300 transition text-center">
                <div class="text-3xl mb-1">🌳</div>
                <p class="font-medium">體驗大椿</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">萬年古樹，以千年為一季</p>
              </button>
            </div>
          </div>
          
          <!-- 朝菌體驗場景 -->
          <div id="scene-mushroom" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">朝菌的一生</h2>
            <div class="time-scene rounded-lg p-6 mb-4">
              <div class="flex justify-center mb-4">
                <div class="text-7xl morning-mushroom">🍄</div>
              </div>
              <p class="text-white mb-3">你的意識融入了朝菌，感受著一個極短生命的流逝。天剛破曉，你從土壤中冒出，迎接這一生唯一的清晨。</p>
              <p class="text-white mb-3">對你而言，一刻便如永恆，陽光的每一寸移動都是漫長的旅程。你無法理解「明天」的概念，因為你的全部生命都被壓縮在這短暫的一日之間。</p>
              <p class="text-white">晚霞漸漸染紅了天際，你感到生命在慢慢消退。「晦朔」（月亮的盈虧變化）對你來說是無法理解的宏大時間尺度，遑論「春秋」（季節更替）了。</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 朝菌的時間感知中，一日便是一生，它無法理解更大的時間尺度。對於人類難以想象的短暫生命，朝菌卻體驗得完整而充實。時間的長短並不決定生命的價值。
              </p>
            </div>
            
            <div class="text-center">
              <button id="return-time-forest-1" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">返回時間森林</button>
            </div>
          </div>
          <!-- 蟪蛄體驗場景 -->
        <div id="scene-cicada" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">蟪蛄的一生</h2>
            <div class="time-scene rounded-lg p-6 mb-4">
              <div class="flex justify-center mb-4">
                <div class="text-7xl animate-wave">🦗</div>
              </div>
              <p class="text-white mb-3">你的意識融入了蟪蛄（蟬），感受著短暫的蟬生。漫長的地下時光結束後，你破土而出，蛻變為成蟬。</p>
              <p class="text-white mb-3">盛夏時節，你的鳴叫聲響徹樹林。對你而言，夏天就是整個世界，你無法想象春天的嫩芽和冬天的寒冷。你的一生只認識夏季的炎熱和秋季的涼爽。</p>
              <p class="text-white">你看到身邊有些奇怪的生物，它們在短短一日間便生死輪迴，對你來說如同轉瞬即逝的幻影——那是朝菌。而那些巨大的、似乎永遠不會變化的存在，則是樹木，它們的時間流動緩慢得近乎靜止。</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 蟪蛄的時間尺度比朝菌長，能夠體驗季節變化，但仍無法理解年度的更替循環。在不同生命體驗中，時間的流速是相對的。對蟪蛄而言，朝菌如同瞬間；對大椿而言，人類如同朝菌。
              </p>
            </div>
            
            <div class="text-center">
              <button id="return-time-forest-2" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">返回時間森林</button>
            </div>
          </div>
          
          <!-- 大椿體驗場景 -->
          <div id="scene-big-tree" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">大椿的歲月</h2>
            <div class="time-scene rounded-lg p-6 mb-4">
              <div class="flex justify-center mb-4">
                <div class="text-7xl big-chun-tree animate-pulse-glow">🌳</div>
              </div>
              <p class="text-white mb-3">你的意識融入了大椿，感受著幾近永恆的時間流動。你的生命以千年計，「八千歲為春，八千歲為秋」，整個人類文明的興衰在你眼中不過是滄海一粟。</p>
              <p class="text-white mb-3">你看著朝菌和蟪蛄如同光影般閃爍，它們的生死在你的感知中快得幾乎無法察覺。人類的世代交替如同加速的畫面，帝國興衰、文明更迭都如同一場短暫的表演。</p>
              <p class="text-white">然而即使是大椿，也有盡頭。在宇宙的尺度下，萬年也不過彈指一揮間。你意識到時間的相對性——沒有絕對的長與短，只有不同生命在各自時間流中的體驗。</p>
            </div>
            
            <div class="flex justify-center mb-6">
              <div class="time-wheel">
                <div class="flex items-center justify-center h-full">
                  <div class="text-white text-lg font-bold">時間輪轉</div>
                </div>
              </div>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 大椿的時間感知中，千年如一季。它能夠見證人類文明的興衰，體驗宏大的時間尺度。然而即使如此，在宇宙的尺度下，大椿也是短暫的。時間的流動是相對的，沒有絕對的永恆。
              </p>
            </div>
            
            <div class="text-center">
              <button id="return-time-forest-3" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">返回時間森林</button>
            </div>
          </div>
          
          <!-- 時間融合場景 -->
          <div id="scene-time-fusion" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">時間的融合</h2>
            <div class="time-scene rounded-lg p-6 mb-4">
              <div class="flex justify-center space-x-8 mb-6">
                <div class="text-5xl animate-grow-shrink">🍄</div>
                <div class="text-5xl animate-wave">🦗</div>
                <div class="text-5xl animate-pulse-glow">🌳</div>
              </div>
              
              <p class="text-white mb-3">在體驗了三種不同生命的時間感知後，你開始感到一種奇妙的融合。朝菌、蟪蛄和大椿的時間觀念在你的意識中並行，讓你同時理解了不同的時間尺度。</p>
              <p class="text-white mb-3">你意識到，時間並非絕對的線性流動，而是隨著觀察者的生命形態和感知能力而變化。每種生物都有自己獨特的時間體驗，沒有哪一種比另一種更「真實」。</p>
              <p class="text-white">這種理解讓你超越了傳統的時間觀念，達到一種更高的覺悟。在這種狀態下，你感到鼻子左側出現了一股奇特的氣息——那是「左鼻之竅」的封印在呼應你的領悟。</p>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-4">
              <p class="text-purple-800 dark:text-purple-200 mb-3">隨著你對時間相對性的完全理解，「左鼻之竅」的封印顯現了！封印散發著一種古老而神秘的氣息，象徵著對時間流逝的感知與超越。</p>
              <p class="text-purple-800 dark:text-purple-200">「左鼻之竅」讓你能夠「嗅聞」時間的本質，理解不同生命對時間的感知，甚至在某種程度上超越時間的束縛。</p>
            </div>
            
            <div class="flex justify-center">
              <button id="collect-left-nose" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">收集左鼻封印</button>
            </div>
          </div>
          
          <!-- 獲得左鼻封印場景 -->
          <div id="scene-left-nose-seal" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-transform mb-2">✨</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">發現封印！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6 text-center">
              <p class="text-gray-700 dark:text-gray-300">
                你收集了「左鼻之竅」的封印！這是通往渾沌智慧的第五步。
              </p>
              <div class="text-5xl my-4 nose-glow">👃</div>
              <p class="text-gray-700 dark:text-gray-300">
                「左鼻之竅」象徵著對時間流逝的感知與超越。它讓你能夠理解不同生命對時間的感知差異，超越傳統的線性時間觀念，體驗時間的相對性。
              </p>
            </div>
            
            <div class="text-center">
              <button id="complete-ch5" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">完成章節</button>
            </div>
          </div>
          
          <!-- 第五章完成場景 -->
          <div id="scene-ch5-complete" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-5xl mb-2">🎉</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">第五章完成！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300">
                你已成功完成第五章「朝菌與大椿」的探索！通過體驗不同生命對時間的感知差異，你理解了時間的相對性，收集了「左鼻之竅」的封印。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>本章主題：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300 ml-4">
                時間的相對性、不同生命對時間的感知差異、超越線性時間觀念
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>解鎖成就：</strong>
              </p>
              <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 ml-4">
                <li>「時間旅行者」- 體驗不同生命的時間感知</li>
                <li>「朝生暮死」- 理解短暫生命的價值</li>
                <li>「左鼻之竅」- 收集第五枚渾沌封印</li>
              </ul>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>下一步：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300">
                渾沌的聲音告訴你：「彼亦一是非，此亦一是非。果且有彼是乎哉？果且無彼是乎哉？」接下來，你將探索「右鼻之竅」的封印，它象徵著對客觀與主觀的感知，以及對「彼是」「此非」的超越。
              </p>
            </div>
            
            <div class="text-center">
              <button id="to-chapter-six" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往第六章：彼是此非</button>
            </div>
          </div>
          
          <!-- 第六章：彼是此非 (初始隱藏) -->
          <div id="scene-ch6-intro" class="scene hidden">
            <div class="flex flex-col md:flex-row items-center md:items-start mb-4">
              <div class="text-6xl mb-4 md:mb-0 md:mr-6 animate-float">🧿</div>
              <div>
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">第六章：彼是此非</h2>
                <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                  <p class="mb-2">「既已為一矣，且得有言乎？既已謂之一矣，且得無言乎？一與言為二，二與一為三。自此以往，巧歷不能得，而況其凡乎！」</p>
                  <p class="mb-2">你已經收集了五個封印：左目、右目、左耳、右耳和左鼻。現在只剩下右鼻和口的封印未被找到。渾沌告訴你，「右鼻之竅」象徵著對客觀與主觀的感知，以及超越「是非」對立的智慧。</p>
                  <p>在這個章節中，你將探索莊子對「彼是此非」的超越——每個人都認為自己的觀點是對的，別人的是錯的，但這種判斷本身就是相對的。通過體驗不同視角的「是非」，你將尋找到右鼻之竅的封印。</p>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-4">
                  <p class="text-gray-700 dark:text-gray-300 text-sm italic">「混沌未開，彼此不分；有彼有此，是非已立。若能返回渾沌之境，超越彼此是非，便能尋得右鼻之竅。」渾沌的聲音在你心中迴響。</p>
                </div>
                <div class="text-center">
                  <button id="ch6-start" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">探索彼此是非</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 斷句練習場景 (第六章) -->
          <div id="scene-sentence-ch6" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">斷句練習：彼是此非</h2>
            <p class="mb-2 text-gray-700 dark:text-gray-300">開始探索前，透過正確斷句來理解莊子對「是非」的論述。請點擊字與字之間的位置添加或移除斷句標記。</p>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">提示：這段文字有多處需要斷句。目前已添加 <span id="segment-count-ch6" class="font-medium text-primary">0</span> 處斷句。</p>
            
            <div class="mb-6 bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm overflow-x-auto">
              <div id="interactive-sentence-ch6" class="text-lg text-center leading-loose tracking-wide">
                <!-- 由JavaScript動態生成互動句子 -->
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">操作說明：</span> 點擊字與字之間的空白處添加或移除斷句點「•」。正確的斷句將幫助您理解莊子文本的結構和含義。
              </p>
            </div>
            
            <div class="flex justify-between mb-4">
              <button id="check-sentence-ch6" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">檢查斷句</button>
              <div>
                <button id="show-hint-ch6" class="bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition mr-2">顯示提示</button>
                <button id="show-correct-answer-ch6" data-chapter="ch6" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-medium transition">顯示正確答案</button>
              </div>
            </div>
            
            <div id="sentence-result-ch6" class="p-4 rounded-lg hidden"></div>
            
            <div id="sentence-hint-ch6" class="mt-4 p-4 bg-yellow-50 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-lg hidden">
              <p class="text-sm">提示：思考句子的自然停頓和語意單位。注意文中關於「彼是此非」的對立關係。</p>
            </div>
            
            <div id="correct-answer-ch6" class="mt-4 p-4 bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hidden">
              <p class="text-sm font-medium">正確答案：</p>
              <p class="text-sm mt-2"></p>
            </div>
          </div>
          
          <!-- 辯論場景 -->
          <div id="scene-debate" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">彼此之辯</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">你來到一個奇特的場所，有兩位辯論者正在激烈討論。他們爭論的焦點是「何謂真正的是與非」。</p>
              <p class="text-gray-700 dark:text-gray-300">每個人都堅信自己的觀點是對的，而對方是錯的。當你靠近時，辯論者邀請你加入他們的討論。</p>
            </div>
            
            <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-4">
              <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg flex-1">
                <div class="flex items-start mb-2">
                  <div class="text-4xl mr-3">👨‍🏫</div>
                  <p class="font-medium text-blue-800 dark:text-blue-200">辯論者甲：</p>
                </div>
                <p class="text-blue-700 dark:text-blue-300">「是非之分必須有客觀標準。若無標準，世間將陷入混亂。我的觀點基於普遍真理，因此是正確的。」</p>
              </div>
              
              <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg flex-1">
                <div class="flex items-start mb-2">
                  <div class="text-4xl mr-3">👩‍🏫</div>
                  <p class="font-medium text-purple-800 dark:text-purple-200">辯論者乙：</p>
                </div>
                <p class="text-purple-700 dark:text-purple-300">「所謂『客觀標準』也是主觀建立的。每個人都從自身角度出發，認為自己的是就是真是，自己的非就是真非。」</p>
              </div>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">思考：</span> 這兩種觀點各有道理。一個強調客觀標準的必要性，一個指出所謂「客觀」也可能是主觀建構的。莊子的思想主張超越這種對立，理解「彼是此非」的相對性。
              </p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="support-a" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">支持辯論者甲</button>
              <button id="support-b" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition">支持辯論者乙</button>
              <button id="transcend-debate" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">超越爭論</button>
            </div>
          </div>
          
          <!-- 支持甲方場景 -->
          <div id="scene-support-a" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">客觀標準之辯</h2>
            <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg mb-4">
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">🧍</div>
                <div>
                  <p class="font-medium text-blue-800 dark:text-blue-200">你：</p>
                  <p class="text-blue-700 dark:text-blue-300">「我認為必須有客觀標準來判斷是非。如果一切都是相對的，那麼我們就無法建立共識，社會將無法運作。」</p>
                </div>
              </div>
              
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">👨‍🏫</div>
                <div>
                  <p class="font-medium text-blue-800 dark:text-blue-200">辯論者甲：</p>
                  <p class="text-blue-700 dark:text-blue-300">「正是如此！沒有客觀標準，就沒有秩序。我們需要明確的是非界限。」</p>
                </div>
              </div>
              
              <div class="flex items-start">
                <div class="text-4xl mr-3">👩‍🏫</div>
                <div>
                  <p class="font-medium text-blue-800 dark:text-blue-200">辯論者乙：</p>
                  <p class="text-blue-700 dark:text-blue-300">「但誰來決定這個『客觀標準』呢？不同文化、不同時代有不同的標準。你所謂的『客觀』，在另一個視角下可能是完全主觀的判斷。」</p>
                </div>
              </div>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">反思：</span> 雖然客觀標準有其必要性，但也需要認識到不同視角下標準的差異。莊子的思想提醒我們，過於執著於單一標準可能忽略了其他可能的真理。嘗試從更高的層次思考這個問題。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="reconsider-position" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">重新思考立場</button>
            </div>
          </div>
          
          <!-- 支持乙方場景 -->
          <div id="scene-support-b" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">主觀視角之辯</h2>
            <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-4">
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">🧍</div>
                <div>
                  <p class="font-medium text-purple-800 dark:text-purple-200">你：</p>
                  <p class="text-purple-700 dark:text-purple-300">「我認為是非判斷總是從主觀視角出發。每個人都認為自己的觀點是對的，這種『是』與『非』本身就是相對的。」</p>
                </div>
              </div>
              
              <div class="flex items-start mb-3">
                <div class="text-4xl mr-3">👩‍🏫</div>
                <div>
                  <p class="font-medium text-purple-800 dark:text-purple-200">辯論者乙：</p>
                  <p class="text-purple-700 dark:text-purple-300">「正是如此！『彼是』之所以為是，只因彼視角；『此非』之所以為非，只因此立場。一切判斷都是相對的。」</p>
                </div>
              </div>
              
              <div class="flex items-start">
                <div class="text-4xl mr-3">👨‍🏫</div>
                <div>
                  <p class="font-medium text-purple-800 dark:text-purple-200">辯論者甲：</p>
                  <p class="text-purple-700 dark:text-purple-300">「但如果一切都是相對的，那麼你的這個觀點也是相對的，不是嗎？你無法證明『一切是非都是相對的』這個判斷本身是絕對的。」</p>
                </div>
              </div>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">反思：</span> 雖然認識到是非的相對性很重要，但如果走向極端相對主義，也會陷入自相矛盾。莊子的思想既不是絕對主義，也不是純粹的相對主義，而是超越二者的更高境界。嘗試從更全面的角度思考這個問題。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="reconsider-position-2" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">重新思考立場</button>
            </div>
          </div>
          
          <!-- 超越爭論場景 -->
          <div id="scene-beyond-debate" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">坐忘與心齋</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">你沒有立即選擇支持任何一方，而是陷入沉思。這讓你想起莊子提到的「坐忘」與「心齋」的境界——忘卻成見，淨化心靈，超越是非對立的執著。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">在這種狀態下，你開始意識到，辯論雙方都囿於各自的視角，無法看到全局。客觀與主觀、絕對與相對，這些對立的觀念本身就是人為建構的分別。</p>
              <p class="text-gray-700 dark:text-gray-300">正如莊子所言：「彼亦一是非，此亦一是非。果且有彼是乎哉？果且無彼是乎哉？彼是莫得其偶，謂之道樞。」意思是每個人都有自己的是非標準，但這些標準本身是相對的。真正的智慧在於超越這些對立，理解「道樞」——萬物的根本。</p>
            </div>
            
            <div class="flex justify-center mb-6">
              <div class="chaos-orb wuhua-effect">
                <div class="flex items-center justify-center h-full">
                  <div class="text-white text-lg font-bold">渾沌之境</div>
                </div>
              </div>
            </div>
            
            <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg mb-4">
              <p class="text-indigo-700 dark:text-indigo-200">
                當你達到這種超越是非對立的境界時，你感到鼻子右側出現了一股奇特的氣息——那是「右鼻之竅」的封印，正在回應你對「彼是此非」的超越。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="collect-right-nose" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">收集右鼻封印</button>
            </div>
          </div>
          
          <!-- 思考反思場景 -->
          <div id="scene-reflection" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">物化與逍遙</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4">
              <p class="text-gray-700 dark:text-gray-300 mb-3">在思考雙方觀點後，你開始理解莊子思想的更深層含義。無論是堅持客觀標準還是主張一切相對，都是執著於某種判斷，無法達到真正的逍遙。</p>
              <p class="text-gray-700 dark:text-gray-300 mb-3">莊子的「物化」思想強調的是超越人為設定的界限，理解萬物的相互轉化和流動。當你超越「彼是此非」的執著，進入物化的境界，就能達到真正的逍遙。</p>
              <p class="text-gray-700 dark:text-gray-300">在這種領悟中，你感到鼻子右側出現了一股奇特的氣息——「右鼻之竅」的封印正在顯現，象徵著對客觀與主觀的超越。</p>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-4">
              <p class="text-purple-800 dark:text-purple-200 mb-3">「右鼻之竅」的封印散發著一種平靜而深邃的氣息，象徵著對「彼是此非」的超越。</p>
              <p class="text-purple-800 dark:text-purple-200">這個封印讓你能夠「嗅聞」是非背後的本質，理解判斷的相對性，達到莊子所說的「坐忘」與「心齋」的境界。</p>
            </div>
            
            <div class="flex justify-center">
              <button id="collect-right-nose-2" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">收集右鼻封印</button>
            </div>
          </div>
          
          <!-- 獲得右鼻封印場景 -->
          <div id="scene-right-nose-seal" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-transform mb-2">✨</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">發現封印！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6 text-center">
              <p class="text-gray-700 dark:text-gray-300">
                你收集了「右鼻之竅」的封印！這是通往渾沌智慧的第六步。
              </p>
              <div class="text-5xl my-4 nose-glow">👃</div>
              <p class="text-gray-700 dark:text-gray-300">
                「右鼻之竅」象徵著對客觀與主觀的感知，以及對「彼是此非」的超越。它讓你能夠理解判斷的相對性，達到物化與逍遙的境界。
              </p>
            </div>
            
            <div class="text-center">
              <button id="complete-ch6" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">完成章節</button>
            </div>
          </div>
          
          <!-- 第六章完成場景 -->
          <div id="scene-ch6-complete" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-5xl mb-2">🎉</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">第六章完成！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300">
                你已成功完成第六章「彼是此非」的探索！通過理解判斷的相對性，超越是非對立的執著，你獲得了「右鼻之竅」的封印。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>本章主題：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300 ml-4">
                是非的相對性、超越對立、坐忘與心齋、物化與逍遙
              </p>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>解鎖成就：</strong>
              </p>
              <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 ml-4">
                <li>「超越對立」- 理解「彼是此非」的相對性</li>
                <li>「物化境界」- 體驗莊子的「坐忘」與「心齋」</li>
                <li>「右鼻之竅」- 收集第六枚渾沌封印</li>
              </ul>
              <p class="text-gray-700 dark:text-gray-300 mt-3">
                <strong>下一步：</strong>
              </p>
              <p class="text-gray-700 dark:text-gray-300">
                渾沌的聲音告訴你：「六竅已通，唯剩口竅。通往逍遙之道的最後一步，需探尋語言與沉默的界限，體驗『言在於得意』的境界。」
              </p>
            </div>
            
            <div class="text-center">
              <button id="to-epilogue" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">前往終章：渾沌復生</button>
            </div>
          </div>
          
          <!-- 終章：渾沌復生 (初始隱藏) -->
          <div id="scene-epilogue-intro" class="scene hidden">
            <div class="flex flex-col md:flex-row items-center md:items-start mb-4">
              <div class="text-6xl mb-4 md:mb-0 md:mr-6 animate-float">🔮</div>
              <div>
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-primary">終章：渾沌復生</h2>
                <div class="story-text text-gray-700 dark:text-gray-300 mb-4">
                  <p class="mb-2">「南海之帝為儵，北海之帝為忽，中央之帝為渾沌。儵與忽時相與遇於渾沌之地，渾沌待之甚善。儵與忽謀報渾沌之德，曰：『人皆有七竅，以視聽食息，此獨無有，嘗試鑿之。』日鑿一竅，七日而渾沌死。」</p>
                  <p class="mb-2">你已經找回了六個封印：左目、右目、左耳、右耳、左鼻、右鼻。現在只剩下最後一個封印——「口之竅」，象徵著語言與沉默、表達與體悟的平衡。</p>
                  <p>在終章中，你將面對最後的挑戰：探尋語言的極限，理解「得意忘言」的境界，找回「口之竅」的封印，幫助渾沌恢復完整，讓萬物重獲物化之道。</p>
                </div>
                <div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-4">
                  <p class="text-gray-700 dark:text-gray-300 text-sm italic">「七竅開鑿，本為善意，卻使渾沌失去了本真。現在你已找回六竅的封印，只剩最後一竅。記住：言者所以在意，得意而忘言。」渾沌的聲音變得比以往任何時候都更加清晰。</p>
                </div>
                <div class="text-center">
                  <button id="epilogue-start" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">尋找最後的封印</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- 斷句練習場景 (終章) -->
          <div id="scene-sentence-epilogue" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">斷句練習：渾沌之死</h2>
            <p class="mb-2 text-gray-700 dark:text-gray-300">在最後的探索前，透過正確斷句來理解渾沌的故事。請點擊字與字之間的位置添加或移除斷句標記。</p>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-4">提示：這段有多處需要斷句。目前已添加 <span id="segment-count-epilogue" class="font-medium text-primary">0</span> 處斷句。</p>
            
            <div class="mb-6 bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm overflow-x-auto">
              <div id="interactive-sentence-epilogue" class="text-lg text-center leading-loose tracking-wide">
                <!-- 由JavaScript動態生成互動句子 -->
              </div>
            </div>
            
            <div class="bg-blue-50 dark:bg-blue-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-blue-800 dark:text-blue-200">
                <span class="font-medium">操作說明：</span> 點擊字與字之間的空白處添加或移除斷句點「•」。正確的斷句將幫助您理解莊子文本的結構和含義。
              </p>
            </div>
            
            <div class="flex justify-between mb-4">
              <button id="check-sentence-epilogue" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">檢查斷句</button>
              <div>
                <button id="show-hint-epilogue" class="bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200 px-4 py-2 rounded-lg font-medium transition mr-2">顯示提示</button>
                <button id="show-correct-answer-epilogue" data-chapter="epilogue" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-medium transition">顯示正確答案</button>
              </div>
            </div>
            
            <div id="sentence-result-epilogue" class="p-4 rounded-lg hidden"></div>
            
            <div id="sentence-hint-epilogue" class="mt-4 p-4 bg-yellow-50 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded-lg hidden">
              <p class="text-sm">提示：思考句子的自然停頓和語意單位。「南海之帝為儵」是第一個完整的句子片段。</p>
            </div>
            
            <div id="correct-answer-epilogue" class="mt-4 p-4 bg-green-50 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-lg hidden">
              <p class="text-sm font-medium">正確答案：</p>
              <p class="text-sm mt-2"></p>
            </div>
          </div>
          
          <!-- 言意之境場景 -->
          <div id="scene-language-meaning" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">言與意的邊界</h2>
            <div class="chaos-rebirth rounded-lg p-6 mb-4">
              <p class="text-white mb-4">你來到一片神秘的空間，這裡似乎是言語與意義交織的領域。空氣中漂浮著無數發光的文字，它們不斷變換形態，時而組合，時而分散。</p>
              <p class="text-white">渾沌的聲音響起：「言者所以在意，得意而忘言。覓得『口之竅』的封印，需體悟言語的極限，理解沉默的力量。」</p>
            </div>
            
            <div class="bg-indigo-50 dark:bg-indigo-900 p-4 rounded-lg mb-4">
              <p class="text-indigo-700 dark:text-indigo-200">
                「口之竅」象徵著語言與沉默、表達與體悟的平衡。在這個最後的挑戰中，你需要理解言語的限制，體會「得意忘言」的境界。
              </p>
            </div>
            
            <div class="flex justify-center space-x-4">
              <button id="explore-language" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition">探索言語</button>
              <button id="experience-silence" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition">體驗沉默</button>
            </div>
          </div>
          
          <!-- 探索言語場景 -->
          <div id="scene-explore-language" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">言語的迷宮</h2>
            <div class="chaos-rebirth rounded-lg p-6 mb-4">
              <p class="text-white mb-4">你決定探索言語的本質。隨著深入，你發現自己進入了一個文字構成的迷宮。每一個詞語都通向更多的詞語，定義與解釋無窮無盡地延伸。</p>
              <p class="text-white mb-4">你嘗試用言語描述你的體驗，但卻發現越是精確的描述，反而離真實體驗越遠。就像用網捕風，言語永遠無法完全捕捉經驗的全貌。</p>
              <p class="text-white">在迷宮的中心，你看到一個發光的字符，那是「言」字。隨著你靠近，「言」字開始分解，化為無數碎片，最後歸於沉默。</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 言語是傳達意義的工具，但也有其局限性。正如莊子所言：「得魚忘筌，得兔忘蹄」，一旦得到意義，就應當超越言語的限制。語言的真正價值在於指引人們達到超越語言本身的領悟。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="return-to-silence" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">走向沉默</button>
            </div>
          </div>
          
          <!-- 體驗沉默場景 -->
          <div id="scene-experience-silence" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">沉默的智慧</h2>
            <div class="chaos-rebirth rounded-lg p-6 mb-4">
              <div class="flex justify-center mb-6">
                <div class="text-7xl">🔍</div>
              </div>
              <p class="text-white mb-4">你選擇了沉默。隨著外在的聲音漸漸消退，你進入了一種特殊的感知狀態。在這裡，不需要言語，意義直接傳達。</p>
              <p class="text-white mb-4">無需言說，你開始理解萬物的本質。就像莊子所描述的「坐忘」境界，心靈清明，與道合一。在這種狀態下，言語反而成為障礙。</p>
              <p class="text-white">然而，你也意識到完全的沉默並非終點。「言」與「默」本是一體的兩面，真正的智慧在於理解二者的平衡。</p>
            </div>
            
            <div class="bg-yellow-50 dark:bg-yellow-900 p-3 rounded-lg mb-4">
              <p class="text-sm text-yellow-800 dark:text-yellow-200">
                <span class="font-medium">領悟：</span> 沉默不是言語的對立面，而是其補充。真正的智慧既能善用言語表達，又能超越言語的限制，達到「言意合一」的境界。這種平衡，正是「口之竅」所象徵的。
              </p>
            </div>
            
            <div class="flex justify-center">
              <button id="find-balance" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">尋找平衡</button>
            </div>
          </div>
          
          <!-- 言默平衡場景 -->
          <div id="scene-balance" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">言意合一</h2>
            <div class="chaos-rebirth rounded-lg p-6 mb-4">
              <div class="flex justify-center mb-6">
                <div class="text-7xl">☯️</div>
              </div>
              <p class="text-white mb-4">通過探索言語的迷宮和體驗沉默的力量，你開始理解「言」與「默」的平衡。正如陰陽相生，言語與沉默也是相互補充的。</p>
              <p class="text-white mb-4">言語傳達意義，但也有其局限；沉默直指本心，但難以交流。真正的智慧在於掌握何時言說，何時保持沉默，達到「言意合一」的境界。</p>
              <p class="text-white">在這種理解中，你感到一股特殊的能量在你的口部聚集——「口之竅」的封印正在顯現。</p>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-4">
              <p class="text-purple-800 dark:text-purple-200 mb-3">「口之竅」的封印散發著微妙的能量，它既不是言語，也不是沉默，而是二者的完美結合。</p>
              <p class="text-purple-800 dark:text-purple-200">這個封印象徵著言意的平衡，表達與體悟的和諧。它讓你能夠理解語言的力量，同時超越語言的限制，達到莊子所說的「得意忘言」境界。</p>
            </div>
            
            <div class="flex justify-center">
              <button id="collect-mouth-seal" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">收集口竅封印</button>
            </div>
          </div>
          
          <!-- 獲得口竅封印場景 -->
          <div id="scene-mouth-seal" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl inline-block animate-transform mb-2">✨</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">發現封印！</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6 text-center">
              <p class="text-gray-700 dark:text-gray-300">
                你收集了最後一個封印——「口之竅」！這是通往渾沌智慧的第七步。
              </p>
              <div class="text-5xl my-4">👄</div>
              <p class="text-gray-700 dark:text-gray-300">
                「口之竅」象徵著語言與沉默、表達與體悟的平衡。它讓你能夠理解言語的力量，同時超越言語的限制，達到「得意忘言」的境界。
              </p>
            </div>
            
            <div class="text-center">
              <button id="restore-hundun" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">恢復渾沌</button>
            </div>
          </div>
          
          <!-- 七竅齊全場景 -->
          <div id="scene-seven-seals" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">七竅齊全</h2>
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-4 text-center">
              <p class="text-gray-700 dark:text-gray-300 mb-4">
                七竅的封印全部集齊了！它們分別是：
              </p>
              <div class="grid grid-cols-2 md:grid-cols-7 gap-4 mb-4">
                <div class="text-center">
                  <div class="text-4xl mb-1">👁️</div>
                  <p class="text-sm text-gray-700 dark:text-gray-300">左目之竅</p>
                </div>
                <div class="text-center">
                  <div class="text-4xl mb-1">👁️</div>
                  <p class="text-sm text-gray-700 dark:text-gray-300">右目之竅</p>
                </div>
                <div class="text-center">
                  <div class="text-4xl mb-1">👂</div>
                  <p class="text-sm text-gray-700 dark:text-gray-300">左耳之竅</p>
                </div>
                <div class="text-center">
                  <div class="text-4xl mb-1">👂</div>
                  <p class="text-sm text-gray-700 dark:text-gray-300">右耳之竅</p>
                </div>
                <div class="text-center">
                  <div class="text-4xl mb-1">👃</div>
                  <p class="text-sm text-gray-700 dark:text-gray-300">左鼻之竅</p>
                </div>
                <div class="text-center">
                  <div class="text-4xl mb-1">👃</div>
                  <p class="text-sm text-gray-700 dark:text-gray-300">右鼻之竅</p>
                </div>
                <div class="text-center md:col-span-1">
                  <div class="text-4xl mb-1">👄</div>
                  <p class="text-sm text-gray-700 dark:text-gray-300">口之竅</p>
                </div>
              </div>
              
              <p class="text-gray-700 dark:text-gray-300 mb-6">
                随著最後一個封印的收集，你感到能量在體內流動，七個封印開始共鳴，散發出耀眼的光芒。
              </p>
              
              <div class="relative completed-seals w-40 h-40 mx-auto mb-6">
                <div class="seal"></div>
                <div class="seal"></div>
                <div class="seal"></div>
                <div class="seal"></div>
                <div class="seal"></div>
                <div class="seal"></div>
                <div class="seal"></div>
                <div class="absolute inset-0 flex items-center justify-center">
                  <div class="text-6xl">🔮</div>
                </div>
              </div>
              
              <p class="text-gray-700 dark:text-gray-300">
                渾沌的聲音變得無比清晰：「七竅的封印已經齊全，是時候恢復我的本真了。準備好感受萬物逍遙的境界吧！」
              </p>
            </div>
            
            <div class="text-center">
              <button id="final-transformation" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">最終轉化</button>
            </div>
          </div>
          
          <!-- 渾沌復生場景 -->
          <div id="scene-hundun-rebirth" class="scene hidden">
            <h2 class="text-xl md:text-2xl font-bold mb-4 text-primary">渾沌復生</h2>
            <div class="chaos-rebirth rounded-lg p-6 mb-4">
              <div class="flex justify-center mb-6">
                <div class="text-7xl animate-pulse-glow">🔮</div>
              </div>
              <p class="text-white mb-4">隨著七個封印歸位，一股強大的能量波動席捲四方。你感到自己的意識擴展到前所未有的境界，能夠同時理解和體驗不同的存在形態。</p>
              <p class="text-white mb-4">人與蝶、魚與鳥、朝菌與大椿之間的界限完全消失。你超越了時間與空間、言語與沉默、是非與對錯的二元對立，進入了莊子所描述的「逍遙遊」境界。</p>
              <p class="text-white">渾沌的形象在你面前顯現——一個沒有明確形態的存在，既不是這個，也不是那個，而是萬物本源的狀態。你意識到，渾沌並非某種具體的生物，而是未分化、未定形的原初狀態。</p>
            </div>
            
            <div class="bg-purple-50 dark:bg-purple-900 p-4 rounded-lg mb-4">
              <p class="text-purple-800 dark:text-purple-200 mb-3">在渾沌復生的一刻，你理解了莊子哲學的核心——「物化」與「逍遙」。</p>
              <p class="text-purple-800 dark:text-purple-200 mb-3">「物化」指的是萬物相互轉化的流動狀態，沒有絕對的界限和定義。「逍遙」則是超越一切對立和束縛，達到心靈自由的境界。</p>
              <p class="text-purple-800 dark:text-purple-200">正如渾沌的七竅被鑿開使其失去本真，人類的分別心和執著也讓我們失去了與道合一的自然狀態。通過重新認識這些「竅」的意義，你已經找回了真正的自由。</p>
            </div>
            
            <div class="text-center">
              <button id="epilogue-complete" class="bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">圓滿結局</button>
            </div>
          </div>
          
          <!-- 遊戲結局場景 -->
          <div id="scene-game-end" class="scene hidden">
            <div class="text-center mb-6">
              <div class="text-6xl mb-2">🎊</div>
              <h2 class="text-xl md:text-2xl font-bold text-primary">萬物逍遙</h2>
            </div>
            
            <div class="bg-gray-100 dark:bg-gray-700 p-4 rounded-lg mb-6">
              <p class="text-gray-700 dark:text-gray-300 mb-4">
                恭喜你完成了「萬物逍遙」的旅程！通過探索莊子哲學的各個方面，你幫助渾沌恢復了本真，讓萬物重獲物化之道。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mb-4">
                在這段旅程中，你體驗了「莊周夢蝶」的物我不分、「子非魚」的視角相對、「鯤鵬」的大小轉化、「鵷鶵與鴟」的不同價值觀、「蝸角之爭」的相對主義、「朝菌與大椿」的時間相對性，以及「言得意忘」的語言超越。
              </p>
              <p class="text-gray-700 dark:text-gray-300 mb-4">
                你已經領悟到莊子思想的核心：超越二元對立、達到心靈自由的境界。這種智慧不僅是哲學概念，更是一種生活態度——面對變化，保持開放；面對對立，尋求融合；面對局限，追求超越。
              </p>
              <p class="text-gray-700 dark:text-gray-300">
                現在，你可以選擇重新探索任何章節，或者以新的視角重新開始整個旅程。
              </p>
            </div>
            
            <div class="text-center space-y-4">
              <h3 class="font-medium text-primary">最終成就</h3>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-indigo-50 dark:bg-indigo-900 p-3 rounded-lg">
                  <div class="text-3xl mb-2">🦋</div>
                  <p class="font-medium text-indigo-700 dark:text-indigo-200">物化之道</p>
                  <p class="text-sm text-indigo-600 dark:text-indigo-300">體驗萬物相互轉化的流動狀態</p>
                </div>
                <div class="bg-indigo-50 dark:bg-indigo-900 p-3 rounded-lg">
                  <div class="text-3xl mb-2">🔮</div>
                  <p class="font-medium text-indigo-700 dark:text-indigo-200">渾沌復生</p>
                  <p class="text-sm text-indigo-600 dark:text-indigo-300">幫助渾沌恢復未分化的原初狀態</p>
                </div>
                <div class="bg-indigo-50 dark:bg-indigo-900 p-3 rounded-lg">
                  <div class="text-3xl mb-2">🌌</div>
                  <p class="font-medium text-indigo-700 dark:text-indigo-200">逍遙遊</p>
                  <p class="text-sm text-indigo-600 dark:text-indigo-300">超越一切對立和束縛，達到心靈自由</p>
                </div>
              </div>
              <button id="restart-game" class="mt-6 bg-primary hover:bg-opacity-90 text-white px-6 py-2 rounded-lg font-medium transition">重新開始</button>
            </div>
          </div>
        </div>
      </main>
      
      <footer class="text-center text-sm text-gray-500 dark:text-gray-400 py-4">
        <p>© 2024 萬物逍遙 - 莊子宇宙物化遊戲</p>
      </footer>
    </div>
  
    <script>
      // 深色模式檢測
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.classList.add('dark');
      }
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
        if (event.matches) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      });
      
      // 全局遊戲狀態
      const gameState = {
        currentScene: 'scene-intro',
        unlockedChapters: ['intro'],
        collectedSeals: [],
        unlockedForms: ['human', 'butterfly'],
        currentForm: 'human'
      };
      
      // 斷句練習數據
      const sentenceData = {
        intro: {
          text: "昔者莊周夢為胡蝶栩栩然胡蝶也自喻適志與不知周也俄然覺則蘧蘧然周也",
          correctSegments: [7, 13, 18, 22, 25],
          segmentCount: 5
        },
        ch1: {
          text: "莊子與惠子遊於濠梁之上莊子曰儵魚出遊從容是魚樂也惠子曰子非魚安知魚之樂莊子曰子非我安知我不知魚之樂",
          correctSegments: [10, 13, 19, 23, 26, 29, 34, 37, 40],
          segmentCount: 9
        },
        ch2: {
          text: "北冥有魚其名為鯤鯤之大不知其幾千里也化而為鳥其名為鵬鵬之背不知其幾千里也怒而飛其翼若垂天之雲",
          correctSegments: [3, 7, 10, 17, 21, 25, 28, 35, 38],
          segmentCount: 9
        },
        ch3: {
          text: "惠子相梁莊子往見之或謂惠子曰莊子來欲代子相於是惠子恐搜於國中三日三夜莊子往見之曰南方有鳥其名為鵷鶵子知之乎",
          correctSegments: [3, 8, 13, 16, 20, 25, 33, 38, 39, 43, 48],
          segmentCount: 11
        },
        ch4: {
          text: "有所謂蝸者君知之乎有國於蝸之左角者曰觸氏有國於蝸之右角者曰蠻氏時相與爭地而戰伏尸數萬逐北旬有五日而後反",
          correctSegments: [4, 8, 19, 30, 37, 41],
          segmentCount: 6
        },
        ch5: {
          text: "朝菌不知晦朔蟪蛄不知春秋此小年也楚之南有冥靈者以五百歲為春五百歲為秋上古有大椿者以八千歲為春八千歲為秋",
          correctSegments: [5, 11, 15, 22, 28, 33, 39, 45],
          segmentCount: 8
        },
        epilogue: {
          text: "南海之帝為儵北海之帝為忽中央之帝為渾沌儵與忽時相與遇於渾沌之地渾沌待之甚善儵與忽謀報渾沌之德曰人皆有七竅以視聽食息此獨無有嘗試鑿之日鑿一竅七日而渾沌死",
          correctSegments: [5, 11, 18, 30, 36, 45, 46, 51, 56, 60, 64, 68],
          segmentCount: 12
        },
        ch6: {
          text: "彼亦一是非此亦一是非果且有彼是乎哉果且無彼是乎哉彼是莫得其偶謂之道樞樞始得其環中以應無窮",
          correctSegments: [4, 9, 16, 23, 29, 33, 39],
          segmentCount: 7
        }
      };
      
      // 物化形態描述數據
      const formDescriptions = {
        human: "人形: 你的原始形態。雖然沒有特殊能力，但可以與其他人交流，使用工具，理解人類社會。",
        butterfly: "胡蝶: 能飛行且靈活，可進入狹小空間。對花粉和氣流有特殊感知，但身體脆弱，不適合高空飛行。",
        fish: "儵魚: 可在水中自由游動，感知水流的微妙變化和情緒。能理解水生動物的語言，但離開水會很不適。",
        kunpeng: "鯤鵬: 兼具鯤魚和鵬鳥的特性，能在水中游弋，也能在天空翱翔。能體驗極小與極大的視角轉換。"
      };
      
      // 對話回應數據
      const responseContent = {
        original: `
          <div class="flex items-start mb-3">
            <div class="text-4xl mr-3">🧍</div>
            <div>
              <p class="font-medium text-gray-800 dark:text-gray-200">你：</p>
              <p class="text-gray-700 dark:text-gray-300">子非我，安知我不知魚之樂？</p>
              <p class="text-gray-500 dark:text-gray-400 text-sm italic mt-1">（你不是我，怎麼知道我不知道魚的快樂？）</p>
            </div>
          </div>
          
          <div class="flex items-start">
            <div class="text-4xl mr-3">🧔</div>
            <div>
              <p class="font-medium text-gray-800 dark:text-gray-200">惠子：</p>
              <p class="text-gray-700 dark:text-gray-300">我非子，固不知子矣；子固非魚也，子之不知魚之樂，全矣！</p>
              <p class="text-gray-500 dark:text-gray-400 text-sm italic mt-1">（我不是你，當然不知道你的想法；但你也不是魚，所以你不知道魚是否快樂，這是確定的！）</p>
            </div>
          </div>
          
          <div class="mt-4 p-3 bg-gray-200 dark:bg-gray-600 rounded-lg">
            <p class="text-sm text-gray-700 dark:text-gray-300">
              <span class="font-medium">解析：</span>
              這是莊子與惠子的經典對話。惠子認為，因為莊子不是魚，所以不可能知道魚的感受。莊子反駁說，既然惠子不是莊子，又怎麼知道莊子不知道魚的感受呢？這種反問揭示了認知的相對性，也是對絕對主義的挑戰。
            </p>
          </div>
        `,
        modern: `
          <div class="flex items-start mb-3">
            <div class="text-4xl mr-3">🧍</div>
            <div>
              <p class="font-medium text-gray-800 dark:text-gray-200">你：</p>
              <p class="text-gray-700 dark:text-gray-300">我觀察到魚的行為表現出快樂的跡象，從而做出合理推測。就像我們能從一個人的微笑推測他很開心一樣。</p>
            </div>
          </div>
          
          <div class="flex items-start">
            <div class="text-4xl mr-3">🧔</div>
            <div>
              <p class="font-medium text-gray-800 dark:text-gray-200">惠子：</p>
              <p class="text-gray-700 dark:text-gray-300">有趣的解釋。但外在表現與內在感受是否一致？魚的行為可能有其他解釋，也許它們只是在尋找食物，或者避開危險。</p>
            </div>
          </div>
          
          <div class="mt-4 p-3 bg-gray-200 dark:bg-gray-600 rounded-lg">
            <p class="text-sm text-gray-700 dark:text-gray-300">
              <span class="font-medium">解析：</span>
              現代科學角度的解釋，關注行為與感受之間的推斷。這種角度重視觀察和理性推理，但惠子的反駁也有道理——行為和感受之間的關係是複雜的，特別是跨物種的判斷。這依然揭示了認知的局限性。
            </p>
          </div>
        `,
        transform: `
          <div class="flex items-start mb-3">
            <div class="text-4xl mr-3">🧍</div>
            <div>
              <p class="font-medium text-gray-800 dark:text-gray-200">你：</p>
              <p class="text-gray-700 dark:text-gray-300">讓我變成魚，親自體驗看看。只有通過親身體驗，才能真正知道魚的感受。</p>
            </div>
          </div>
          
          <div class="flex items-start">
            <div class="text-4xl mr-3">🧔</div>
            <div>
              <p class="font-medium text-gray-800 dark:text-gray-200">惠子：</p>
              <p class="text-gray-700 dark:text-gray-300 mb-2">變成魚？這怎麼可能？你在說笑吧。</p>
              <p class="text-gray-700 dark:text-gray-300">不過，如果真有可能，那確實是理解魚之樂的最佳方式。但即使如此，變成魚的你還是你嗎？</p>
            </div>
          </div>
          
          <div class="mt-4 p-3 bg-gray-200 dark:bg-gray-600 rounded-lg">
            <p class="text-sm text-gray-700 dark:text-gray-300">
              <span class="font-medium">解析：</span>
              這回應體現了莊子「物化」思想的核心——通過超越形體的限制，直接體驗不同存在的感受。惠子的疑問也呼應了莊周夢蝶故事中的身份認同問題：當你變成魚時，你還是原來的你嗎？這涉及自我認同的哲學思考。
            </p>
          </div>
        `
      };
      
      // DOM 元素和事件監聽器
      document.addEventListener('DOMContentLoaded', function() {
        // 初始化遊戲
        initGame();
        
        // 事件監聽器設置
        setupEventListeners();
      });
      
      // 初始化遊戲
      function initGame() {
        // 顯示初始場景
        showScene(gameState.currentScene);
        
        // 更新七竅顯示
        updateSeals();
        
        // 初始化章節按鈕狀態
        updateChapterButtons();
        
        // 初始化移动端章节选择器
        setupMobileChapterSelector();
        updateMobileChapterSelector();
        
        // 為斷句練習生成互動句子
        setupInteractiveSentence('intro');
        
        // 隐藏初始加载
        hideLoading();
      }
      
      // 設置事件監聽器
      function setupEventListeners() {
        // 起始旅程按鈕
        document.getElementById('start-journey').addEventListener('click', function() {
          const button = this;
          setButtonLoading(button, true);
          setTimeout(() => {
            showScene('scene-transformation');
            setButtonLoading(button, false);
          }, 500);
        });
        
        // 形態選擇器
        document.querySelectorAll('.form-selector').forEach(selector => {
          selector.addEventListener('click', function() {
            document.querySelectorAll('.form-selector').forEach(s => s.classList.remove('active'));
            this.classList.add('active');
            const form = this.getAttribute('data-form');
            document.getElementById('form-description').innerHTML = formDescriptions[form];
            gameState.currentForm = form;
          });
        });
        
        // 確認變化按鈕
        document.getElementById('confirm-transformation').addEventListener('click', function() {
          showScene('scene-sentence');
        });
        
        // 斷句練習按鈕
        document.getElementById('check-sentence').addEventListener('click', function() {
          checkSentence('intro');
        });
        
        document.getElementById('show-hint').addEventListener('click', function() {
          toggleElement('sentence-hint');
        });
        
        // 顯示正確答案按鈕 - 序章
        document.getElementById('show-correct-answer').addEventListener('click', function() {
          showCorrectAnswer('intro');
        });
        
        // 第一章顯示正確答案按鈕
        document.getElementById('show-correct-answer-ch1').addEventListener('click', function() {
          showCorrectAnswer('ch1');
        });
        
        // 第二章顯示正確答案按鈕
        document.getElementById('show-correct-answer-ch2').addEventListener('click', function() {
          showCorrectAnswer('ch2');
        });
        
        // 第三章顯示正確答案按鈕
        document.getElementById('show-correct-answer-ch3').addEventListener('click', function() {
          showCorrectAnswer('ch3');
        });
        
        // 第四章顯示正確答案按鈕
        document.getElementById('show-correct-answer-ch4').addEventListener('click', function() {
          showCorrectAnswer('ch4');
        });
        
        // 第五章顯示正確答案按鈕
        document.getElementById('show-correct-answer-ch5').addEventListener('click', function() {
          showCorrectAnswer('ch5');
        });
        
        // 第六章顯示正確答案按鈕
        document.getElementById('show-correct-answer-ch6').addEventListener('click', function() {
          showCorrectAnswer('ch6');
        });
        
        // 終章顯示正確答案按鈕
        document.getElementById('show-correct-answer-epilogue').addEventListener('click', function() {
          showCorrectAnswer('epilogue');
        });
        
        // 探索/繼續探索按鈕
        document.getElementById('explore-continue').addEventListener('click', function() {
          showScene('scene-seal-found');
        });
        
        document.getElementById('explore-back').addEventListener('click', function() {
          showScene('scene-transformation');
        });
        
        // 收集封印按鈕
        document.getElementById('collect-seal').addEventListener('click', function() {
          collectSeal('left-eye');
          showScene('scene-new-form');
        });
        
        // 嘗試新形態按鈕
        document.getElementById('try-new-form').addEventListener('click', function() {
          gameState.unlockedForms.push('fish');
          showScene('scene-chapter-complete');
        });
        
        // 下一章按鈕
        document.getElementById('next-chapter').addEventListener('click', function() {
          unlockChapter('ch1');
          showScene('scene-ch1-intro');
        });
        
        // 第一章開始按鈕
        document.getElementById('ch1-start').addEventListener('click', function() {
          showScene('scene-sentence-ch1');
          setupInteractiveSentence('ch1');
        });
        
        // 第一章斷句練習按鈕
        document.getElementById('check-sentence-ch1').addEventListener('click', function() {
          checkSentence('ch1');
        });
        
        document.getElementById('show-hint-ch1').addEventListener('click', function() {
          toggleElement('sentence-hint-ch1');
        });
        
        // 橋上場景
        document.getElementById('check-sentence-ch1').addEventListener('click', function() {
          const result = document.getElementById('sentence-result-ch1');
          if (result.classList.contains('bg-green-100')) {
            // 如果斷句正確，顯示"繼續"按鈕
            const continueBtn = document.createElement('button');
            continueBtn.className = 'bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition mt-4';
            continueBtn.textContent = '前往濠梁';
            continueBtn.addEventListener('click', function() {
              showScene('scene-bridge');
            });
            result.appendChild(continueBtn);
          }
        });
        
        // 對話選項
        document.querySelectorAll('.dialogue-option').forEach(option => {
          option.addEventListener('click', function() {
            const response = this.getAttribute('data-response');
            document.getElementById('response-content').innerHTML = responseContent[response];
            showScene('scene-dialogue-response');
          });
        });
        
        // 返回橋上和嘗試變形按鈕
        document.getElementById('back-to-bridge').addEventListener('click', function() {
          showScene('scene-bridge');
        });
        
        document.getElementById('try-transformation').addEventListener('click', function() {
          showScene('scene-fish-view');
        });
        
        // 探索水底按鈕
        document.getElementById('explore-underwater').addEventListener('click', function() {
          showScene('scene-underwater');
        });
        
        // 與河伯交談和收集左目封印按鈕
        document.getElementById('talk-river-god').addEventListener('click', function() {
          showScene('scene-river-god-talk');
        });
        
        document.getElementById('collect-eye-seal').addEventListener('click', function() {
          collectSeal('left-eye');
          showScene('scene-ch1-complete');
        });
        
        // 返回水底按鈕
        document.getElementById('back-to-underwater').addEventListener('click', function() {
          showScene('scene-underwater');
        });
        
        // 前往第二章按鈕
        document.getElementById('to-chapter-two').addEventListener('click', function() {
          unlockChapter('ch2');
          showScene('scene-ch2-intro');
        });
        
        // 第二章開始按鈕
        document.getElementById('ch2-start').addEventListener('click', function() {
          showScene('scene-sentence-ch2');
          setupInteractiveSentence('ch2');
        });
        
        // 第二章斷句練習按鈕
        document.getElementById('check-sentence-ch2').addEventListener('click', function() {
          checkSentence('ch2');
        });
        
        document.getElementById('show-hint-ch2').addEventListener('click', function() {
          toggleElement('sentence-hint-ch2');
        });
        
        // 確保第二章斷句正確後能繼續
        document.getElementById('check-sentence-ch2').addEventListener('click', function() {
          const result = document.getElementById('sentence-result-ch2');
          if (result.classList.contains('bg-green-100')) {
            // 如果斷句正確，顯示"繼續"按鈕
            const continueBtn = document.createElement('button');
            continueBtn.className = 'bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition mt-4';
            continueBtn.textContent = '前往北冥';
            continueBtn.addEventListener('click', function() {
              showScene('scene-north-sea');
            });
            result.appendChild(continueBtn);
          }
        });
        
        // 北冥探索按鈕
        document.getElementById('ask-fisherman').addEventListener('click', function() {
          showScene('scene-fisherman');
        });
        
        document.getElementById('transform-fish').addEventListener('click', function() {
          showScene('scene-sea-fish');
        });
        
        document.getElementById('meditate-sea').addEventListener('click', function() {
          showScene('scene-meditation');
        });
        
        // 漁民場景按鈕
        document.getElementById('back-to-sea').addEventListener('click', function() {
          showScene('scene-north-sea');
        });
        
        document.getElementById('go-to-reef').addEventListener('click', function() {
          showScene('scene-reef');
        });
        
        // 魚形態場景按鈕
        document.getElementById('follow-fish').addEventListener('click', function() {
          showScene('scene-north-sea');
        });
        
        document.getElementById('approach-kun').addEventListener('click', function() {
          showScene('scene-contact-kun');
        });
        
        // 冥想場景按鈕
        document.getElementById('back-to-sea-2').addEventListener('click', function() {
          showScene('scene-north-sea');
        });
        
        document.getElementById('go-to-reef-2').addEventListener('click', function() {
          showScene('scene-reef');
        });
        
        // 礁石群場景按鈕
        document.getElementById('observe-kun').addEventListener('click', function() {
          showScene('scene-observe-kun');
        });
        
        document.getElementById('attempt-contact').addEventListener('click', function() {
          showScene('scene-contact-kun');
        });
        
        // 觀察鯤魚場景按鈕
        document.getElementById('wait-transformation').addEventListener('click', function() {
          showScene('scene-kun-changing');
        });
        
        // 接觸鯤魚場景按鈕
        document.getElementById('agree-follow').addEventListener('click', function() {
          showScene('scene-kun-changing');
        });
        
        // 等待變化場景按鈕
        document.getElementById('transform-butterfly').addEventListener('click', function() {
          showScene('scene-transform-fail');
        });
        
        document.getElementById('call-kun').addEventListener('click', function() {
          showScene('scene-call-peng');
        });
        
        // 變形失敗場景按鈕
        document.getElementById('return-to-reef').addEventListener('click', function() {
          showScene('scene-kun-changing');
        });
        
        // 呼喚鵬鳥場景按鈕
        document.getElementById('try-kunpeng-form').addEventListener('click', function() {
          showScene('scene-kunpeng-challenge');
        });
        
        // 鯤鵬形態挑戰場景按鈕
        document.querySelectorAll('.debate-option').forEach(option => {
          option.addEventListener('click', function() {
            const answer = this.getAttribute('data-answer');
            if (answer === 'correct') {
              showScene('scene-high-sky');
            } else {
              // 顯示提示並讓用戶重試
              alert('思考一下鵬鳥的飛行原理。莊子提到牠是藉助什麼來上升的？');
            }
          });
        });
        
        // 九萬里高空場景按鈕
        document.getElementById('understand-vision').addEventListener('click', function() {
          showScene('scene-right-eye-seal');
        });
        
        // 獲得右目封印場景按鈕
        document.getElementById('collect-right-eye').addEventListener('click', function() {
          collectSeal('right-eye');
          showScene('scene-unlock-kunpeng');
        });
        
        // 解鎖鯤鵬形態場景按鈕
        document.getElementById('return-with-kunpeng').addEventListener('click', function() {
          gameState.unlockedForms.push('kunpeng');
          showScene('scene-ch2-complete');
        });
        
        // 前往第三章按鈕
        document.getElementById('to-chapter-three').addEventListener('click', function() {
          unlockChapter('ch3');
          showScene('scene-ch3-intro');
        });
        
        // 第三章開始按鈕
        document.getElementById('ch3-start').addEventListener('click', function() {
          showScene('scene-sentence-ch3');
          setupInteractiveSentence('ch3');
        });
        
        // 第三章斷句練習按鈕
        document.getElementById('check-sentence-ch3').addEventListener('click', function() {
          checkSentence('ch3');
        });
        
        document.getElementById('show-hint-ch3').addEventListener('click', function() {
          toggleElement('sentence-hint-ch3');
        });
        
        // 確保第三章斷句正確後能繼續
        document.getElementById('check-sentence-ch3').addEventListener('click', function() {
          const result = document.getElementById('sentence-result-ch3');
          if (result.classList.contains('bg-green-100')) {
            const continueBtn = document.createElement('button');
            continueBtn.className = 'bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition mt-4';
            continueBtn.textContent = '前往梁國';
            continueBtn.addEventListener('click', function() {
              showScene('scene-liang-gate');
            });
            result.appendChild(continueBtn);
          }
        });
        
        // 梁國城門場景按鈕
        document.getElementById('transform-human').addEventListener('click', function() {
          showScene('scene-human-city');
        });
        
        document.getElementById('transform-peng').addEventListener('click', function() {
          showScene('scene-peng-view');
        });
        
        // 人形入城場景按鈕
        document.getElementById('go-to-palace').addEventListener('click', function() {
          showScene('scene-palace');
        });
        
        document.getElementById('go-to-forest').addEventListener('click', function() {
          showScene('scene-wutong');
        });
        
        // 鯤鵬俯瞰場景按鈕
        document.getElementById('land-palace').addEventListener('click', function() {
          showScene('scene-palace');
        });
        
        document.getElementById('land-forest').addEventListener('click', function() {
          showScene('scene-wutong');
        });
        
        // 宮殿區場景按鈕
        document.getElementById('leave-to-forest').addEventListener('click', function() {
          showScene('scene-wutong');
        });
        
        // 梧桐樹場景按鈕
        document.getElementById('observe-yuanchu').addEventListener('click', function() {
          showScene('scene-observe-bird');
        });
        
        document.getElementById('transform-yuanchu').addEventListener('click', function() {
          showScene('scene-become-yuanchu');
        });
        
        // 觀察鵷鶵場景按鈕
        document.getElementById('listen-carefully').addEventListener('click', function() {
          showScene('scene-listening');
        });
        
        // 化為鵷鶵場景按鈕
        document.getElementById('converse-chi').addEventListener('click', function() {
          showScene('scene-talk-chi');
        });
        
        // 聆聽場景按鈕
        document.getElementById('collect-ear-seal').addEventListener('click', function() {
          collectSeal('left-ear');
          showScene('scene-ear-seal');
        });
        
        // 與鴟對話場景按鈕
        document.getElementById('collect-ear-seal-2').addEventListener('click', function() {
          collectSeal('left-ear');
          showScene('scene-ear-seal');
        });
        
        // 獲得左耳封印場景按鈕
        document.getElementById('complete-ch3').addEventListener('click', function() {
          showScene('scene-zhuang-hui-meet');
        });
        
        // 莊子與惠子相見場景按鈕
        document.getElementById('ch3-summary').addEventListener('click', function() {
          showScene('scene-ch3-complete');
        });
        
        // 前往第四章按鈕
        document.getElementById('to-chapter-four').addEventListener('click', function() {
          unlockChapter('ch4');
          showScene('scene-ch4-intro');
        });
        
        // 第四章開始按鈕
        document.getElementById('ch4-start').addEventListener('click', function() {
          showScene('scene-sentence-ch4');
          setupInteractiveSentence('ch4');
        });
        
        // 第四章斷句練習按鈕
        document.getElementById('check-sentence-ch4').addEventListener('click', function() {
          checkSentence('ch4');
        });
        
        document.getElementById('show-hint-ch4').addEventListener('click', function() {
          toggleElement('sentence-hint-ch4');
        });
        
        // 確保第四章斷句正確後能繼續
        document.getElementById('check-sentence-ch4').addEventListener('click', function() {
          const result = document.getElementById('sentence-result-ch4');
          if (result.classList.contains('bg-green-100')) {
            const continueBtn = document.createElement('button');
            continueBtn.className = 'bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition mt-4';
            continueBtn.textContent = '與戴晉人對話';
            continueBtn.addEventListener('click', function() {
              showScene('scene-dai-talk');
            });
            result.appendChild(continueBtn);
          }
        });
        
        // 戴晉人對話場景按鈕
        document.getElementById('question-story').addEventListener('click', function() {
          showScene('scene-question');
        });
        
        document.getElementById('explore-snail').addEventListener('click', function() {
          showScene('scene-snail-world');
          setupScaleSlider();
        });
        
        // 質疑故事場景按鈕
        document.getElementById('continue-exploration').addEventListener('click', function() {
          showScene('scene-snail-world');
          setupScaleSlider();
        });
        
        // 蝸牛世界場景按鈕
        document.getElementById('reflect-relativity').addEventListener('click', function() {
          showScene('scene-relativity');
        });
        
        // 相對性思考場景按鈕
        document.getElementById('answer-no-difference').addEventListener('click', function() {
          showScene('scene-no-difference');
        });
        
        document.getElementById('answer-has-difference').addEventListener('click', function() {
          showScene('scene-perspective');
          setupPerspectiveSlider();
        });
        
        // 無辯回答場景按鈕
        document.getElementById('find-right-ear').addEventListener('click', function() {
          showScene('scene-contemplation');
        });
        
        // 視角轉換場景按鈕
        document.getElementById('perceive-seal').addEventListener('click', function() {
          showScene('scene-contemplation');
        });
        
        // 惝然若亡場景按鈕
        document.getElementById('receive-seal').addEventListener('click', function() {
          collectSeal('right-ear');
          showScene('scene-right-ear-seal');
        });
        
        // 獲得右耳封印場景按鈕
        document.getElementById('complete-ch4').addEventListener('click', function() {
          showScene('scene-ch4-complete');
        });
        
        // 前往第五章按鈕
        document.getElementById('to-chapter-five').addEventListener('click', function() {
          unlockChapter('ch5');
          showScene('scene-ch5-intro');
        });
        
        // 第五章開始按鈕
        document.getElementById('ch5-start').addEventListener('click', function() {
          showScene('scene-sentence-ch5');
          setupInteractiveSentence('ch5');
        });
        
        // 第五章斷句練習按鈕
        document.getElementById('check-sentence-ch5').addEventListener('click', function() {
          checkSentence('ch5');
        });
        
        document.getElementById('show-hint-ch5').addEventListener('click', function() {
          toggleElement('sentence-hint-ch5');
        });
        
        // 確保第五章斷句正確後能繼續
        document.getElementById('check-sentence-ch5').addEventListener('click', function() {
          const result = document.getElementById('sentence-result-ch5');
          if (result.classList.contains('bg-green-100')) {
            const continueBtn = document.createElement('button');
            continueBtn.className = 'bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition mt-4';
            continueBtn.textContent = '前往時間森林';
            continueBtn.addEventListener('click', function() {
              showScene('scene-time-forest');
            });
            result.appendChild(continueBtn);
          }
        });
        
        // 時間森林場景按鈕
        document.getElementById('experience-mushroom').addEventListener('click', function() {
          showScene('scene-mushroom');
        });
        
        document.getElementById('experience-cicada').addEventListener('click', function() {
          showScene('scene-cicada');
        });
        
        document.getElementById('experience-tree').addEventListener('click', function() {
          showScene('scene-big-tree');
        });
        
        // 朝菌體驗場景按鈕
        document.getElementById('return-time-forest-1').addEventListener('click', function() {
          showScene('scene-time-forest');
        });
        
        // 蟪蛄體驗場景按鈕
        document.getElementById('return-time-forest-2').addEventListener('click', function() {
          showScene('scene-time-forest');
        });
        
        // 大椿體驗場景按鈕
        document.getElementById('return-time-forest-3').addEventListener('click', function() {
          showScene('scene-time-fusion');
        });
        
        // 時間融合場景按鈕
        document.getElementById('collect-left-nose').addEventListener('click', function() {
          collectSeal('left-nose');
          showScene('scene-left-nose-seal');
        });
        
        // 獲得左鼻封印場景按鈕
        document.getElementById('complete-ch5').addEventListener('click', function() {
          showScene('scene-ch5-complete');
        });
        
        // 前往第六章按鈕
        document.getElementById('to-chapter-six').addEventListener('click', function() {
          unlockChapter('ch6');
          showScene('scene-ch6-intro');
        });
        
        // 第六章開始按鈕
        document.getElementById('ch6-start').addEventListener('click', function() {
          showScene('scene-sentence-ch6');
          setupInteractiveSentence('ch6');
        });
        
        // 第六章斷句練習按鈕
        document.getElementById('check-sentence-ch6').addEventListener('click', function() {
          checkSentence('ch6');
        });
        
        document.getElementById('show-hint-ch6').addEventListener('click', function() {
          toggleElement('sentence-hint-ch6');
        });
        
        // 確保第六章斷句正確後能繼續
        document.getElementById('check-sentence-ch6').addEventListener('click', function() {
          const result = document.getElementById('sentence-result-ch6');
          if (result.classList.contains('bg-green-100')) {
            const continueBtn = document.createElement('button');
            continueBtn.className = 'bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition mt-4';
            continueBtn.textContent = '進入辯論';
            continueBtn.addEventListener('click', function() {
              showScene('scene-debate');
            });
            result.appendChild(continueBtn);
          }
        });
        
        // 辯論場景按鈕
        document.getElementById('support-a').addEventListener('click', function() {
          showScene('scene-support-a');
        });
        
        document.getElementById('support-b').addEventListener('click', function() {
          showScene('scene-support-b');
        });
        
        document.getElementById('transcend-debate').addEventListener('click', function() {
          showScene('scene-beyond-debate');
        });
        
        // 支持甲方場景按鈕
        document.getElementById('reconsider-position').addEventListener('click', function() {
          showScene('scene-reflection');
        });
        
        // 支持乙方場景按鈕
        document.getElementById('reconsider-position-2').addEventListener('click', function() {
          showScene('scene-reflection');
        });
        
        // 超越爭論場景按鈕
        document.getElementById('collect-right-nose').addEventListener('click', function() {
          collectSeal('right-nose');
          showScene('scene-right-nose-seal');
        });
        
        // 思考反思場景按鈕
        document.getElementById('collect-right-nose-2').addEventListener('click', function() {
          collectSeal('right-nose');
          showScene('scene-right-nose-seal');
        });
        
        // 獲得右鼻封印場景按鈕
        document.getElementById('complete-ch6').addEventListener('click', function() {
          showScene('scene-ch6-complete');
        });
        
        // 前往終章按鈕
        document.getElementById('to-epilogue').addEventListener('click', function() {
          unlockChapter('epilogue');
          showScene('scene-epilogue-intro');
        });
        
        // 終章開始按鈕
        document.getElementById('epilogue-start').addEventListener('click', function() {
          showScene('scene-sentence-epilogue');
          setupInteractiveSentence('epilogue');
        });
        
        // 終章斷句練習按鈕
        document.getElementById('check-sentence-epilogue').addEventListener('click', function() {
          checkSentence('epilogue');
        });
        
        document.getElementById('show-hint-epilogue').addEventListener('click', function() {
          toggleElement('sentence-hint-epilogue');
        });
        
        // 確保終章斷句正確後能繼續
        document.getElementById('check-sentence-epilogue').addEventListener('click', function() {
          const result = document.getElementById('sentence-result-epilogue');
          if (result.classList.contains('bg-green-100')) {
            const continueBtn = document.createElement('button');
            continueBtn.className = 'bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition mt-4';
            continueBtn.textContent = '探索言意之境';
            continueBtn.addEventListener('click', function() {
              showScene('scene-language-meaning');
            });
            result.appendChild(continueBtn);
          }
        });
        
        // 言意之境場景按鈕
        document.getElementById('explore-language').addEventListener('click', function() {
          showScene('scene-explore-language');
        });
        
        document.getElementById('experience-silence').addEventListener('click', function() {
          showScene('scene-experience-silence');
        });
        
        // 探索言語場景按鈕
        document.getElementById('return-to-silence').addEventListener('click', function() {
          showScene('scene-experience-silence');
        });
        
        // 體驗沉默場景按鈕
        document.getElementById('find-balance').addEventListener('click', function() {
          showScene('scene-balance');
        });
        
        // 言默平衡場景按鈕
        document.getElementById('collect-mouth-seal').addEventListener('click', function() {
          collectSeal('mouth');
          showScene('scene-mouth-seal');
        });
        
        // 獲得口竅封印場景按鈕
        document.getElementById('restore-hundun').addEventListener('click', function() {
          showScene('scene-seven-seals');
        });
        
        // 七竅齊全場景按鈕
        document.getElementById('final-transformation').addEventListener('click', function() {
          showScene('scene-hundun-rebirth');
        });
        
        // 渾沌復生場景按鈕
        document.getElementById('epilogue-complete').addEventListener('click', function() {
          showScene('scene-game-end');
        });
        
        // 重新開始按鈕
        document.getElementById('restart-game').addEventListener('click', function() {
          resetGame();
        });
        
        // 章節選擇按鈕
        document.querySelectorAll('.chapter-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const chapter = this.getAttribute('data-chapter');
            if (!this.hasAttribute('disabled')) {
              switch(chapter) {
                case 'intro':
                  showScene('scene-intro');
                  break;
                case 'ch1':
                  showScene('scene-ch1-intro');
                  break;
                case 'ch2':
                  showScene('scene-ch2-intro');
                  break;
                case 'ch3':
                  showScene('scene-ch3-intro');
                  break;
                case 'ch4':
                  showScene('scene-ch4-intro');
                  break;
                case 'ch5':
                  showScene('scene-ch5-intro');
                  break;
                case 'epilogue':
                  showScene('scene-epilogue-intro');
                  break;
              }
            }
          });
        });
      }
      
      // 顯示特定場景
      function showScene(sceneId) {
        // 隱藏所有場景
        document.querySelectorAll('.scene').forEach(scene => {
          scene.classList.add('hidden');
        });
        
        // 顯示目標場景
        const targetScene = document.getElementById(sceneId);
        targetScene.classList.remove('hidden');
        
        // 更新當前場景狀態
        gameState.currentScene = sceneId;
        
        // 特殊場景處理
        if (sceneId === 'scene-kun-changing') {
          // 鯤鵬變形動畫
          setTimeout(() => {
            const kunPengAnimation = document.getElementById('kun-peng-animation');
            kunPengAnimation.textContent = '🦅';
          }, 3000);
        }
      }
      
      // 切換元素顯示/隱藏
      function toggleElement(elementId) {
        const element = document.getElementById(elementId);
        if (element.classList.contains('hidden')) {
          element.classList.remove('hidden');
        } else {
          element.classList.add('hidden');
        }
      }
      
      // 更新七竅顯示
      function updateSeals() {
        const holes = document.querySelectorAll('.hole');
        holes.forEach(hole => {
          const holeId = hole.getAttribute('data-hole');
          if (gameState.collectedSeals.includes(getSealNameByIndex(holeId))) {
            hole.classList.add('filled');
          } else {
            hole.classList.remove('filled');
          }
        });
      }
      
      // 根據索引獲取封印名稱
      function getSealNameByIndex(index) {
        const sealNames = [
          'left-eye',   // 1
          'right-eye',  // 2
          'left-ear',   // 3
          'right-ear',  // 4
          'left-nose',  // 5
          'right-nose', // 6
          'mouth'       // 7
        ];
        return sealNames[parseInt(index) - 1];
      }
      
      // 收集封印
      function collectSeal(sealName) {
        if (!gameState.collectedSeals.includes(sealName)) {
          gameState.collectedSeals.push(sealName);
          updateSeals();
        }
      }
      
      // 解鎖章節
      function unlockChapter(chapter) {
        if (!gameState.unlockedChapters.includes(chapter)) {
          gameState.unlockedChapters.push(chapter);
          updateChapterButtons();
        }
      }
      
      // 更新章節按鈕狀態
      function updateChapterButtons() {
        document.querySelectorAll('.chapter-btn').forEach(btn => {
          const chapter = btn.getAttribute('data-chapter');
          if (gameState.unlockedChapters.includes(chapter)) {
            btn.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            btn.classList.add('bg-primary', 'text-white');
            btn.removeAttribute('disabled');
          } else {
            btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
            btn.classList.remove('bg-primary', 'text-white');
            btn.setAttribute('disabled', '');
          }
        });
        
        // 同时更新移动端选择器
        updateMobileChapterSelector();
      }
      
      // 設置互動式斷句練習
      function setupInteractiveSentence(chapter) {
        const container = document.getElementById(`interactive-sentence${chapter === 'intro' ? '' : '-' + chapter}`);
        const text = sentenceData[chapter].text;
        container.innerHTML = '';
        
        // 創建字符
        for (let i = 0; i < text.length; i++) {
          const charSpan = document.createElement('span');
          charSpan.className = 'char';
          charSpan.textContent = text[i];
          container.appendChild(charSpan);
          
          // 在字符之間添加可點擊的空間（除了最後一個字符之後）
          if (i < text.length - 1) {
            const punctSpace = document.createElement('span');
            punctSpace.className = 'punct-space';
            punctSpace.setAttribute('data-index', i);
            
            // 點擊事件
            punctSpace.addEventListener('click', function() {
              this.classList.toggle('marked');
              updateSegmentCount(chapter);
            });
            
            container.appendChild(punctSpace);
          }
        }
        
        // 重置段數計數
        updateSegmentCount(chapter);
      }
      
      // 更新斷句計數
      function updateSegmentCount(chapter) {
        const counter = document.getElementById(`segment-count${chapter === 'intro' ? '' : '-' + chapter}`);
        const segments = document.querySelectorAll(`#interactive-sentence${chapter === 'intro' ? '' : '-' + chapter} .punct-space.marked`);
        counter.textContent = segments.length;
      }
      
      // 檢查斷句
      function checkSentence(chapter) {
        const segments = document.querySelectorAll(`#interactive-sentence${chapter === 'intro' ? '' : '-' + chapter} .punct-space.marked`);
        const segmentIndices = Array.from(segments).map(s => parseInt(s.getAttribute('data-index')));
        const correctSegments = sentenceData[chapter].correctSegments;
        
        // 檢查是否正確
        let allCorrect = true;
        segments.forEach(segment => {
          const index = parseInt(segment.getAttribute('data-index'));
          if (correctSegments.includes(index)) {
            segment.classList.add('correct');
            segment.classList.remove('incorrect');
          } else {
            segment.classList.add('incorrect');
            segment.classList.remove('correct');
            allCorrect = false;
          }
        });
        
        // 檢查是否漏掉了正確的斷句點
        for (const index of correctSegments) {
          if (!segmentIndices.includes(index)) {
            allCorrect = false;
            break;
          }
        }
        
        // 顯示結果
        const resultElement = document.getElementById(`sentence-result${chapter === 'intro' ? '' : '-' + chapter}`);
        resultElement.classList.remove('hidden');
        
        if (allCorrect && segments.length === correctSegments.length) {
          resultElement.classList.remove('bg-red-100', 'text-red-800', 'dark:bg-red-900', 'dark:text-red-200');
          resultElement.classList.add('bg-green-100', 'text-green-800', 'dark:bg-green-900', 'dark:text-green-200');
          resultElement.innerHTML = '<p>斷句正確！你已正確理解了這段文本的結構。</p>';
          
          // 如果是序章，解鎖繼續按鈕
          if (chapter === 'intro') {
            resultElement.innerHTML += '<button id="continue-to-exploration" class="bg-primary hover:bg-opacity-90 text-white px-4 py-2 rounded-lg font-medium transition mt-4">繼續探索</button>';
            document.getElementById('continue-to-exploration').addEventListener('click', function() {
              showScene('scene-exploration');
            });
          }
        } else {
          resultElement.classList.remove('bg-green-100', 'text-green-800', 'dark:bg-green-900', 'dark:text-green-200');
          resultElement.classList.add('bg-red-100', 'text-red-800', 'dark:bg-red-900', 'dark:text-red-200');
          resultElement.innerHTML = '<p>斷句還不完全正確。請再次嘗試，注意文本的語意單位和自然停頓。</p>';
        }
      }
      
      // 顯示正確答案
      function showCorrectAnswer(chapter) {
        const text = sentenceData[chapter].text;
        const correctSegments = sentenceData[chapter].correctSegments;
        
        // 創建一個顯示正確斷句的字符串
        let formattedText = '';
        let lastIndex = 0;
        
        // 按照索引順序排序
        const sortedSegments = [...correctSegments].sort((a, b) => a - b);
        
        for (let i = 0; i < sortedSegments.length; i++) {
          const segmentIndex = sortedSegments[i];
          // 添加當前片段和斷句點
          formattedText += text.substring(lastIndex, segmentIndex + 1) + '•';
          lastIndex = segmentIndex + 1;
        }
        
        // 添加最後一段
        if (lastIndex < text.length) {
          formattedText += text.substring(lastIndex);
        }
        
        // 更新答案顯示區域
        const answerElement = document.getElementById(`correct-answer-${chapter}`);
        answerElement.querySelector('p:last-child').textContent = formattedText;
        answerElement.classList.remove('hidden');
      }
      
      // 設置尺度滑桿
      function setupScaleSlider() {
        const slider = document.getElementById('scale-slider');
        const zoomContainer = document.getElementById('zoom-container');
        const battleScene = document.getElementById('battle-scene');
        const perspectiveText = document.getElementById('perspective-text');
        
        slider.addEventListener('input', function() {
          const value = parseInt(this.value);
          
          // 更新視覺效果
          if (value < 33) {
            // 微觀視角
            zoomContainer.classList.add('zoom-in');
            zoomContainer.classList.remove('zoom-out');
            perspectiveText.textContent = '看起來非常巨大';
            battleScene.classList.remove('hidden');
          } else if (value > 66) {
            // 宏觀視角
            zoomContainer.classList.add('zoom-out');
            zoomContainer.classList.remove('zoom-in');
            perspectiveText.textContent = '幾乎無法看見';
            battleScene.classList.add('hidden');
          } else {
            // 正常視角
            zoomContainer.classList.remove('zoom-in', 'zoom-out');
            perspectiveText.textContent = '有一定的規模';
            battleScene.classList.add('hidden');
          }
        });
      }
      
      // 設置視角滑桿
      function setupPerspectiveSlider() {
        const slider = document.getElementById('scale-slider-advanced');
        const levels = document.querySelectorAll('.perspective-level');
        
        slider.addEventListener('input', function() {
          const value = parseInt(this.value);
          const levelIndex = Math.floor(value / 12.5);  // 分成8個級別
          
          // 更新活躍的視角級別
          levels.forEach(level => level.classList.remove('active'));
          levels[levelIndex < 8 ? levelIndex : 7].classList.add('active');
        });
      }
      
      // 重置遊戲
      function resetGame() {
        gameState.currentScene = 'scene-intro';
        gameState.unlockedChapters = ['intro'];
        gameState.collectedSeals = [];
        gameState.unlockedForms = ['human', 'butterfly'];
        gameState.currentForm = 'human';
        
        // 更新UI
        updateSeals();
        updateChapterButtons();
        
        // 顯示初始場景
        showScene('scene-intro');
      }

      // 加载状态管理
      function showLoading() {
        document.getElementById('loading-overlay').classList.remove('hidden');
      }

      function hideLoading() {
        document.getElementById('loading-overlay').classList.add('hidden');
      }

      // 添加按钮加载状态
      function setButtonLoading(button, loading = true) {
        if (loading) {
          button.classList.add('loading');
          button.disabled = true;
        } else {
          button.classList.remove('loading');
          button.disabled = false;
        }
      }

      // 优化场景转换
      function showSceneWithLoading(sceneId, delay = 300) {
        showLoading();
        setTimeout(() => {
          showScene(sceneId);
          hideLoading();
        }, delay);
      }

      // 移动端章节选择器支持
      function setupMobileChapterSelector() {
        const chapterSelect = document.getElementById('chapter-select');
        if (chapterSelect) {
          chapterSelect.addEventListener('change', function() {
            const selectedChapter = this.value;
            const chapterBtn = document.querySelector(`[data-chapter="${selectedChapter}"]`);
            if (chapterBtn && !chapterBtn.disabled) {
              chapterBtn.click();
            }
          });
        }
      }

      // 更新移动端选择器状态
      function updateMobileChapterSelector() {
        const chapterSelect = document.getElementById('chapter-select');
        if (chapterSelect) {
          Array.from(chapterSelect.options).forEach(option => {
            const chapterValue = option.value;
            if (gameState.unlockedChapters.includes(chapterValue)) {
              option.disabled = false;
            } else {
              option.disabled = true;
            }
          });
          // 更新当前选中值
          chapterSelect.value = gameState.currentChapter || 'intro';
        }
      }
    </script>
  </body>
  </html>
